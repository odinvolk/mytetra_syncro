<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683785"></a><span style=" font-size:xx-large; font-weight:600;">А</span><span style=" font-size:xx-large; font-weight:600;">дминистрирование Windows Server 2008 R2</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="OLE_LINK34"></a>Windows Server 2008 R2 поставляется с множеством <span style=" color:#980004;">оснасток</span> и модулей Windows PowerShell, разработанных для того, чтобы облегчить административную работу по управлению различными функциями Windows Server 2008 R2. Изучение этих <span style=" color:#980004;">оснасток</span> и модулей даст вам возможность автоматизировать выполнение многих задач, связанных с Windows Server 2008 R2, а также позволит получить дополнительный опыт в использовании самой оболочки Windows PowerShell, ее ключевых <span style=" color:#980004;">командлетов</span> и прочих техник, рассмотренных ранее в этом курсе. </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683786"></a><span style=" font-size:x-large; font-weight:600;">О</span><span style=" font-size:x-large; font-weight:600;">бзор модулей Windows Server® 2008 R2</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Иногда одного знания о существовании того или иного инструмента бывает достаточно для того, чтобы сэкономить массу времени. Особенно это справедливо для Windows PowerShell: если вы знаете, что инструмент или возможность реально существует, такие функции как Help или командлет Get-Member помогут быстро получить информацию об особенностях использования данного инструмента или возможности. Цель данного урока – познакомить вас с многообразием модулей и <span style=" color:#980004;">оснасток</span>, доступных в Windows Server 2008 R2. Обратите внимание, что некоторые из этих модулей и <span style=" color:#980004;">оснасток</span> также доступны в Windows® 7, в частности, после установки Remote Server Administration Toolkit (RSAT). Модули и оснастки в Windows 7 и Windows Server 2008 R2 обычно работают идентично – функциональных различий между модулем, установленным на клиентском компьютере и тем же модулем, установленным на серверном компьютере практически нет. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модули Windows Server 2008 R2 устанавливаются в папку модулей Windows PowerShell в масштабе всей системы. Чтобы посмотреть содержимое папки модулей внутри Windows PowerShell, наберите следующую команду: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Cd $pshome\modules </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Также Windows PowerShell определяет переменную среды, которая содержит пути, по которым оболочка будет находить расположение модулей. Содержимое этой переменной среды можно посмотреть, набрав команду: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Get-Content env:psmodulepath </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Также вы можете <span style=" color:#980004;">сгенерировать</span> список установленных модулей, набрав команду: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Get-Module -list </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Большинство расширений Windows PowerShell, включенных в Windows Server 2008 R2, представлено в виде модулей, однако, некоторые из них представлены в виде <span style=" color:#980004;">оснасток</span>. Чтобы просмотреть список установленных <span style=" color:#980004;">оснасток</span>, запустите команду: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Get-PSSnapin –registered </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обратите внимание, что не все модули и оснастки установлены в Windows Server 2008 R2 по умолчанию. Как правило, модуль или оснастка устанавливается одновременно с установкой соответствующей функции или роли. Например, модуль ActiveDirectory обычно устанавливается одновременно с установкой роли the Active Directory® Domain Services. Поэтому, в типичной производственной среде могут наблюдаться некоторые расхождения между модулями, установленными на разных серверах, так как на каждом сервере установлен индивидуальный набор ролей и функций. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Также не забывайте, что вам не нужно копировать или устанавливать одни и те же модули на каждый компьютер в вашем окружении. Некоторые модули, например, работают только на Windows Server 2008 R2, и при копировании на Windows 7 или на любой клиентский компьютер они просто не будут функционировать. Одна из задач обучения удаленному управлению, рассмотренная ранее, заключается в том, чтобы научиться использовать модули и оснастки, расположенные на удаленных компьютерах. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модули и оснастки, включенные в Windows Server 2008 R2, могут относиться к следующим функциям и ролям: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Active Directory Domain Services (AD DS) </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Active Directory Rights Management Services (AD RMS) </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• AppLocker (Application ID Policy Management) </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Best Practices Analyzer </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Background Intelligent Transfer Service (BITS) </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Group Policy and Group Policy objects (GPOs) </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Network Load Balancing </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Windows PowerShell Diagnostics (PSDiagnostics) </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Remote Desktop Services </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Server Manager </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Server Migration </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Troubleshooting Packs </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Web Administration (Internet Information Services) </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Web Services for Management (WS-MAN) </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Windows Cluster Service (Failover Clusters) </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Windows Server Backup </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Помимо этого, управление некоторыми функциями Windows Server 2008 R2 может осуществляться с использованием сторонних модулей и <span style=" color:#980004;">оснасток</span>. Например, http://pshyperv.codeplex.com/ является открытым источником <span style=" color:#980004;">командлетов</span>, разработанных, чтобы облегчить управление установками Microsoft Hyper-V. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683787"></a><span style=" font-size:large; font-weight:600;">И</span><span style=" font-size:large; font-weight:600;">спользование модулей</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы добавить модуль в оболочку, используйте командлет Import-Module и имя модуля. Обратите внимание, что модули остаются загруженными в продолжение всей текущей сессии работы оболочки, если только вы не используете командлет Remove-Module для их удаления. Просмотреть список загруженных на данный момент модулей можно с помощью командлета running Get-Module. Не забывайте, что все загруженные модули исчезают при завершении сеанса работы оболочки и не загружаются автоматически при начале следующей сессии. С помощью командлета Import-Module в профильном сценарии (мы рассмотрим его позже) можно автоматически загружать те модули, которые нужны вам для работы постоянно. Например: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Import-Module ActiveDirectory </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Когда модуль загружен, можно просмотреть список <span style=" color:#980004;">командлетов</span>, которые были добавлены, используя Get-Command: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Get-Command –module ActiveDirectory </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Некоторые модули также добавляют новых провайдеров PSDrive. Просмотреть список всех установленных провайдеров можно с помощью командлета Get- PSProvider. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Некоторые расширения Windows Server 2008 R2, например, Windows Server Backup представлены не в виде модулей, а в виде <span style=" color:#980004;">оснасток</span>. Загрузить их можно, используя командлет Add- PSSnapin и полное имя оснастки. Так же, как и модули, они остаются загруженными в продолжение текущей сессии работы оболочки. Чтобы увидеть, какие <span style=" color:#980004;">командлеты</span> были добавлены в результате загрузки <span style=" color:#980004;">оснасток</span>, запустите команду: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Get-Command –pssnapin snap-in-name </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Большинство расширений, поставляемых Microsoft, имеют стандартный для Windows PowerShell файл «help». Следовательно, после загрузки модуля или оснастки вы можете с помощью Get-Command уточнить, какие <span style=" color:#980004;">командлеты</span> были добавлены, а затем найти в справочном файле информацию об их предназначении и особенностях использования. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683788"></a><span style=" font-size:large; font-weight:600;">К</span><span style=" font-size:large; font-weight:600;">омандлеты Server Manager</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модуль Server Manager является базовым. Он включает всего три командлета, один из которых генерирует список всех доступных функций, указывая, какие из них установлены. Два других предназначены для добавления и удаления функций. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Список всех доступных ролей и функций, создаваемый командлетом Get-WindowsFeature, содержит официальные имена всех ролей и функций. Эти имена следует использовать и с командлетами Add-WindowsFeature и Remove-WindowsFeature для добавления или удаления функций. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Несмотря на то, что выходные данные командлета Get-WindowsFeature выглядят как хорошо отформатированный текстовый список, в действительности это набор объектов, так же, как выходные данные любого командлета в оболочке. Предустановленный элемент View, включенный в модуль ServerManager, форматирует эти объекты и выводит на экран в виде <span style=" color:#980004;">иерархичного</span> списка. Однако это форматирование происходит только в самом конце конвейера. Это означает, что вы можете передавать эти объекты по конвейеру другим командлетам, чтобы манипулировать ими или выводить в виде отдельного файла. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если вас интересует конструкция модуля, запустите сначала cd $pshome/modules/servermanager, затем gc servermanager.psd1, а после ls. Вы увидите содержимое модуля ServerManager, а именно его бинарный файл, файл справки в формате XML и значение вида .format.ps1xml. Содержимое будет представлять собой просто список компонентов, так что оболочка «знает», как загрузить их все. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модуль GroupPolicy включает <span style=" color:#980004;">командлеты</span> для создания, резервного копирования, хранения объектов групповой политики (Group Policy) и манипулирования ими и ссылками GPO (Group Policy Objects) внутри домена. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683789"></a><span style=" font-size:large; font-weight:600;">G</span><span style=" font-size:large; font-weight:600;">PO командлеты</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Group Policy состоит из двух различных компонентов: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Файл GPO, который постоянно хранится на диске, содержащий настройки GPO. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Канал связи между GPO и контейнером, сайтом, организационной единицей или доменом. Этот канал связи указывает, какие пользователи и компьютеры испытывают воздействие GPO. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Всестороннее изучение особенностей работы GPO лежит за пределами данного курса, хотя, если вы являетесь опытным администратором Windows Server, вы должны уже знать, как они работают. Для работы с GPO существует три основных командлета: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Get-GPO: Извлекает существующие GPO, обычно по имени. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• New-GPO: Создает новый GPO. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Remove-GPO: Удаляет GPO. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">С помощью других <span style=" color:#980004;">командлетов</span> можно осуществлять такие функции как переименование, резервное копирование и хранение GPO. К командлетам, предназначенным для работы с <span style=" color:#980004;">линками</span> GPO, относятся: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• New-GPLink </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Remove-GPLink </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Set-GPLink </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Помимо этого, существуют <span style=" color:#980004;">командлеты</span> для работы с настройками наследования политик, с результирующей групповой политикой (RSoP) и с индивидуальными настройками внутри GPO. Например, Set-GPPrefRegistryValue и Set- GPRegistryValue позволяют изменять индивидуальные настройки внутри GPO. Принцип работы с GPO с помощью оболочки во многом схож с принципом работы с помощью Group Policy Management Console. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1. Начните с выбора существующего или создания нового GPO. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2. Измените одну или несколько настроек или настроек реестра внутри GPO. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">3. Соедините GPO с одним или несколькими местами в домене. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вспомнив процедуру работы в графической консоли, вы быстрее запомните последовательность команд, необходимых для выполнения тех же самых задач с помощью командной строки. Также рекомендуется потратить некоторое время на изучение <span style=" color:#980004;">командлетов</span>, добавляемых модулем GroupPolicy. Некоторые <span style=" color:#980004;">командлеты</span> умеют производить отчеты в HTML-формате, управлять разрешениями GPO и многое другое. Для того, чтобы узнать больше о возможностях всех предлагаемых <span style=" color:#980004;">командлетов</span> и ознакомиться с примерами их использования, прочитайте соответствующий <span style=" color:#980004;">рздел</span> справочника. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683790"></a><span style=" font-size:large; font-weight:600;">К</span><span style=" font-size:large; font-weight:600;">омандлеты TroubleshootingPack</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модуль <a name="OLE_LINK36"></a>TroubleshootingPack содержит <span style=" color:#980004;">командлеты</span>, которые управляют Windows Troubleshooting Packs из командной строки. Эти <span style=" color:#980004;">командлеты</span> не только обеспечивают удобный способ автоматизации расширения Troubleshooting Pack, но и позволяют через Windows PowerShell Remoting связаться с удаленным сервером или клиентскими компьютерами и запустить Troubleshooting Packs на них. Пакеты Troubleshooting представляют собой новую функцию Windows 7 и Windows Server 2008 R2, которая обеспечивает интерактивную диагностику и последующее решение проблем. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модуль TroubleshootingPack содержит всего два командлета: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Get-TroubleshootingPack загружает пакет troubleshooting pack с диска. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Invoke-TroubleshootingPack выполняет загруженный пакет troubleshooting. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы загрузить пакет, необходимо знать путь к нему. Большинство пакетов устанавливаются в \Windows\Diagnostics\System, поэтому, можно запустить такую команду: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Get-TroubleshootingPack c:\windows\diagnostics\system\aero </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Также вы можете просмотреть директорию c:\windows\diagnostics для поиска установленных на компьютер пакетов. Обратите внимание, что набор <span style=" color:#980004;">траблшутеров</span> на разных компьютерах будет различаться – он зависит от версии операционной системы, установленных ролей и функций и.т.д. После того, как вы загрузили пакет Troubleshooting, вы можете передавать его по конвейеру командлету Invoke-TroubleshootingPack для начала процесса решения проблем. Многие пакеты являются интерактивными и предлагают меню в виде командной строки, которую можно использовать для уточнения проблемы. Пакеты можно автоматизировать с помощью создания файла ответов в XTML. Информацию о том, как создать такой файл, вы найдете в разделе справочника, посвященном Get-TroubleshootingPack. После настройки файла ответов в соответствии с вашими потребностями (используя Windows Notepad или Windows PowerShell <span style=" color:#980004;">ISE</span>), вы можете применять параметры –unattend и –answer командлета Invoke- TroubleshootingPack, чтобы диагностика проблем осуществлялась в автоматическом режиме. Хорошим сценарием будет использование Windows PowerShell 1-к-1 для обеспечения совместимости на удаленном компьютере. Это позволяет выполнять поиск проблем на удаленном компьютере, даже в то время, когда пользователь входит в систему на этом компьютере. Данная техника позволяет осуществлять поиск и решение проблем удаленных пользователей. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683791"></a><span style=" font-size:large; font-weight:600;">B</span><span style=" font-size:large; font-weight:600;">PA командлеты</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модуль BestPractices включает <span style=" color:#980004;">командлеты</span>, предназначенные для создания и изучения отчетов Best Practices Analyzer (BPA). </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">BPA – это функция Windows Server 2008 R2, предназначенная для анализа конфигураций ролей и функций, установленных на сервере и их сравнения с рекомендованными Microsoft конфигурациями. Используя <span style=" color:#980004;">командлеты</span> BPA, вы сможете автоматизировать создание и анализ BPA отчетов, таким образом, поддерживая оптимальную конфигурацию сервера для большей надежности и работоспособности. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#980004;">Командлеты</span> BPA работают с моделями BPA. Каждая модель представляет собой набор рекомендаций, имеющих отношение к определенной функции или роли сервера. Запуск командлета Get-BpaModel без указания каких-либо параметров позволяет получить список доступных моделей. Этот список может варьироваться в зависимости от того,какие функции и роли установлены на сервер. В списке отображается официальный ID каждой модели. ID может понадобиться для извлечения конкретной модели с целью ее выполнения. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После того, как вы извлекли одну или несколько моделей, вы можете передать их командлету Invoke-BpaModel для их выполнения и создания отчета BPA. Отчеты BPA отображаются не моментально. Они передаются на хранение в операционную систему, откуда их необходимо извлекать. Для этого используйте командлет Get-BpaResult, уточнив ID той BPA модели, результаты для которой вы хотите просмотреть. Конечно, результатов не будет до тех пор, пока данная модель не будет извлечена. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Результаты возвращаются не в виде текстового списка. Как и почти все остальное в оболочке, результаты BPA представляют собой набор объектов, которые вы можете сортировать, фильтровать, и.т.д., а также экспортировать их в файл или конвертировать в другие форматы, например, HTML. Детальные инструкции по использованию <span style=" color:#980004;">командлетов</span> BPA содержатся в соответствующем разделе справочника. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683792"></a><span style=" font-size:large; font-weight:600;">I</span><span style=" font-size:large; font-weight:600;">IS командлеты</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модуль WebAdministration включает 74 командлета, большая часть которых используется для выполнения сложных <span style=" color:#980004;">IIS</span> задач высокого уровня, таких как создание веб-сайтов, FTP-сайтов, приложений и пр. Также они позволяют запускать, останавливать или перезапускать сайт или пул. Более детальная информация об особенностях использования этих <span style=" color:#980004;">командлетов</span> содержится в соответствующих разделах справочника. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Однако большая часть настроек конфигурации <span style=" color:#980004;">IIS</span> в рамках Windows PowerShell не выполняется с помощью этих <span style=" color:#980004;">командлетов</span>. Вместо этого модель, созданная разработчиками <span style=" color:#980004;">IIS</span>, основывается на использовании <span style=" color:#980004;">IIS</span>: диска. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Один из ключевых фактов об <span style=" color:#980004;">IIS</span> 7.5 (версия, вошедшая в состав Windows Server 2008 R2) заключается в том, что она обладает модульной структурой. Это означает, что в <span style=" color:#980004;">IIS</span> можно добавить новые функции посредством установки дополнительных программных модулей и других дополнений через консоль Server Manager или из интернета (например, с сайта http://<span style=" color:#980004;">iis</span>.net). </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так как версии установленных <span style=" color:#980004;">IIS</span> могут слегка отличаться друг от друга, за счет разных дополнений и разных возможностей, было бы довольно сложно создать единый набор <span style=" color:#980004;">командлетов</span> для управления всеми возможными вариантами конфигурации. Поэтому, разработчики <span style=" color:#980004;">IIS</span> создали <span style=" color:#980004;">командлеты</span> для управления ключевыми, неизменными элементами, которые поддерживает любой сервер <span style=" color:#980004;">IIS</span>: пулы приложений, веб-сайты, FTP сайты и.т.д. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Детальная настройка конфигурации сервера и его сайтов, пулов и других элементов осуществляется с помощью иерархического <span style=" color:#980004;">IIS</span> диска, который выглядит и работает во многом как обычный жесткий диск или диск реестра, который отображается в Windows PowerShell. Например, верхний уровень <span style=" color:#980004;">IIS</span> диска содержит три папки: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">AppPools </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Sites </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">SslBindings </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Папка AppPools содержит сконфигурированные пулы приложений, такие как: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">PS IIS:\&gt; cd apppools </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">PS IIS:\apppools&gt; ls </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Name                                    State                  Applications </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">----                                        -----                  ------------ </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Classic .NET AppPool          Started </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">DefaultAppPool                    Started              Default Web Site </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Далее вы можете изменить директорию на один из этих пулов с помощью команды: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">PS IIS:\apppools&gt; cd defaultapppool </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">PS IIS:\AppPools\defaultapppool&gt; ls </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Name </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">---- </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">WorkerProcesses </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Дальнейшая навигация по <span style=" color:#980004;">иерархичной</span> системе осуществляется таким же образом. Обратите внимание, что в действительности вы не используете диск – вместо него вы имеете дело с хранилищем параметров конфигурации, которое выполнено в виде диска. PSDrive провайдер, входящий в состав модуля WebAdministration, отвечает за придание этому хранилищу формы обычного диска. Вы используете <span style=" color:#980004;">командлеты</span> –Item и –ChildItem для навигации по хранилищу, извлекаете существующие значения конфигурации и вносите изменения в эти значения. </p></body></html>