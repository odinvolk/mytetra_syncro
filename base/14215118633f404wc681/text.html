<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В статье описываются методы создания релизной сборки Qt-программы под Linux. Рассматриваются вопросы создания сборки, которая будет работать на большинстве современных дистрибутивов.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Статья требует перевода.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:xx-large; font-weight:600;">Qt for Linux/X11 - Deployment</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="details"></a>This documentation discusses specific deployment issues for <a href="http://doc.qt.io/qt-5/linux.html"><span style=" text-decoration: underline; color:#0057ae;">Qt for Linux/X11</span></a>. We will demonstrate the procedures in terms of deploying the <a href="http://doc.qt.io/qt-5/qtwidgets-tools-plugandpaint-example.html"><span style=" text-decoration: underline; color:#0057ae;">Plug &amp; Paint</span></a> application that is provided in Qt's examples directory.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Due to the proliferation of Unix systems (such as commercial Unixes, Linux distributions, and so on), deployment on Unix is a complex topic. Before we start, be aware that programs compiled for one Unix flavor will probably not run on a different Unix system. For example, unless you use a cross-compiler, you cannot compile your application on Irix and distribute it on AIX.<a name="static-linking"></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="static-linking"></a><span style=" font-size:x-large; font-weight:600;">S</span><span style=" font-size:x-large; font-weight:600;">tatic Linking</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Static linking is often the safest and easiest way to distribute an application on Unix since it relieves you from the task of distributing the Qt libraries and ensuring that they are located in the default search path for libraries on the target system.<a name="building-qt-statically"></a> </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Building Qt Statically</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">To use this approach, you must start by installing a static version of the Qt library:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">cd /path/to/</span><a href="http://doc.qt.io/qt-5/qt.html"><span style=" font-family:'Courier New'; text-decoration: underline; color:#6a0e07;">Qt</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">./configure -static -prefix /path/to/</span><a href="http://doc.qt.io/qt-5/qt.html"><span style=" font-family:'Courier New'; text-decoration: underline; color:#6a0e07;">Qt</span></a><span style=" font-family:'Courier New'; color:#6a0e07;"> &lt;other parameters&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">make sub-src</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">We specify the prefix so that we do not overwrite the existing Qt installation. The example above only builds the Qt libraries, i.e. the examples and Qt Designer will not be built. When <span style=" font-family:'Courier New,courier';">make</span> is done, you will find the Qt libraries in the <span style=" font-family:'Courier New,courier';">/path/to/Qt/lib</span> directory.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">When linking your application against static Qt libraries, note that you might need to add more libraries to the <span style=" font-family:'Courier New,courier';">LIBS</span> line in your project file. For more information, see the <a href="http://doc.qt.io/qt-5/windows-deployment.html#application-dependencies"><span style=" text-decoration: underline; color:#0057ae;">Application Dependencies</span></a> section.<a name="linking-the-application-to-the-static-version-of-qt"></a> </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Linking the Application to the Static Version of Qt</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Once Qt is built statically, the next step is to regenerate the makefile and rebuild the application. First, we must go into the directory that contains the application:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">cd /path/to/</span><a href="http://doc.qt.io/qt-5/qt.html"><span style=" font-family:'Courier New'; text-decoration: underline; color:#6a0e07;">Qt</span></a><span style=" font-family:'Courier New'; color:#6a0e07;">/examples/tools/plugandpaint</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Now run qmake to create a new makefile for the application, and do a clean build to create the statically linked executable:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">make clean</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">PATH=/path/to/</span><a href="http://doc.qt.io/qt-5/qt.html"><span style=" font-family:'Courier New'; text-decoration: underline; color:#6a0e07;">Qt</span></a><span style=" font-family:'Courier New'; color:#6a0e07;">/bin:$PATH</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">export PATH</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">qmake -config release</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">make</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">You probably want to link against the release libraries, and you can specify this when invoking <span style=" font-family:'Courier New,courier';">qmake</span>. Note that we must set the path to the static Qt that we just built.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">To check that the application really links statically with Qt, run the <span style=" font-family:'Courier New,courier';">ldd</span> tool (available on most Unices):</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">ldd ./application</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Verify that the Qt libraries are not mentioned in the output.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Now, provided that everything compiled and linked without any errors, we should have a <span style=" font-family:'Courier New,courier';">plugandpaint</span> file that is ready for deployment. One easy way to check that the application really can be run stand-alone is to copy it to a machine that doesn't have Qt or any Qt applications installed, and run it on that machine.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Remember that if your application depends on compiler specific libraries, these must still be redistributed along with your application. For more information, see the <a href="http://doc.qt.io/qt-5/windows-deployment.html#application-dependencies"><span style=" text-decoration: underline; color:#0057ae;">Application Dependencies</span></a> section.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">The <a href="http://doc.qt.io/qt-5/qtwidgets-tools-plugandpaint-example.html"><span style=" text-decoration: underline; color:#0057ae;">Plug &amp; Paint</span></a> example consists of several components: The core application (<a href="http://doc.qt.io/qt-5/qtwidgets-tools-plugandpaint-example.html"><span style=" text-decoration: underline; color:#0057ae;">Plug &amp; Paint</span></a>), and the <a href="http://doc.qt.io/qt-5/qtwidgets-tools-plugandpaintplugins-basictools-example.html"><span style=" text-decoration: underline; color:#0057ae;">Basic Tools</span></a> and <a href="http://doc.qt.io/qt-5/qtwidgets-tools-plugandpaintplugins-extrafilters-example.html"><span style=" text-decoration: underline; color:#0057ae;">Extra Filters</span></a> plugins. Since we cannot deploy plugins using the static linking approach, the executable we have prepared so far is incomplete. The application will run, but the functionality will be disabled due to the missing plugins. To deploy plugin-based applications we should use the shared library approach.<a name="shared-libraries"></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="shared-libraries"></a><span style=" font-size:x-large; font-weight:600;">S</span><span style=" font-size:x-large; font-weight:600;">hared Libraries</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">We have two challenges when deploying the <a href="http://doc.qt.io/qt-5/qtwidgets-tools-plugandpaint-example.html"><span style=" text-decoration: underline; color:#0057ae;">Plug &amp; Paint</span></a> application using the shared libraries approach: The Qt runtime has to be correctly redistributed along with the application executable, and the plugins have to be installed in the correct location on the target system so that the application can find them.<a name="building-qt-as-a-shared-library"></a> </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Building Qt as a Shared Library</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">We assume that you already have installed Qt as a shared library, which is the default when installing Qt, in the <span style=" font-family:'Courier New,courier';">/path/to/Qt</span> directory.<a name="linking-the-application-to-qt-as-a-shared-library"></a> </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Linking the Application to Qt as a Shared Library</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">After ensuring that Qt is built as a shared library, we can build the <a href="http://doc.qt.io/qt-5/qtwidgets-tools-plugandpaint-example.html"><span style=" text-decoration: underline; color:#0057ae;">Plug &amp; Paint</span></a> application. First, we must go into the directory that contains the application:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">cd /path/to/</span><a href="http://doc.qt.io/qt-5/qt.html"><span style=" font-family:'Courier New'; text-decoration: underline; color:#6a0e07;">Qt</span></a><span style=" font-family:'Courier New'; color:#6a0e07;">/examples/tools/plugandpaint</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Now run qmake to create a new makefile for the application, and do a clean build to create the dynamically linked executable:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">make clean</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">qmake -config release</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">make</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">This builds the core application, the following will build the plugins:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">cd ../plugandpaintplugins</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">make clean</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">qmake -config release</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">make</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">If everything compiled and linked without any errors, we will get a <span style=" font-family:'Courier New,courier';">plugandpaint</span> executable and the <span style=" font-family:'Courier New,courier';">libpnp_basictools.so</span> and <span style=" font-family:'Courier New,courier';">libpnp_extrafilters.so</span> plugin files.<a name="creating-the-application-package"></a> </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Creating the Application Package</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">There is no standard package management on Unix, so the method we present below is a generic solution. See the documentation for your target system for information on how to create a package.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">To deploy the application, we must make sure that we copy the relevant Qt libraries (corresponding to the Qt modules used in the application), the <a href="http://doc.qt.io/qt-5/windows-deployment.html#qt-plugins"><span style=" text-decoration: underline; color:#0057ae;">platform plugin</span></a>, and the executable to the same directory tree. Remember that if your application depends on compiler specific libraries, these must also be redistributed along with your application. For more information, see the <a href="http://doc.qt.io/qt-5/windows-deployment.html#application-dependencies"><span style=" text-decoration: underline; color:#0057ae;">Application Dependencies</span></a> section.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">We'll cover the plugins shortly, but the main issue with shared libraries is that you must ensure that the dynamic linker will find the Qt libraries. Unless told otherwise, the dynamic linker doesn't search the directory where your application resides. There are many ways to solve this:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">You can install the Qt libraries in one of the system library paths (e.g. <span style=" font-family:'Courier New,courier';">/usr/lib</span> on most systems).</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">You can pass a predetermined path to the <span style=" font-family:'Courier New,courier';">-rpath</span> command-line option when linking the application. This will tell the dynamic linker to look in this directory when starting your application.</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">You can write a startup script for your application, where you modify the dynamic linker configuration (e.g., adding your application's directory to the <span style=" font-family:'Courier New,courier';">LD_LIBRARY_PATH</span> environment variable.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-weight:600;">Note: </span>If your application will be running with &quot;Set user ID on execution,&quot; and if it will be owned by root, then LD_LIBRARY_PATH will be ignored on some platforms. In this case, use of the LD_LIBRARY_PATH approach is not an option).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">The disadvantage of the first approach is that the user must have super user privileges. The disadvantage of the second approach is that the user may not have privileges to install into the predetermined path. In either case, the users don't have the option of installing to their home directory. We recommend using the third approach since it is the most flexible. For example, a <span style=" font-family:'Courier New,courier';">plugandpaint.sh</span> script will look like this:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">#!/bin/sh</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">appname=`basename $0 | sed s,\.sh$,,`</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">dirname=`dirname $0`</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">tmp=&quot;${dirname#?}&quot;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">if [ &quot;${dirname%$tmp}&quot; != &quot;/&quot; ]; then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">dirname=$PWD/$dirname</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">fi</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">LD_LIBRARY_PATH=$dirname</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">export LD_LIBRARY_PATH</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">$dirname/$appname &quot;$@&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">By running this script instead of the executable, you are sure that the Qt libraries will be found by the dynamic linker. Note that you only have to rename the script to use it with other applications.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">When looking for plugins, the application searches in a plugins subdirectory inside the directory of the application executable. Either you have to manually copy the plugins into the <span style=" font-family:'Courier New,courier';">plugins</span> directory, or you can set the <span style=" font-family:'Courier New,courier';">DESTDIR</span> in the plugins' project files:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">DESTDIR = /path/to/Qt/plugandpaint/plugins</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">An archive distributing all the Qt libraries, and all the plugins, required to run the <a href="http://doc.qt.io/qt-5/qtwidgets-tools-plugandpaint-example.html"><span style=" text-decoration: underline; color:#0057ae;">Plug &amp; Paint</span></a> application, would have to include the following files:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="2" cellpadding="0"><thead>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-weight:600; color:#6a0e07;">Component</span></p></td>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-weight:600; color:#6a0e07;">File Name</span></p></td></tr></thead>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">The executable</span></p></td>
<td colspan="2" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">plugandpaint</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">The script to run the executable</span></p></td>
<td colspan="2" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">plugandpaint.sh</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">The Basic Tools plugin</span></p></td>
<td colspan="2" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">plugins\libpnp_basictools.so</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">The ExtraFilters plugin</span></p></td>
<td colspan="2" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">plugins\libpnp_extrafilters.so</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">The Qt xcb platform plugin</span></p></td>
<td colspan="2" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">platforms\libqxcb.so</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">The Qt Core module</span></p></td>
<td colspan="2" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">libQt5Core.so.5</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">The Qt GUI module</span></p></td>
<td colspan="2" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">libQt5Gui.so.5</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">The Qt Widgets module</span></p></td>
<td colspan="2" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">libQt5Widgets.so.5</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">On most systems, the extension for shared libraries is <span style=" font-family:'Courier New,courier';">.so</span>. A notable exception is HP-UX, which uses <span style=" font-family:'Courier New,courier';">.sl</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Remember that if your application depends on compiler specific libraries, these must still be redistributed along with your application. For more information, see the <a href="http://doc.qt.io/qt-5/windows-deployment.html#application-dependencies"><span style=" text-decoration: underline; color:#0057ae;">Application Dependencies</span></a> section.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">To verify that the application now can be successfully deployed, you can extract this archive on a machine without Qt and without any compiler installed, and try to run it, i.e. run the <span style=" font-family:'Courier New,courier';">plugandpaint.sh</span> script.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">An alternative to putting the plugins in the <span style=" font-family:'Courier New,courier';">plugins</span> subdirectory is to add a custom search path when you start your application using <a href="http://doc.qt.io/qt-5/qcoreapplication.html#addLibraryPath"><span style=" text-decoration: underline; color:#0057ae;">QApplication::addLibraryPath</span></a>() or <a href="http://doc.qt.io/qt-5/qcoreapplication.html#setLibraryPaths"><span style=" text-decoration: underline; color:#0057ae;">QApplication::setLibraryPaths</span></a>().</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">qApp-&gt;addLibraryPath(&quot;/some/other/path&quot;);</span><a name="application-dependencies"></a><span style=" font-family:'Courier New'; color:#6a0e07;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="application-dependencies"></a><span style=" font-size:x-large; font-weight:600;">A</span><span style=" font-size:x-large; font-weight:600;">pplication Dependencies</span><a name="additional-libraries"></a> </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Additional Libraries</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">To find out which libraries your application depends on, run the <span style=" font-family:'Courier New,courier';">ldd</span> tool (available on most Unices):</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">ldd ./application</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">This will list all the shared library dependencies for your application. Depending on configuration, these libraries must be redistributed along with your application. In particular, the standard C++ library must be redistributed if you're compiling your application with a compiler that is binary incompatible with the system compiler. When possible, the safest solution is to link against these libraries statically.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">You will probably want to link dynamically with the regular X11 libraries, since some implementations will try to open other shared libraries with <span style=" font-family:'Courier New,courier';">dlopen()</span>, and if this fails, the X11 library might cause your application to crash.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">It's also worth mentioning that Qt will look for certain X11 extensions, such as Xinerama and Xrandr, and possibly pull them in, including all the libraries that they link against. If you can't guarantee the presence of a certain extension, the safest approach is to disable it when configuring Qt (e.g. <span style=" font-family:'Courier New,courier';">./configure -no-xrandr</span>).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">FontConfig and <a href="http://doc.qt.io/qt-5/qt-embedded-fonts.html#freetype"><span style=" text-decoration: underline; color:#0057ae;">FreeType</span></a> are other examples of libraries that aren't always available or that aren't always binary compatible. As strange as it may sound, some software vendors have had success by compiling their software on very old machines and have been very careful not to upgrade any of the software running on them.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">When linking your application against the static Qt libraries, you must explicitly link with the dependent libraries mentioned above. Do this by adding them to the <span style=" font-family:'Courier New,courier';">LIBS</span> variable in your project file.<a name="qt-plugins"></a> </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Qt Plugins</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">All Qt GUI applications require a plugin that implements the <a href="http://doc.qt.io/qt-5/qpa.html"><span style=" text-decoration: underline; color:#0057ae;">Qt Platform Abstraction</span></a> (QPA) layer in Qt 5. For Linux/X11, the name of the platform plugin is <span style=" font-family:'Courier New,courier';">libqxcb.so</span>. This file must be located within a specific subdirectory (by default, <span style=" font-family:'Courier New,courier';">platforms</span>) under your distribution directory. Alternatively, it is possible to adjust the search path Qt uses to find its plugins, as described below.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Your application may also depend on one or more Qt plugins, such as the JPEG image format plugin or a SQL driver plugin. Be sure to distribute any Qt plugins that you need with your application. Similar to the platform plugin, each type of plugin must be located within a specific subdirectory (such as <span style=" font-family:'Courier New,courier';">imageformats</span> or <span style=" font-family:'Courier New,courier';">sqldrivers</span>) within your distribution directory.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Note: </span>If you are deploying an application that uses <a href="http://doc.qt.io/qt-5/qtwebkit-index.html"><span style=" text-decoration: underline; color:#0057ae;">Qt WebKit</span></a> to display HTML pages from the World Wide Web, you should include all text codec plugins to support as many HTML encodings possible.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">The search path for Qt plugins (as well as a few other paths) is hard-coded into the <a href="http://doc.qt.io/qt-5/qtcore-module.html"><span style=" text-decoration: underline; color:#0057ae;">QtCore</span></a> library. By default, the first plugin search path will be hard-coded as <span style=" font-family:'Courier New,courier';">/path/to/Qt/plugins</span>. As mentioned above, using predetermined paths has certain disadvantages, so you need to examine various alternatives to make sure that the Qt plugins are found:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://doc.qt.io/qt-5/qt-conf.html"><span style=" text-decoration: underline; color:#0057ae;">Using </span></a><a href="http://doc.qt.io/qt-5/qt-conf.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">qt.conf</span></a>. This is the recommended approach since it provides the most flexibility.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Using <a href="http://doc.qt.io/qt-5/qcoreapplication.html#addLibraryPath"><span style=" text-decoration: underline; color:#0057ae;">QApplication::addLibraryPath</span></a>() or <a href="http://doc.qt.io/qt-5/qcoreapplication.html#setLibraryPaths"><span style=" text-decoration: underline; color:#0057ae;">QApplication::setLibraryPaths</span></a>().</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Using a third party installation utility or the target system's package manager to change the hard-coded paths in the <a href="http://doc.qt.io/qt-5/qtcore-module.html"><span style=" text-decoration: underline; color:#0057ae;">QtCore</span></a> library.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">The <a href="http://doc.qt.io/qt-5/plugins-howto.html"><span style=" text-decoration: underline; color:#0057ae;">How to Create Qt Plugins</span></a> document outlines the issues you need to pay attention to when building and deploying plugins for Qt applications.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>