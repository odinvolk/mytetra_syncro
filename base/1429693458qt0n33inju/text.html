<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683695"></a><span style=" font-size:xx-large; font-weight:600;">И</span><span style=" font-size:xx-large; font-weight:600;">спользование PowerShell в качестве интерактивной оболочки</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Хотя Windows PowerShell включает простой и мощный язык для написания скриптов, одним из преимуществ этой технологии является то, что его можно использовать в качестве удобной командной оболочки без написания сложных скриптов. Большое количество административных задач можно выполнять используя PowerShell для ввода интерактивных команд. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Windows PowerShell был разработан для того, чтобы его немедленно могли использовать администраторы, которые уже знакомы со старой оболочкой, в том числе Cmd.exe оболочкой, входящей в Windows, а также обычными оболочками Unix. В то время как некоторые из команд, работают немного по новому принципу, также вы найдете много знакомых команд, доступных для вас. </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="OLE_LINK26"></a>Например команды, которые вы бы использовали для выполнения каждой из следующих задач в оболочке cmd или Unix shell: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Изменить каталоги. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Список файлов и подкаталогов в каталоге. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Скопировать файл. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Отображение содержимого текстового файла. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Удалить файл. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Перемещение файлов. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Переименовать файл. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Создать новый каталог. </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="OLE_LINK50"></a>С Windows PowerShell можно также запускать большинство внешних команд, которые могут быть знакомы вам: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Ipconfig.exe </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Ping.exe </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Tracert.exe </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Nslookup.exe </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Pathping.exe </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Net.exe (например, Net Use) </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Windows PowerShell распознает многие из имен команд, с которыми вы, вероятно, уже знакомы, в том числе Cd, Dir, Ls, Cat, Type, MkDir, RmDir, Rm, Del, Cp, Copy, Move и так далее. Одновременно доступны наиболее общие file-and-folder команды управления Cmd.exe (которая использует MS-DOS Синтаксис команды) и оболочки Unix. </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="OLE_LINK28"></a>В большинстве случаев, однако, параметры этих команд разные. Например, в Cmd.exe вы можете выполнить следующую команду: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Dir /s </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В Windows PowerShell та же команда выдаст ошибку, потому что <span style=" font-family:'Courier New'; color:#6a1009;">/s</span>, не признается действительным параметром. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Тем не менее, наличие этих знакомых имен команд поможет вам начать использовать оболочку немедленно. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Внешние команды (программы), такие как Ipconfig.exe, Pathping.exe, и так далее, продолжают работать как всегда. Вы можете, например, запустить эту общую команду из Windows PowerShell: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Ipconfig / all </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Разница в том, что Ipconfig.exe является внешним исполняемым, в то время как команды, такие как Dir являются внутренними командами. Это верно также и для Cmd.exe. Внутренние команды, как правило, имеют синтаксис параметров, который отличается от того, к чему вы привыкли, и внешние исполняемые файлы будут продолжать функционировать как всегда.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683696"></a><span style=" font-size:x-large; font-weight:600;">И</span><span style=" font-size:x-large; font-weight:600;">ерархические хранилища</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="OLE_LINK52"></a>Файловая система Windows и, если уж на то пошло, файловая система большинства компьютеров является иерархической. <a name="OLE_LINK54"></a>Это означает, что она состоит из отдельных ячеек, которые называются &quot;папками&quot; или &quot;директориями&quot;, которые, в свою очередь, содержат либо файлы, либо другие папки. Папки содержат подпапки, которые, опять же, содержат свои подпапки, и так далее. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Большинство администраторов Windows помнят основные команды, необходимые для управления иерархической файловой системой: Cd, Dir, Copy, Move и другие. <a name="OLE_LINK56"></a>Однако файловая система – это не единственная иерархическая система в Windows. Реестр, хранилище сертификатов, Active Directory и многие другие системы хранения также имеют иерархическую структуру. Помимо этого Windows включает в себя ряд линейных (не-иерархических) хранилищ, таких как переменная среды операционной системы. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Одной из ключевых конструктивных задач Windows PowerShell является адаптация комплекса техник или процессов с целью использования данного комплекса в дальнейшем для решения сходных задач. Например, если реестр и файловая система имеют одну и ту же иерархическую структуру, то почему бы не использовать одни и те же команды для навигации и управления тем и другим? Другими словами, если администраторы уже знают стандартный набор команд, которые применяются в работе с иерархическим хранилищем одной формы, почему бы не адаптировать эти команды для работы с другими формами хранилищ, в том числе линейной? </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="OLE_LINK58"></a>Возможность использования единого набора команд для навигации по хранилищам, имеющим различную форму, становится возможным благодаря функции Windows PowerShell, которая называется провайдер PSDrive или просто провайдер. <a name="OLE_LINK60"></a>Провайдер представляет собой разновидность адаптера, который устанавливает соединение с системой хранения и представляет ее Windows PowerShell в форме дискового накопителя. Когда вы подаете команду, такую как Cd или Dir, она передается провайдеру данного диска, и провайдер делает все необходимое для того, чтобы выполнить эту команду. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Windows PowerShell оснащена несколькими провайдерами, в том числе для: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Файловой системы, </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Реестра, </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Переменной среды, </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Хранилища сертификатов </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Также она включает провайдеров для собственных хранилищ оболочки, включая хранилище функций, псевдонимов и переменных, о которых вы узнаете позже. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Оболочка может быть расширена и модернизирована для использования других провайдеров. Уже существуют провайдеры для <span style=" color:#980004;">IIS</span>, SQL Server, Active Directory и многих других форм хранилищ. Все провайдеры придают соответствующим хранилищам форму дискового накопителя. Эти дисковые накопители внутри оболочки официально называются PSDrives или Windows PowerShell Drives. Они не отображаются за пределами оболочки в Windows Explorer и могут иметь названия, состоящие более, чем из одной буквы. Например, диски реестра называются HKCU: и HKLM:. Вы можете создавать новые диски, уточняя каждый раз имя нового диска, провайдера, который будет использоваться, например, провайдер файловой системы и начальную ячейку, с которой провайдер будет устанавливать соединение, например, папку или сетевое имя. Обратите внимание, что оболочка всегда начинает работу с одного и того же диска, когда вы начинаете новую сессию; любые новые созданные вами диски сбрасываются при завершении работы с оболочкой. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Командная оболочка включает полный набор команд для управления хранилищами PSDrives: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Get-PSDrive</span>: <a name="OLE_LINK62"></a>выводит все доступные хранилища. По умолчанию, этот список включает все доступные накопители и логические диски. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">New-PSDrive:</span> <a name="OLE_LINK64"></a>создает новое хранилище. Вы должны указать имя хранилища (без двоеточия на конце), имя провайдера и стартовую точку или путь. Тип такой стартовой точки или пути зависит от типа используемого провайдера. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Remove-PSDrive:</span> <a name="OLE_LINK66"></a>уничтожает хранилище. Вы также можете удалить хранилища, присутствующие по умолчанию, например HKCU: или ENV:, однако они будут воссозданы при запуске нового экземпляра оболочки. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683697"></a><span style=" font-size:x-large; font-weight:600;">П</span><span style=" font-size:x-large; font-weight:600;">севдонимы</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Большинство обычных команд, с которыми вы встречались в оболочке, такие как Dir, Cd, Ls, Copy, Rm и другие на самом деле являются псевдонимами Windows PowerShell. Псевдоним – это укороченное название (<span style=" color:#980004;">никнейм</span>) команды. Они создаются для того, чтобы упростить и ускорить набор команд, а также, чтобы имена команд, которыми вы пользовались в других оболочках, были легко узнаваемыми. Например, Dir – это псевдоним команды Get-ChildItem. Ls – это псевдоним той же самой команды, так же как и Gci. Псевдонимы не меняют принципа действия команд или их параметров. Псевдоним – это всего лишь <span style=" color:#980004;">никнейм</span>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В Windows PowerShell встроенные команды называются <span style=" color:#980004;">командлеты</span>. Они отличаются от внешних команд, таких как Ipconfig.<span style=" color:#980004;">exe</span> по нескольким параметрам: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• <span style=" color:#980004;">Командлеты</span> имеют четко определенную структуру названия: глагол-существительное в единственном числе (англ). Глаголы берутся из конкретного строго оговоренного списка. Такая структура позволяет сделать названия более упорядоченными и легко запоминающимися. Существительные всегда идут в единственном числе: ChildItem” вместо “ChildItems,” или “PSDrive” вместо “PSDrives.” Единственное число используется даже тогда, когда командлет относится к нескольким компонентам. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• <span style=" color:#980004;">Командлеты</span> пишутся на одном из языков .NET Framework, например, Visual Basic или C# и бывают упакованы в пакет .NET Framework с расширением .dll. Эти пакеты называются оснастки или PSSnapin. В действительности оболочка не содержит встроенных <span style=" color:#980004;">командлетов</span>; она автоматически загружает несколько <span style=" color:#980004;">оснасток</span>, когда вы открываете новое окно в оболочке. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Тот факт, что Dir – это псевдоним, объяснят причину, по которой Dir /s не работает: вы используете не привычную команду Dir, а командлет Get-ChildItem, для которого Dir – это псевдоним. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вы не ограничены использованием псевдонимов, предустановленных в Windows PowerShell. Вы можете создавать свои собственные псевдонимы, импортировать и экспортировать их, делиться ими с коллегами и сотрудниками. Вы можете даже удалять псевдонимы – в Windows PowerShell они хранятся в ALIAS:, поэтому удаление той или иной единицы с данного диска удаляет псевдоним. Однако не стоит беспокоиться о том, что вы случайно можете удалить один из базовых псевдонимов: все изменения действуют лишь в пределах одной сессии, каждый раз при открытии нового окна восстанавливаются исходные параметры. Точно так же созданные вами новые псевдонимы будут работать только в рамках текущей сессии. Экспорт созданных псевдонимов в отдельный файл упростит их <span style=" color:#980004;">импортирование</span> обратно в будущем. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вы можете также создать автоматизированный профиль, который будет определять псевдонимы и выполнять прочие стартовые задачи каждый раз при открытии нового окна. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вот несколько команд, которые вы можете использовать для управления псевдонимами: </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="OLE_LINK68"></a><span style=" font-family:'Symbol';">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">       </span><span style=" font-weight:600;">Get-Alias</span> – отображение список всех псевдонимов. Также можно использовать Dir Alias: чтобы увидеть все содержимое папки ALIAS: drive. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol';">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">       </span><span style=" font-weight:600;">New-Alias</span> – создание нового псевдонима. Здесь обязательно указать имя нового псевдонима, а также название команды, для которой он предназначен. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol';">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">       </span><span style=" font-weight:600;">Del или Rm</span> – удаление псевдонима из ALIAS: drive. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol';">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">       </span><span style=" font-weight:600;">Import-Alias и Export-Alias</span> – импорт и экспорт псевдонимов в файл и из файла. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683698"></a><span style=" font-size:x-large; font-weight:600;">И</span><span style=" font-size:x-large; font-weight:600;">спользование справки</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Одно из главных достоинств графического пользовательского интерфейса (<span style=" color:#980004;">GUI</span>) – это его простота. Возможно, вы уже имели возможность убедиться в этом на собственном опыте, пусть даже и не осознавая это: блуждая по меню, чтобы посмотреть доступные функции, кликая правой кнопкой мыши, чтобы увидеть, какие действия предлагаются в контекстном меню или наводя курсор на иконки, чтобы увидеть всплывающие подсказки. Все это можно сделать с помощью графического интерфейса, не прилагая особых усилий. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В интерфейсе командной строки этого удобства явно недостает. Традиционно это делает такие оболочки более сложными в изучении, поскольку стартовая точка отсутствует. В Windows PowerShell, однако, предусмотрены некоторые подсказки, которые помогут вам изучить оболочку и выяснить, какие функции вам доступны. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Одной из таких подсказок является встроенная справочная система. Большая часть <span style=" color:#980004;">командлетов</span> Microsoft включает подробное описание. Просто запустите команду <span style=" font-weight:600;">Help</span>, дополненную названием командлета или псевдонимом, и вы увидите подробное описание данного командлета. В случае, если вы указываете псевдоним, вам будет показано описание командлета, благодаря чему вы сможете узнать его полное название (если все, что вы знали до этого, был псевдоним). </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Попробуйте выяснить название командлета для таких псевдонимов, как <span style=" font-weight:600;">Type</span>, <span style=" font-weight:600;">Cat</span>, и <span style=" font-weight:600;">Del</span>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если вы знакомы с названием команд в Unix, вы можете использовать <span style=" font-weight:600;">Man</span> вместо <span style=" font-weight:600;">Help</span> – результат будет тот же. </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="OLE_LINK70"></a>С помощью некоторых параметров команды Help можно получить еще более подробную информацию: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol';">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">       </span>-<span style=" font-weight:600;">detailed</span> – показ более детального описания </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol';">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">       </span>-<span style=" font-weight:600;">examples</span> – показ примеров использования </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol';">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">       </span>-<span style=" font-weight:600;">full</span> – показ полной информации, включая детальное описание, описание каждого параметра и примеры использования </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol';">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">       </span>-<span style=" font-weight:600;">online</span> – открытие <span style=" color:#980004;">браузера</span> и показ описания <span style=" color:#980004;">командлетов</span> на сайте Microsoft. На сайте может содержаться обновленная или расширенная информация, которая еще не была выпущена в служебном пакете. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Например, чтобы увидеть полное описание командлета Get-ChildItem, вам необходимо запустить команду </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Help gci –full</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если той информации, что вы почерпнули из данного курса, вам кажется недостаточно, учитесь использовать справочную систему оболочки. Сроднитесь с ней. Пользуйтесь ей как можно чаще, чтобы не только запоминать синтаксис <span style=" color:#980004;">командлетов</span>, но и осваивать их возможности. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Прочитайте описание каждого командлета, который встретится вам в процессе изучения курса. Большинство <span style=" color:#980004;">командлетов</span> имеют дополнительные функции и возможности, знание которых может рано или поздно пригодиться. Также возьмите в привычку использовать параметр – example в совокупности с командой Help. Примеры использования – это лучший способ узнать о возможностях <span style=" color:#980004;">командлетов</span>, запомнить написание и.т.д. Нет нужды искать примеры в Интернете – все необходимые примеры встроены в справочную систему оболочки; ими можно воспользоваться в любое удобное время. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Иногда очень неудобно заглядывать в справку, особенно, если вы уже почти закончили написание длинной команды. Помните, что в таком случае вы можете открыть новое окно и заглянуть в справочник там, не прерывая работы в первом окне. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В процессе изучения справочной информации вы заметите, что <span style=" color:#980004;">командлеты</span> Windows PowerShell обычно поддерживают один или несколько параметров. Краткий справочник по синтаксису в файле справки дает ряд полезных советов о том, как эти параметры работают. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Некоторые параметры не требуют значения. Они называются переключателями и используются, чтобы указать, должна текущая команда отправить дополнительные запросы или активировать другой параметр для запуска команды или нет. В справочнике эти параметры можно узнать по отсутствию значения после названия параметра: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">-Recurse </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Другие параметры требуют ввода значения – в справочнике указано, какое значение (например, число или строка) необходимо тому или иному параметру: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">-Exclude &lt;string[]&gt; </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Некоторые параметры являются обязательными – без них командлет не будет функционировать. Если вы забыли указать обязательный параметр, оболочка, скорее всего, потребует указать недостающую информацию: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">PS C:\&gt; new-aduser </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">cmdlet New-ADUser at command pipeline position 1 </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Supply values for the following parameters: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Name: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Другие параметры являются опционными – их легко отличить по тому, что и сам параметр и его значение заключены в квадратные скобки: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">[-Include &lt;string[]&gt;] </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Такая форма значения как string[], с пустыми квадратными скобками сразу после значения говорит о том, что параметр может иметь больше одного значения. Один из способов придать параметру несколько значений – напечатать эти значения в ряд, разделяя запятой. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Многие параметры имеют имя, что означает, что вы обязательно должны указывать и имя самого параметра, и его значение. Их можно узнать по отсутствию квадратных скобок вокруг имени параметра, даже если он является опционным: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">[-Exclude &lt;string[]&gt;] </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Другими словами, если вы захотите использовать этот параметр, вы обязательно должны указать его имя. Перед именем параметра всегда ставится дефис, а значение всегда отделяется от имени пробелом: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">-Exclude &quot;*.dll&quot; </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Помимо этого, есть так называемые позиционные параметры. Их отличительной особенностью является наличие квадратных скобок только вокруг имени параметра: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">[-Path] &lt;string[]&gt; </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Позиционные параметры позволяют печатать только значение, при условии, что печатаете вы в соответствующем месте (позиции). То есть, если ранее был напечатан параметр –LiteralPath, вы можете напечатать просто его значение на первой позиции: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Get-ChildItem *.* </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вы можете определить верную позицию, вызвав полную справку с помощью команды –full help: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">-Path &lt;string[]&gt; </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Specifies a path to one or more locations </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Required? false </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Position? 1 </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Default value </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Accept pipeline input? true (ByV </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Accept wildcard characters? false </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Когда вы набираете имя параметра, вам необязательно печатать его полностью. Достаточно набрать лишь первые буквы, чтобы Windows PowerShell определила, какой именно параметр вы имеете в виду. Например, вместо того, чтобы набирать –computerName, вы можете напечатать просто –comp, или даже –c, если командлет не имеет других параметров, имя которых начинается с буквы c.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683699"></a><span style=" font-size:x-large; font-weight:600;">Р</span><span style=" font-size:x-large; font-weight:600;">асширение оболочки</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="OLE_LINK72"></a><span style=" color:#980004;">К</span><span style=" color:#980004;">омандлеты</span>, присутствующие по умолчанию в оболочке, не являются единственными доступными для вас командлетами. Microsoft, так же, как и сторонние разработчики программного обеспечения, могут создавать дополнительные <span style=" color:#980004;">командлеты</span> и провайдеры PSDrive, и предоставлять их вам в виде <span style=" color:#980004;">оснасток</span> или модулей. Управление оснастками осуществляется с помощью набора <span style=" color:#980004;">командлетов</span>, название которых включает существительное PSSnapin: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol';">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">       </span>Get-PSSnapin </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol';">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">       </span>Add-PSSnapin </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Symbol';">·</span><span style=" font-family:'Times New Roman'; font-size:7pt;">       </span>Remove-PSSnapin </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Оснастки, как правило, следует устанавливать с использованием установочного пакета, так как они должны быть зарегистрированы в оболочке. Чтобы увидеть список зарегистрированных <span style=" color:#980004;">оснасток</span> (кроме тех, что установлены по умолчанию), запустите команду: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Get-PSSnapin –registered </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">О прочих возможностях командлета Get-PSSnapin можно узнать в справочнике. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модули, в свою очередь, могут не требовать установки, хотя это зависит от того, какие именно функции выполняет тот или иной модуль. Windows PowerShell располагает тремя основными командлетами для управления модулями: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Import-Module </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Remove-Module </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">• Get-Module </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы увидеть список установленных модулей, запустите команду: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Get-Module –list </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Windows PowerShell ищет модули в конкретных папках. Чтобы увидеть, в каких папках осуществляется поиск, запустите команду: </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Type Env:\PSModulePath </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вы можете модифицировать эту переменную среды, изменяя или добавляя папки, в которых хранятся модули. Обратите внимание, что расширения иногда могут изменять командлеты, присутствующие в оболочке по умолчанию, тем самым меняя их поведение. </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>