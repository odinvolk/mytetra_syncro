<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:14pt; font-weight:600;">Statifier</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Когда-то давно, под Linux был такой проект - statifier. Он есть и сейчас, и даже немного шевелится. Вот его сайт:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://statifier.sourceforge.net/"><span style=" text-decoration: underline; color:#0000ff;">http://statifier.sourceforge.net/</span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы преобразовать динамически слинкованный бинарник в статический, нужно запустить команду</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">statifier &lt;inputBin&gt; &lt;outputBin&gt;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вот и все. К сожалению, похоже, что этот проект заточен только под Linux семейства RedHat (о чем недвусмысленно пишут на сайте), поэтому толку от полученного бинарника немного. У меня получалось собрать через Statifier бинарник в RedHat и запустить его на Fedora и AltLinux. Но он же не работал на Debian и Ubuntu.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:14pt; font-weight:600;">Использование нестандартных системных библиотек</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Одна из проблем, почему полученные через <span style=" font-weight:600;">statifier</span> бинарники неработоспособны на других дистрибутивах сводится к тому, что они не могут работать с другой версией glibc. То есть решается только половина задачи - сторонние библиотеки не нужны, но мажорную версию glibc нужно иметь ту же самую, что и у разработчика. </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы обойти эту проблему, люди используют, как минимум, два метода:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вместо glibc используют musl</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Собирают кросскомпилятором с uClibc и хидерами нужного ядра (например 2.6.32)</li></ol>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Здесь следует пояснить, что из себя предстваляют нестандартные библиотеки, которые могут заменить glibc.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">musl</span><span style=" color:#000000;"> - новая стандартная Си-библиотека, ориентированная для использования в Linux-устройствах нового поколения. Библиотека </span>имеет<span style=" color:#000000;"> небольшой размер и высокую производительность, а разработчики стараются соблюдать стандарты POSIX. Код Musl </span>поставляется<span style=" color:#000000;"> под свободной лицензией MIT, допускающей использование библиотеки в закрытых проектах.<br /><br />Musl является универсальной реализацией libc и подходит для применения как на стационарных ПК и серверах, так и на мобильных системах, сочетая полноценную поддержку стандартов, свойственную для полновесных библиотек, таких как Glibc (GNU C library), с небольшим размером, низким потреблением ресурсов и высокой производительностью, свойственными специализированным вариантам libc для встраиваемых систем, таких как uClibc, dietlibc и Android Bionic. Musl </span>предоставляет<span style=" color:#000000;"> полную поддержку всех обязательных интерфейсов C99 и POSIX 2008, а также частично C11 и набор расширений, получивших распространение в Linux-окружениях. В том числе библиотека предоставляет средства для многопоточного программирования (POSIX threads), управления памятью и работы с локалями.<br /><br />Проект Musl старается придерживаться совместимости с Glibc в части функциональности, как на бинарном уровне, так и на уровне исходных текстов. При этом, Musl не ставит перед собой цель обеспечения совместимости с Glibc на уровне </span>ошибок<span style=" color:#000000;">, идущих вразрез со стандартами. На уровне исходных текстов обеспечена достаточно неплохая совместимость с Glibc. На бинарном уровне совместимость ещё оставляет желать лучшего - хотя уже можно загружать при использовании musl некоторые динамические библиотеки, собранные с Glibc.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">uClibc</span><span style=" color:#000000;"> — </span>стандартная библиотека<span style=" color:#000000;"> языка программирования </span>C<span style=" color:#000000;">, предназначенная для </span>встраиваемых систем<span style=" color:#000000;"> на базе </span>Linux<span style=" color:#000000;">. uClibc была разработана для поддержки </span>uCLinux<span style=" color:#000000;"> (специальная редакция ядра Linux, способная работать без </span>блока управления памятью<span style=" color:#000000;"> [MMU]) и таким образом подходящая для </span>микроконтроллеров<span style=" color:#000000;">. (буква u есть адаптация греческой буквы </span><a href="https://ru.wikipedia.org/wiki/%CE%9C"><span style=" text-decoration: underline; color:#000000;">µ</span></a><span style=" color:#000000;">, означающей «микро»). uClibc — </span>свободное программное обеспечение<span style=" color:#000000;">, распространяемое под </span>GNU LGPL<span style=" color:#000000;">.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Касательно методов компиляции с использованием вышеназванных библиотек, есть следующая информация. Существует инструмент <span style=" font-weight:600;">Buildroot</span>: <a href="https://buildroot.org/"><span style=" text-decoration: underline; color:#0000ff;">https://buildroot.org/</span></a><span style=" color:#000000;">. Официальная документация так описывает область его применения (вольный превод):</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Buildroot является инструментом, который упрощает и автоматизирует процесс создания целостной системы Linux для встраиваемых систем с помощью кросс-компиляции. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Buildroot с помощью кросс-компиляции способен генерировать набор основных инструментов, корневую файловую систему, образ ядра Linux и загрузчик. Buildroot может быть использован для любой части системы, независимо от других частей. В Buildroot можно, например, использовать существующий набор инструментов кросс-компиляции, и строить только корневую файловую систему. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Казалось бы, что этот инструментарий весьма далек от задачи получения статического бинарника. Однако в нем есть функционал по сборке кросс-компилятора под нужную архитектуру, с нужным uClibc или musl и для нужных хедеров ядра. А потом с полученным компилятором без проблем можно собирать статические бинарники.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как использовать Buildroot можно прочитать в англоязычной документации, которая написана весьма подробно. Информации в рунете по этой теме крайне мало. Но может быть, эта заметка кого-то направит на правильный путь.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>