<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Sans Serif'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Взаимодействие shell-скриптов с пользователем посредством Zenity</span><br /><br /><span style=" font-style:italic;">В данной статье речь пойдёт о том, каким образом можно без особых усилий <br />сделать графический интерфейс к shell-скриптам.</span><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br />Если вы хотите сделать взаимодействие ваших программ с пользователем более простым, то эта статья для вас, и не важно, какой язык вы используете, будь то bash, perl, python и т. п.<br /><br />Итак, Zenity является утилитой отображения диалогов. Программа имеется в составе большинства распостранённых дистрибутивов Linux, хотя ее можно скомпилировать или найти уже в бинарном виде практически для любой *nix-системы.<br /><br />Взаимодействие с X-сервером производится с помощью библиотеки GTK+.<br /><br />Рассмотрим функциональные возможности данной программы. Имеется десять видов диалогов.<br /><br />1. Calendar - календарь (date-picker).<br /><br />2. Entry - однострочное текстовое поле ввода.<br /><br />3. Text-info - диалог отображения многострочной текстовой информации, который может применяться и как поле ввода. Хотя, по всей видимости, это не является его основным назначением.<br /><br />4. Error - сообщение об ошибке.<br /><br />5. Info - сообщение общего характера.<br /><br />6. Warning - предупреждение.<br /><br />7. Question - вопросительное сообщение с возможностью ввода утвердительного или отрицательного ответа.<br /><br />8. File-selection - выбор файла.<br /><br />9. List - список с возможностью выбора и редактирования его элементов.<br /><br />10. Progress - Progress bar dialog. Отображает статус выполнения текущей операции.<br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br />Заставить утилиту делать то, что мы пожелаем, можно посредством запуска программы с соответствующими параметрами. Имя любого из параметров состоит более чем из одного символа и, следовательно, имеет префикс "--" - "два минуса". При завершении выполнения будут выведены результирующие данные в stdout или же код будет просто возвращён в stderr. Например, чтобы отобразить сообщение об ошибке, достаточно выполнить следующее:<br /><br /><br /># zenity --error<br /><br /><br />В результате мы увидим сообщение об ошибке.<br /><br />Все диалоги имеют некоторые свойства, значения которых также определяются параметрами запуска. Общие для всех диалогов свойства, то есть те, которыми обладают все диалоги, такие: title, window-icon, width, height. Очевидно, что title определяет заголовок окна, window-icon - пиктограмму, а width <br />и height - ширину и высоту окна соответственно.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br />Теперь можно поговорить о каждом из диалогов подробнее.<br /><br /><br /><span style=" font-weight:600;">Info, question, warning и error</span><br /><br />Text - выводимое сообщение. Различаются данные диалоги лишь пиктограммой, находящейся напротив сообщения. Question имеет две кнопки, соответствующие положительному и отрицательному ответу на сообщение.<br /><br /><br /><span style=" font-weight:600;">Calendar</span><br /><br />* Text - сообщение, выводимое над полем выбора даты.<br /><br />* Day, month и year - день, месяц и год, которые будут установлены по умолчанию.<br /><br />* Date-format - строка, определяющая формат возвращаемой даты. Формат строки эквивалентен формату вызова функции strftime.<br /><br />Попробуем написать простое приложение, запрашивающее дату рождения пользователя.<br /><br />-----8&lt;-----<br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">#! /usr/local/bin/perl<br />do<br />print `zenity --info --text "You may not enter real birth date" --title=birthday`;<br />while(!($birthdate = `zenity --calendar --date-format=%d.%m.%y`));<br />`zenity --info --text "Your birth date is $birthdate" --title "Your Bitrh Date"`;<br /><br />-----8&lt;-----<br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><span style=" font-weight:600;">Entry</span><br /><br />* Text - сообщение, выводимое над полем ввода.<br /><br />* Entry-text - текст, которым автоматически заполняется поле ввода.<br /><br />* Hide-text - если присутствует, то вводимые символы отображаются «звёздочками».<br /><br />В качестве примера попробуем написать простое приложение, осуществляющее запуск вводимой команды.<br /><br />-----8&lt;-----<br />#! /bin/sh<br /><br />```zenity --entry --title "Run command" --text "Command:```<br /><br />-----8&lt;-----<br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><span style=" font-weight:600;">List</span><br /><br />* Column - заголовок столбца.<br /><br />* Check-list - использование check box для первого столбца.<br /><br />* Radio-list - использование radio buttons для первого столбца.<br /><br />* Separator - разделитель, использующийся при выводе информации. По умолчанию это символ «|».<br /><br />* Editable - присутствие данного параметра означает, что пользователь может редактировать элементы списка.<br /><br /><br /><span style=" font-weight:600;">Text-info</span><br /><br />* File-name - имя файла, содержимое которого будет отображено.<br /><br />* Editable - использование данного параметра аналогично List.<br /><br /><br /><span style=" font-weight:600;">File-selection</span><br /><br />* File-name - имя файла, устанавливаемое по умолчанию.<br /><br />* Multiple - возможность выбора сразу нескольких файлов.<br /><br />* Separator - использование данного параметра аналогично List.<br /><br /><br /><span style=" font-weight:600;">Progress</span><br /><br />* Text - сообщение над progress bar.<br /><br />* Percentage - начальное состояние, указываемое в процентах.<br /><br />* Auto-close - автоматическое закрытие диалога после достижения 100%.<br /><br />* Pulsate - определяет отображение «пульсирующего» прогресса.<br /><br /><br /><br />Кроме того, Zenity имеет ещё несколько менее важных дополнительных опций.<br /><br />* --gdk-debug=FLAGS - установка флагов отладки Gdk;<br /><br />* --gdk-no-debug=FLAGS - отмена флагов отладки Gdk;<br /><br />* --display=DISPLAY;<br /><br />* --sync - использование синхронных X-вызовов;<br /><br />* --name=NAME - имя программы, используемое оконным менеджером;<br /><br />* --class=CLASS - класс программы, используемый оконным менеджером;<br /><br />* --gxid-host=HOST;<br /><br />* --gxid-port=PORT;<br /><br />* --gtk-debug=FLAGS - установка флагов отладки Gtk+;<br /><br />* --gtk-no-debug=FLAGS - отмена флагов отладки Gtk+;<br /><br />* --g-fatal-warnings - все предупреждения приводят к завершению выполнения;<br /><br />* --gtk-module=MODULE - загрузить дополнительный модуль Gtk.<br /><br /><br />Кроме Zenity, есть ещё такие средства, как <span style=" font-weight:600;">xdialog</span>, <span style=" font-weight:600;">dialog</span>, <span style=" font-weight:600;">kdialog</span>, <span style=" font-weight:600;">xmessage</span>. Рассмотрим вкратце некоторые из них.<br /><br /><span style=" font-weight:600;">Dialog</span> - программа, использующая Ncurses для вывода диалогов. Вследствие этого является достаточно универсальной, так как не все и не всегда пользуются X-Window.<br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вот список параметров dialog:<br /><br />* --yesno <br /><br />* --msgbox <br /><br />* --prgbox «» <br /><br />* --infobox <br /><br />* --inputbox []<br /><br />* --textbox <br /><br />* --menu ...<br /><br />* --checklist ...<br /><br />* --radiolist ...<br /><br />* --ftree <br /><br />* --tree ...<br /><br /><span style=" font-weight:600;">Kdialog</span> поставляется в составе KDE. Имеет сходный интерфейс с dialog и xdialog. Но, на мой взгляд, kdialog более избыточен и менее функционален, нежели Zenity. Xmessage предназначается исключительно для вывода сообщений, но внешний вид, думаю, редкого пользователя может порадовать.<br /><br />Необходимо учесть, что пользователь может и не иметь установленной Zenity. И не стоит забывать о том, что есть средства, такие как xdialog, dialog, kdialog, kmessage, и другие. Может быть, в вашем случае они подойдут больше. <br /><br /></p></body></html>