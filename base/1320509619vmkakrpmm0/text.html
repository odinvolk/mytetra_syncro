<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пару лет назад, когда только появился CodeIgniter 2.0, многие веб-разработчики ругали его хозяев - EllisLab Inc. - за неповоротливость и медленное развитие этого фреймверка. Версия 2.0 не принесла ничего сверхнового в CodeIgniter, революционного скачка в развитии не произошло. Компания EllisLab Inc. неторопливо и методично патчила баги, и доводила до ума уже существующие подсистемы, писала документацию на изменения.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В то же время появилась и стала активно развиваться новая OpenSource ветка игнайтера - Kohana. Она быстро получила развёрнутую ООП структуру, была доработана концепция каскадной файловой системы, был создан центральный конфиг <span style=" font-family:'Courier New'; color:#6a0e07;">bootstrap</span>, сделаны методы контроллера <span style=" font-family:'Courier New'; color:#6a0e07;">before</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">after</span>, сделаны объект маршрутизации <span style=" font-family:'Courier New'; color:#6a0e07;">Route</span> и объект ответа <span style=" font-family:'Courier New'; color:#6a0e07;">Request</span>... Много чего было сделано. Кроме того, в Kohana был быстро реализован механизм HMVC.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ничем этим CodeIgniter похвастаться не мог. Казалось бы, выбор очевиден: нужно внедрять Kohana во все поля. Но не всё так просто. На практике оказалось, что стремительное развитие Kohana сильно влияет на разработку сайтов. Например, если баг исправлялся в новой версии, то исправление заодно сопровождалось и другими изменениями, которые нарушали совместимость с предыдущей версией. На стабильное API разработчикам Kohana плевать - им нужен идеал системы, и они выпускают новые версии, совершенно не заморачиваясь с тем, что уже существующий код под ней либо не будет работать, либо потребует значительной переработки. То что вчера было обычным классом, сегодня становится синглтоном. То что вчера надо было создавать через оператор new, сегодня надо создавать через фабрику объектов. То что вчера было свойством класса, сегодня становится методом доступа. Лёгким движением руки разработчиков устоявшийся функционал класса разделяют на два других класса. И конца и края этому невидно.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Дело дошло до того, что с официального сайта Kohana была удалена официальная документация - она просто не успевала за изменениями. Новая официальная документация стала генерироваться на основе кода, и теперь не содержит таких важных разделов как User Guide по основным подсистемам. Точнее, разделы есть, но они пустые. С другой стороны, в интернете есть много информации по Kohana, даже на русском языке. Проблема в том, что она очень разрозненна и в большинстве своём устаревшая. </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В общем, потратив пару месяцев на изучение фреймверка Kohana, и написав рабочий прототип проекта, я понял, что каши с Kohana не сваришь. Пользуясь им, нельзя полагаться на документацию и статьи в интернете - надо постоянно расковыривать код чтобы во-первых до конца понять концепцию одного или другого модуля, а во-вторых чтобы учесть особенности реализации. А это очень тормозит разработку. </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Поэтому, когда я узнал, что в CodeIgniter с некоторых пор есть поддержка HMVC, я очень обрадовался. Впринципе, только его и не хватало в CodeIgniter, чтобы сделать разработку более простой и качественной. Оказалось, что хотя расширение HMVC не входит в стандартную поставку CodeIgniter, его очень легко установить, и многие им пользуются.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Особенности HMVC в CodeIgniter</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Рсширение HMVC в CodeIgniter добавляет следующий функционал.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1. Появляется возможность работать с модулями, у которых модели, виды и контроллеры хранятся в одной поддиректории. Дерево каталогов модулей выглядит так:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">modules</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> module1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">  models</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">  views</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">  controllers</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> module2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">  models</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">  views</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">  controllers</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> ...</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2. Появляется возможность вызова одного контроллера из другого посредством URI. В принципе, это и есть главное назначение HMVC в PHP-фреймверках.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Установка расширения HMVC</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1. Установите CodeIgniter 2.0.x;</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2. Проверьте корректность значения <span style=" font-family:'Courier New'; color:#6a0e07;">$config[‘base_url’]</span>;</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">3. Откройте URL <span style=" font-family:'Courier New'; color:#6a0e07;">/index.php/welcome</span>, и удостоверьтесь, что браузер отображает страницу приветствия CodeIgniter;</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">4. Скачайте архив HMVC Modular Extention с официального сайта (<span style=" text-decoration: underline;">https://bitbucket.org/wiredesignz/codeigniter-modular-extensions-hmvc/downloads</span>, ветка default). Содержимое каталога <span style=" font-family:'Courier New'; color:#6a0e07;">third_party</span> из архива поместите в каталог <span style=" font-family:'Courier New'; color:#6a0e07;">APPLICATION/third_party</span> фреймверка CodeIgniter.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">5. Содержимое каталога <span style=" font-family:'Courier New'; color:#6a0e07;">core</span> из архива поместите в каталог <span style=" font-family:'Courier New'; color:#6a0e07;">APPLICATION/core</span>.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">6. Откройте URL <span style=" font-family:'Courier New'; color:#6a0e07;">/index.php/welcome</span>, и удостоверьтесь, что браузер  может по-прежнему отображать страницу приветствия CodeIgniter;</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">7. Создайте директорию <span style=" font-family:'Courier New'; color:#6a0e07;">APPLICATION/modules/welcome/controllers</span>;</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">8. Перенесите файл <span style=" font-family:'Courier New'; color:#6a0e07;">APPLICATION/controllers/welcome.php</span> в директорию <span style=" font-family:'Courier New'; color:#6a0e07;">APPLICATION/modules/welcome/controllers</span>;</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">9. Откройте URL /index.php/welcome, и удостоверьтесь, что после переноса контроллера в модуль, браузер по-прежнему отображает страницу приветствия CodeIgniter;</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">10. Создайте директорию <span style=" font-family:'Courier New'; color:#6a0e07;">APPLICATION/modules/welcome/views</span>;</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">11. Перенесите файл <span style=" font-family:'Courier New'; color:#6a0e07;">APPLICATION/views/welcome_message.php</span> в директорию <span style=" font-family:'Courier New'; color:#6a0e07;">APPLICATION/modules/welcome/views</span>;</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">12. Откройте URL <span style=" font-family:'Courier New'; color:#6a0e07;">/index.php/welcome</span>, и удостоверьтесь, что после переноса файла вида в модуль, браузер по-прежнему отображает страницу приветствия CodeIgniter;</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Эти действия я сделал на уже рабочем CodeIgniter-е. Ничего не поломалось, CodeIgniter продолжил работать как прежде.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">После установки дополнения HMVC</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Заранее следует знать, что после установки дополнения HMVC обычная схема вызова контроллера через URL продолжает по-прежнему работать. Это значит, что можно продолжать размещать контроллеры в каталоге <span style=" font-family:'Courier New'; color:#6a0e07;">APPLICATION/controllers</span> и в его подкаталогах, и они будут правильно вызываться. Например, при запросе</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">http://mysite.ru/controller1/method2/value3</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">в контроллере <span style=" font-family:'Courier New'; color:#6a0e07;">APPLICATION/controllers/controller1.php</span> будет вызван метод <span style=" font-family:'Courier New'; color:#6a0e07;">method2</span> с параметром<span style=" font-family:'Courier New'; color:#6a0e07;"> value3</span>. То есть, всё остается так же как и было в &quot;обычном&quot; CodeIgniter. Но дополнительно появляется возможность вызывать контроллеры модулей. </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Вызов контроллеров в модулях через URL</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После установки расширения HMVC, как было показано ранее, в системе появляется каталог <span style=" font-family:'Courier New'; color:#6a0e07;">APPLICATION/modules</span>. В нём можно создавать подкаталоги с именами модулей, а внутри - подкаталоги <span style=" font-family:'Courier New'; color:#6a0e07;">controllers</span>, <span style=" font-family:'Courier New'; color:#6a0e07;">views</span>, <span style=" font-family:'Courier New'; color:#6a0e07;">models</span>.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Предположим, что нам нужно сделать модуль <span style=" font-weight:600;">news</span>, который должен генерировать HTML-код новостей. В каталоге <span style=" font-family:'Courier New'; color:#6a0e07;">APPLICATION/modules</span> создаем подкаталог <span style=" font-family:'Courier New'; color:#6a0e07;">news</span>, а в нём создаем подкаталоги  <span style=" font-family:'Courier New'; color:#6a0e07;">controllers</span>, <span style=" font-family:'Courier New'; color:#6a0e07;">views</span>, <span style=" font-family:'Courier New'; color:#6a0e07;">models</span>.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В каталоге <span style=" font-family:'Courier New'; color:#6a0e07;">APPLICATION/modules/news/controllers</span> создаём файл <span style=" font-family:'Courier New'; color:#6a0e07;">news.php</span>. В нем пишем код контроллера, унаследовавшись от MX_Controller (а не от CI_Controller, это важно).</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Далее, чтобы обратиться к какому-нибудь методу такого контроллера, можно воспользоваться URL следующего вида:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">http://mysite.ru/&lt;имя_модуля&gt;/&lt;имя_контроллера&gt;/&lt;имя_метода&gt;/&lt;переменные&gt;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">То есть, мы можем вызвать метод <span style=" font-family:'Courier New'; color:#6a0e07;">draw(10)</span> контроллера <span style=" font-family:'Courier New'; color:#6a0e07;">news.php</span> модуля <span style=" font-weight:600;">news</span> следующим образом: </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">http://mysite.ru/news/news/draw/10</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так же доступна сокращенная запись, если имя модуля и имя контроллера этого модуля совпадают:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">http://mysite.ru/news/draw/10</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Кстати, если будет существовать два контроллера с одинаковым именем, сделанные в &quot;стандартном&quot; стиле, и в HMVC-стиле, то приоритет при вызове через URL будет у HMVC контроллера.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Вызов контроллера через HMVC</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вызов одного контроллера из другого контроллера через механизм HMVC происходит с помощью статического метода <span style=" font-family:'Courier New'; color:#6a0e07;">modules::run(&lt;URI&gt;)</span>.  Данный метод возвращает результат работы вызванного контроллера в виде строки.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Параметр &lt;URI&gt; задаётся по тем же правилам, что и URL. Например, код:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">$text=Modules::run('news/news/draw');</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">echo $text;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">вызовет в модуле <span style=" font-weight:600;">news</span> в контроллере <span style=" font-family:'Courier New'; color:#6a0e07;">news.php</span> метод <span style=" font-family:'Courier New'; color:#6a0e07;">draw()</span>.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В HMVC-вызове есть одно ограничение: нельзя передавать параметры в строке URI. Другими словами, вызов:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">$text=Modules::run('news/news/draw/10');</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">не сработает. Параметры следует передавать далее после строки с URI.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вот несколько примеров написания URI:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">// Имя модуля и имя контроллера разные, плюс указывается имя метода</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">modules::run('module/controller/method', $params, $...);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">// Имя модуля и имя контроллера совпадают, плюс указывается имя метода</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">modules::run('module/method', $params, $...);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">// Имя модуля и имя контроллера совпадают, метод index</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">modules::run('module', $params, $...);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Есть важное ограничение, о котором обязательно нужно знать. Невозможно вызвать через HMVC контроллер из &quot;обычного&quot; контроллера. Другими словами, невоможно вызвать контроллер, унаследованный от MX_Controller, из контроллера, унаследованного от CI_Controller. Если так сделать, будет выдана ошибка:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">Fatal error: Cannot redeclare class CI</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Но тут есть хорошее решение. Контроллеры, оформляемые в виде &quot;обычных&quot; контроллеров - то есть те, которые классически размещаются в каталоге <span style=" font-family:'Courier New'; color:#6a0e07;">APPLICATION/controllers</span>, надо наследовать от MX_Controller (а не от CI_Controller), и тогда HMVC-вызовы будут работать везде.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>