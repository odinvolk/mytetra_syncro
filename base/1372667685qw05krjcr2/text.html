<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:8px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'normal Verdana,Tahoma,sans-serif'; font-size:xx-large; color:#333333;">Умение видеть абстракции</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://habrahabr.ru/hub/programming/"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#999999;">Программирование</span></a><span style=" font-family:'Verdana,sans-serif'; color:#999999;">*, </span><a href="http://habrahabr.ru/hub/cpp/"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#999999;">C++</span></a><span style=" font-family:'Verdana,sans-serif'; color:#999999;">*, </span><a href="http://habrahabr.ru/company/infopulse/"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#999999;">Блог компании Инфопульс Украина</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Моему сыну, как и многим мальчишкам, нравятся автомобили. Причём чем они больше и необычнее — тем больше нравятся. Когда мы идём по улице, а мимо проезжает эвакуатор или снегоуборочная машина, он неизменно дёргает меня за руку, указывает на заинтересовавший его объект и говорит: «Папа, б-р-р!». Говорит он так потому, что ему один год и вышеуказанные два слова составляют 40% его словарного запаса. Тем ни менее, в общем мысль понятна — обратить внимание на автомобиль. Давайте подумаем, каким образом ребёнок в возрасте 8-10 лет сказал бы своему сверстнику то же самое. Что-то вроде «Ух ты, смотри какая крутая тачка!», да? Мысль та же, но обратите внимание — уже шесть слов вместо двух. И, наконец, представьте, каким образом то же самое скажет человек лет в тридцать: «Эй, смотри, да это же Ferrari California 2008-го года выпуска с двигателем V8 мощностью в 454 лошадиных силы и 7-ми скоростной коробкой-автоматом! Она до сотни разгоняется за 3.9 секунды!». Да, здесь уже больше деталей, но, если вы не автомеханик или фанат Ferrari — они вам скорее всего не нужны и не важны. Основная же мысль — всё та же, что и в «Ух ты, смотри какая крутая тачка!» или «Папа, б-р-р!». Но выражена она уже в 30 слов. <br /><br />Вы заметили, как абстракция «интересный автомобиль» обросла деталями и нюансами, стала занимать существенно больше места в тексте и времени на понимание, анализ и ответ? То же самое происходит и с программным кодом.<br /></span><a name="habracut"></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:medium; color:#999999;">О чём вообще идёт речь</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />По моему мнению, основная характеристика хорошего программиста это не глубокие знания математики, не 100 лет опыта за плечами, не знания кучи языков и библиотек, не %куча_других_неважных_вещей%, а именно умение видеть абстракции. Не только видеть, конечно, а ещё и проектировать, использовать, исправлять и т.д. Но факт есть факт. Успех какого-нибудь популярного сегодня продукта (подставьте сюда свою любимую ОС, браузер, игру — да что угодно) определён именно тем, насколько хорошо спроектирована его архитектура, насколько хорошо высокоуровневые части отделены от низкоуровневых и друг от друга. <br /><br />Посмотрите на «умершие» проекты. Очень редко они погибают от того, что программист не смог на 10% повысить скорость работы, или потому что не смогли прикрутить нужную библиотеку. Чаще всего причина закрытия формулируется в духе «существующая архитектура делает принципиально невозможным дальнейшее развитие». Вот она, ошибка в видении абстракций. Кто-то когда-то давно не увидел, что несколько сущностей на самом деле являются одной, или что одна может иметь несколько представлений, или что на самом деле не клиент должен дёргать сервер, а наоборот, или что в протокол неплохо бы заложить возможность расширения — и вот он, грянувший спустя годы гром последствий. <br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:medium; color:#999999;">Паттерны</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />В современном мире программирования есть такая штука как «паттерны». Ну, знаете, книга банды четырёх, всякие там фабрики\синглтоны\обёртки\наблюдатели\фасады\мосты. Отношение программистов к паттернам неоднозначно. Есть лагерь любителей паттернов, которые справедливо утверждают, что это всё — квинтэссенция десятилетий лучшего программерского опыта, проверенные вещи и надо не тормозить, а использовать наработки по полной. И есть лагерь противников паттернов, которые пеняют им на излишнюю сложность (3-5 классов на реализацию одной идеи — вполне типично для средненького паттерна), говорят, что изучение паттернов подобно школьной зубрёжке — когда просто учишь что-то без понимания причин, следствий и вариантов именно целевого использования.<br /><br />Мне кажется, что дело тут опять-таки в связи паттернов с абстракциями. Некоторые паттерны целостны и однозначно описывают какую-то одну концепцию. Её можно понять, увидеть, реализовать, инкапсулировать в себе. Не важно, один там будет класс, пять или десять — если они формируют некую сущность, которая не зависит от внешнего окружения, которая может быть помещена в отдельный модуль и дальше использована через простой интерфейс — это хороший паттерн.<br /><br />Другие паттерны являются откровенным мусором. Просто потому, что вот эти два класса находятся в третьем, унаследованы от четвёртого и вызывают методы пятого — они не создают абстракцию. Возможно, они каким-то образом ускоряют код или обходят какое-то ограничение языка, но вот целостной идеи не формируют. Это трудно понять, невозможно запомнить и это вызывает праведный гнев в рациональном мозгу программиста. Примерно как случайный набор слов, не формирующий предложения — у читателя. Пижама сладкий прыгать Луна вопреки быстро люк?<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:medium; color:#999999;">Инструменты</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />К сожалению, современные средства разработки не дают хороших автоматических средств для того, чтобы видеть абстракции в проекте. Да, вы можете увидеть интерфейсы или абстрактные классы в коде — но не факт, что это то, что составляет настоящую абстракцию. Какой-то определённый слой логики может содержать в себе десятки интерфейсов, а другой — иметь всего один класс (и тот — просто пустая обёртка вокруг чего-то другого). Мы можем с помощью IDE увидеть классы, методы и переменные — но мы не видим реального разделения проекта на слои. Всё остаётся на совести программиста. К счастью, у нас сегодня есть возможность выносить код в отдельные модули, у нас есть пространства имён, интерфейсы, дельные советы по рефакторингу и инструменты для его осуществления. Написать хорошо разделённый на отдельные модули код — возможно. И это важнее, чем написать быстрый код. Конечно, «модульный код» не на 100% равно «идеальный код», но очень и очень к этому близко.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:medium; color:#999999;">Пример плохого кода</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Несколько лет назад был пик популярности текстового редактора Notepad++. Десятки миллионов загрузок, приятный минималистичный интерфейс, плагины. Начало было очень хорошее, ничто не предвещало беды. За последние пару лет данный текстовый редактор сдулся и фактически застопорился в своём развитии. Вот график его загрузок.<br /></span></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image7693.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br />В чём же причины? Я не берусь называть их все, но вот одна. Давайте посмотрим на один файл из его исходников. <br /></span><a href="http://sourceforge.net/p/notepad-plus/code/735/tree/trunk/PowerEditor/src/NppBigSwitch.cpp"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#990099;">NppBigSwitch.cpp</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br />Внимательнее разберём некоторые части этого кода.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#6da3bd;">Непонимание понятия 'имя переменной'</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#6da3bd;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Имя переменной — это не имя регистра процессора. Главная задача имени переменной не адресовать ячейку в памяти, а объяснить, что за данные в ней находятся. Просто для адресации можно было бы один раз в начале выделить массив в памяти и бегать по нему указателями. Именно имя переменной является той абстракцией, которая упрощает понимание кода. Здесь, как видим, не упрощает.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">Macro m = _macro;</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#6da3bd;">Непонимание работы систем контроля версий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Старому ненужному коду нужно быть удалённым с комментарием в отдельном коммите о том почему он был удалён. Если это ещё не дописанная функциональность — её место в отдельной ветке. Просто так держать нагромождения закомментированого кода в файлах проекта — значит не понимать идеи систем контроля версий.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">/*</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">        case NPPM_ADDREBAR :</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">        {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">            if (!lParam)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">                return FALSE;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">            _rebarTop.addBand((REBARBANDINFO*)lParam, false);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">            return TRUE;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">        case NPPM_UPDATEREBAR :</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">        {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">            if (!lParam || wParam &lt; REBAR_BAR_EXTERNAL)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">                return FALSE;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">            _rebarTop.reNew((int)wParam, (REBARBANDINFO*)lParam);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">            return TRUE;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">        case NPPM_REMOVEREBAR :</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">        {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">            if (wParam &lt; REBAR_BAR_EXTERNAL)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">                return FALSE;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">            _rebarTop.removeBand((int)wParam);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">            return TRUE;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080; background-color:#f7f7f9;">*/</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#6da3bd;">Непонимания того, где важнее скорость работы программы, а где - скорость работы программиста</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#6da3bd;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Ничего так размерчик для одной функции, да? Автор, наверное, пытался сэкономить целый десяток наносекунд на вызов каждого отдельного кусочка кода через отдельную функцию. Молодец, сэкономил. И получил код, в котором противно копаться и нужно тратить кучу времени на понимание и исправление. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">LRESULT Notepad_plus::process(HWND hwnd, UINT Message, WPARAM wParam, LPARAM lParam)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080;">// тут 1800 строк кода</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">}</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#6da3bd;">Непонимания абстракций 'флаг', 'константа', 'магическое число'.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#6da3bd;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Что такое 0xFFFFFFFF, 1, 2 и 30? Ах да, 0xFFFFFFFF — означает что файл был закрыт. Какой чудесный комментарий, как всё наглядно! Было, видимо, очень быстро и удобно просто набросать цифры в код — компилируется ведь. Нет времени объяснять, поехали дальше, да?<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">nmdlg-&gt;Items[i] = </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#2f98ff;">0xFFFFFFFF</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">; </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808080;">// indicate file was closed</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">if</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> ((lParam == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#2f98ff;">1</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">) || (lParam == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#2f98ff;">2</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">long</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> view = MAIN_VIEW;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">view &lt;&lt;= </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#2f98ff;">30</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">return</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> view|i;</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#6da3bd;">Отсутствие абстракции над кодировками</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">В каждом месте, где имеет значение в юникоде скомпилирована программа или нет, мы видим конструкции, нагружающие мозг программиста ненужными в данный момент вещами. Даже в Win32 API, где многие функции имеют юникодную и неюникодную версии мы не думаем каждый раз что вызывать, просто пишем «MessageBox», а благодаря макросам это заменяется на MessageBoxA или MessageBoxW. Это позволяет подняться над данным уровнем, отключить мозг от необходимости помнить об этой детали. Авторам Notepad++ такой путь, видимо, кажется слишком лёгким.<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">case</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> COPYDATA_FILENAMESA :</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">char</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> *fileNamesA = (</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">char</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> *)pCopyData-&gt;lpData;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    CmdLineParams &amp; cmdLineParams = pNppParam-&gt;getCmdLineParams();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808000;">#ifdef UNICODE</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    WcharMbcsConvertor *wmc = WcharMbcsConvertor::getInstance();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">const</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">wchar_t</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> *fileNamesW = wmc-&gt;char2wchar(fileNamesA, CP_ACP);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    loadCommandlineParams(fileNamesW, &amp;cmdLineParams);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808000;">#else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    loadCommandlineParams(fileNamesA, &amp;cmdLineParams);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808000;">#endif</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">break</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">case</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> COPYDATA_FILENAMESW :</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">wchar_t</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> *fileNamesW = (</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">wchar_t</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> *)pCopyData-&gt;lpData;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    CmdLineParams &amp; cmdLineParams = pNppParam-&gt;getCmdLineParams();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808000;">#ifdef UNICODE</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    loadCommandlineParams(fileNamesW, &amp;cmdLineParams);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808000;">#else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    WcharMbcsConvertor *wmc = WcharMbcsConvertor::getInstance();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">const</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">char</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> *fileNamesA = wmc-&gt;wchar2char(fileNamesW, CP_ACP);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    loadCommandlineParams(fileNamesA, &amp;cmdLineParams);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808000;">#endif</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">break</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">                }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">            }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">            </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">return</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> TRUE;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">        }</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#6da3bd;">Отсутствие слоя абстракции над UI-примитивами операционной системы</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#6da3bd;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Каждый раз, когда нам нужно передвинуть окно, спрятать его или выполнить какое-либо иное действие с элементом интерфейса — дёргаются напрямую функции Win32 API. Никаких библиотек интерфейса, никаких обёрток, классов — ничего. В итоге — куча лишнего и дублирующегося кода, абсолютная непортируемость на другие ОС, все недостатки Win32 API — прямо внутри нашего кода. Причём авторы выставляют такой подход как преимущество продукта, дескать, никаких лишних компонентов! Это просто ужас. Сотые доли процента прироста производительности (в лучшем случае) — и ад в исходниках.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">::MoveWindow(_rebarTop.getHSelf(), </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#2f98ff;">0</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">, </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#2f98ff;">0</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">, rc.right, _rebarTop.getHeight(), TRUE);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">::SendMessage(_statusBar.getHSelf(), WM_SIZE, wParam, lParam);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Как результат всего вышеперечисленного, разработка Notepad++ является катастрофически сложным и медленным делом. Мой патч, исправляющий пару важных для меня багов висит в списке «на рассмотрении» уже полгода, вместе с почти 200 другими патчами. Автор, конечно, время от времени что-то из них принимает, но вы сами понимаете — делать это быстро с такой кодовой базой абсолютно невозможно. Мне очень жаль показавшийся мне когда-то хорошим редактор, но вы видите сами — смерть неизбежна.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:medium; color:#999999;">Пример хорошего кода</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Возможно, вам известна такая популярная библиотека как Qt — о ней в последнее время много пишут на Хабре. Я, опять-таки, не берусь утверждать, что знаю лучше всех все причины её успеха, но вот вам одна из них. Вся библиотека построена на прекрасном ядре абстракций: тут есть абстракции от платформы, от сети, от элементов интерфейса ОС, от кодировок, да практически от чего угодно. Взглянув на любой компонент Qt нам не нужно лезть сильно глубоко вниз или вверх, чтобы понять как он работает. Причём всё это не благодаря хорошей документации, а из-за кода самой библиотеки.<br /><br />Давайте посмотрим на один из заголовочных файлов библиотеки Qt.<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#6da3bd;">qpdfwriter.h</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808000;">#ifndef QPDFWRITER_H</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808000;">#define QPDFWRITER_H</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#808000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808000;">#include &lt;QtCore/qobject.h&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808000;">#include &lt;QtGui/qpagedpaintdevice.h&gt;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#808000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">QT_BEGIN_NAMESPACE</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">class</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> QIODevice;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">class</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> QPdfWriterPrivate;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">class</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> Q_GUI_EXPORT QPdfWriter : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">public</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> QObject, </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">public</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> QPagedPaintDevice</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    Q_OBJECT</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">public</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">explicit</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> QPdfWriter(</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">const</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> QString &amp;filename);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">explicit</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> QPdfWriter(QIODevice *device);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    ~QPdfWriter();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    QString title() </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">const</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">void</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> setTitle(</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">const</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> QString &amp;title);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    QString creator() </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">const</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">void</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> setCreator(</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">const</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> QString &amp;creator);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">bool</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> newPage();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">void</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> setPageSize(PageSize size);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">void</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> setPageSizeMM(</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">const</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> QSizeF &amp;size);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">void</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> setMargins(</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">const</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> Margins &amp;m);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">protected</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    QPaintEngine *paintEngine() </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">const</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">int</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;"> metric(PaintDeviceMetric id) </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">const</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#4d7386;">private</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    Q_DISABLE_COPY(QPdfWriter)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">    Q_DECLARE_PRIVATE(QPdfWriter)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">};</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222; background-color:#f7f7f9;">QT_END_NAMESPACE</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#808000;">#endif</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Не пугайтесь возможно незнакомых вам макросов — не о них речь. Я хочу обратить ваше внимание на другую вещь. Заметьте, в этом классе нет приватных свойств. И почти ни в одном другом классе Qt — тоже нет. Вернее, на самом деле в каждом из них есть ровно по одной приватной переменной — это неявно объявленный через макрос Q_DECLARE_PRIVATE указатель на подкласс, в котором уже и находятся все свойства и часть приватных методов. Сделано это по официальному объяснению для обеспечения бинарной совместимости — получается что данный класс в любой версии Qt имеет один и тот же размер (поскольку место для хранения одного указателя константно в пределах платформы) и его можно спокойно передавать туда-сюда между модулями, не боясь каких-нибудь там segmentation fault.<br /><br />На самом деле для меня вся прелесть этого решения в другом. Смотрите — мы открываем заголовочный файл и что же мы видим? Только публичные методы. Вы впервые видите этот заголовочный файл (да и вообще библиотеку Qt, может быть) — но вы ведь уже поняли, что это за класс и как его использовать, правда? Все внутренности изящно скрыты в приватном подклассе. К сожалению, классический С++ заставляет программиста смешивать в заголовочном файле и то, что нужно внешнему пользователю класса и его внутренности. Но в Qt при чтении заголовочного файла — мы видим чёткое послание от разработчиков Qt: «Внутренности этого класса тебе не нужны. Не твоё дело что там и как, это абстракция — используй её через публичные методы». И это прекрасно, чёрт возьми! Я хочу видеть все библиотеки в подобном стиле. Покажите мне нужные мне вещи сразу и спрячьте ненужные так, чтобы их нужно было искать долго и трудно. За этим подходом будущее, я уверен.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:medium; color:#999999;">Выводы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Большинство хороших советов для программистов типа «Используйте рефакторинг», «Применяйте хорошие паттерны», «Преждевременная оптимизация — зло», «Не пишите больших функций», «Не заводите глобальных переменных» на самом деле являются выводами из более общего совета «Умейте видеть абстракции». <br /><br />Приятного программирования.</span></p></body></html>