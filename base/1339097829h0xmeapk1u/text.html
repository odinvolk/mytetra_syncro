<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Arial'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Работа с Git репозиториями</span></p>
<p style="-qt-paragraph-type:empty; margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Почему Git</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Краткий ответ: потому что не появляются задержки от работы с системой контроля версий.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Git хранит всё локально, включая историю, ветки, коммиты и позволяет переключаться между всем добром без обращения к сети.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Авторизация в GIT производится по персональному ключу а не паролю, который кешируется на некоторое время на стороне клиента, а не запоминается навсегда в настройках клиента.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">GIT позволяет легко работать с ветками, без видоизменений раскладки репозитория, и древесный просмотр изменений позволяет видеть что из какой ветки пришло.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Более подробно можно прочитать </span><a href="http://habrahabr.ru/blogs/Git/104198/"><span style=" font-family:'DejaVu Sans'; font-size:10pt; text-decoration: underline; color:#0057ae;">http://habrahabr.ru/blogs/Git/104198/</span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Общие сведения о Git</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Подробно о работе с Git, что это такое можно прочитать в Git Book по адресу </span><a href="http://book.git-scm.com/"><span style=" font-family:'DejaVu Sans'; font-size:10pt; text-decoration: underline; color:#0057ae;">http://book.git-scm.com/</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В классических VCS (Version Control System) (CVS, SVN), в рабочей копии хранится текущее состояние репозитория, и базовая копия текущей ревизии. На сервере хранятся все ревизии в виде изменений от предыдущей, либо в виде полных копий каждой ревизии с вычислением разницы по запросу. Все ревизии нумеруются по порядку начиная от первой.<br />В случае CVS хранятся изменения и нумерая по каждому файлу независимо, в случае SVN, нумеруются изменения репозитория.<br />Так как SVN хранит только изменения всего репозитория, «ветки» в нем реализуются через специальную организацию файлов в хранилище. Классически, это /trunk/ для последнего кода, /branch/somename/ для веток. Для создания ветки, делается копия /trunk/ в /branch/somename/, над которым уже работает разработчик.<br />При этом, при каждом коммите, идёт обращение к центральному репозиторию, для сохранения изменения, отрабатывают скрипты на сервере, идет непрерывная нумерация изменений, запрос истории так же требует обращения на сервер и т.д.<br /><br />Git относится к классу DVCS (Distributed Version Control System). При этом рабочая копия содержит все коммиты, историю, ветки, всё необходимое для ведения разработки без обращения к какому-либо серверу. Для синхронизации изменений между разными копиями репозитория, в нужный момент делается pull чтобы скопировать изменения удалённого репозитория к себе, либо push чтобы скопировать локальные изменения в удалённый репозиторий. В случае с Git, каждый коммит имеет уникальный ID в виде хеша, содержащий в себе все файлы, относящиеся к нему.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Каждый коммит имеет один коммит-родитель, и, возможно, коммит-источник слияния. Таким образом, коммиты представляют собой дерево наборов файлов. «Веткой» является указатель на какой-либо коммит. Таким образом, чтобы создать ветку, нужно просто дать имя какому-либо коммиту. Чтобы слить две ветки, одна из которых начинается с конца другой, можно просто передвинуть указатель второй ветки на новый коммит (это называется Fast-Forward).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Чтобы поддерживать «плоскую» основную ветку (master), используется техника ребейза веток перед слиянием, и слияение без fast-forward'а.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Rebase означает смену родителя ветки на новый коммит. При ребейзе все изменения, внесенные в данной ветке, откатываются назад и сохраняются в виде изменений, внесенных каждым коммитом; после чего указатель ветки переносится на новое начало, и на него последовательно начинают применяться изменения. Если конфликтов нет, то изменения накладываются автоматически, после чего ветка представляет собой набор изменений относительно нового начала.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Если теперь сделать слияние этой ветки с исходной, указатель головы исходной ветки будет просто передвинут на новое место, и мы потеряем информацию о том, что вообще существовала новая ветка. Именно поэтому используется слияние без fast-forward'а. При этом, даже если новая ветка начинается с конца предыдущей, создаётся специальный merge-commit, содержащий информацию о том, что в этом месте сливается текущая ветка с дополнительной.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Подробнее о том, что такое rebase в картиках тут: </span><a href="http://book.git-scm.com/4_rebasing.html"><span style=" font-family:'DejaVu Sans'; font-size:10pt; text-decoration: underline; color:#0057ae;">http://book.git-scm.com/4_rebasing.html</span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Алгоритм работы над задачей</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Стандартный алгоритм работы над какой-либо задачей выглядит так:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создаётся ветка, основывающаяся на последней копии master ветки. Название новой ветки содержит класс задачи, краткое описание, номер задачи в БТ. Например feature/sessions_add_datetime_filter.5503 </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Все изменения производятся внутри этой ветки. При каждом атомарном логическом изменении (например, добавили плагин – закоммитили добавление; поправили API одной функции во всех местах – закоммитили и тп) создаётся свой коммит. Это позволяет разделять какие были изменения, упрощается чтение и проверка на ошибки процесса разработки. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После того как код в ветке сделан и отлажен, все изменения закоммичены, данная ветка ребейзится относительно последнего мастера, и пушится в центральный репозиторий. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Второй человек, работающий над тем же проектом, делает к себе pull центрального репозитория. Если он уже смотрел – то удаляет свою локальную копию ветки, после чего переключается на указанную ветку. Прочитывает код, проверяет его работоспособность, после чего либо отдаёт на доработку, если там обнаружены проблемы, либо делает еще раз rebase поверх мастера, и слияние ветки с мастером. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После слияния с мастером, ревьюер пушит новый мастер в центральный репозиторий, удаляет у себя локальную ветку задачи, пушит в мастер удаление ветки задачи. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Разработчик удаляет локальную ветку задачи после того как задача была закрыта и изменения попали в master.</li></ol>
<p style="-qt-paragraph-type:empty; margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Правила ведения чистых коммитов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Все коммиты, которые попадают в центральную ветку, должны следовать следующим правилам:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Автором должен быть прописан разработчик – Имя, Фамилия, рабочий e-mail. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Текст комментария должен содержать краткое описание изменения. Для зарубежных проектов описание обязано быть на английском языке, для проектов российского бранча приемлемо комментировать на русском. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Коммит не должен содержать в себе файлы, не относящиеся к изменениям. Если ваша IDE, OS, какой-то плагин какому-либо софту использующемуся при разработке создают технические файлы, либо добавьте их в .gitignore, либо не добавляйте к коммиту, либо удаляйте перед коммитом. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Коммит не должен добавлять/убирать пустые строки, менять пробелы на табы и наоборот, менять число пробелов и т. п. нигде, кроме случаев, относящихся к сути коммита. То есть при рефакторинге это нормально, но если ваш редактор поменял во всем файлые пробелы на табы или наоборот – меняйте настройки редактора или перед коммитом приводите всё к виду «как было». </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Стиль исходного кода и отступов должен совпадать с текстом вокруг. То есть, если всюду в файле используются табы для отступа, не следует вставлять еще один case выровненный пробелами. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Минимизация конфликтов. При добавлении кода следует стараться форматировать код так, чтобы модификация его приводила к минимуму конфликтов при слиянии.</li></ol>
<p style="-qt-paragraph-type:empty; margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:14pt; font-weight:600;">Работа под Windows</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для работы с Git под Windows самое удобное – использовать TortoiseGit. Однако следует знать, что на 2017 год есть более удобный инструмент - SmartGit.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Подготовка к работе</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Устанавливается putty со страницы <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/"><span style=" text-decoration: underline; color:#0057ae;">http://www.chiark.greenend.org.uk/~sgtatham/putty/</span></a><br />Лучше всего ставить полный пакет, со всеми программами. По надобятся как минимум plink, puttygen. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Устанавливается msysGit из проекта <a href="http://code.google.com/p/msysgit/"><span style=" text-decoration: underline; color:#0057ae;">http://code.google.com/p/msysgit/</span></a><br />Выбрать опции при установке «Add “Git Bash here”», «Run Git from the Windows Command Prompt», «Use Windows style line endings», когда спросит – дать путь до plink.exe </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Устанавливается TortoiseGit из проекта <a href="http://code.google.com/p/tortoisegit/"><span style=" text-decoration: underline; color:#0057ae;">http://code.google.com/p/tortoisegit/</span></a><br />После установки зайти в TortoiseGit → Settings → Git → Config, убедиться что путь до msysgit задан, и что опции AutoCRLF и SafeCRLF установлены, настроены имя, фамилия, email разработчика. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">С помощью puttygen создаётся пара приватный+публичный ключ.<br />Публичный ключ высылается админам для добавления в доступы репозиториев и серверов.<br />Приватный ключ добавляется в pagent через клик правой кнопкой → add key.</li></ol>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Получение репозитория</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В папке, где будут размещаться все рабочие проекты, жмём<br />Правой кнопкой→TortoiseGit→Clone, вводим адрес центрального репозитория<br />ssh:</span><a href="mailto://git@dev.call2ru.com"><span style=" font-family:'DejaVu Sans'; font-size:10pt; text-decoration: underline; color:#0057ae;">//git@</span></a><span style=" font-family:'DejaVu Sans'; font-size:10pt;">СЕРВЕР:ПОРТ/РЕПОЗИТОРИЙ.git<br />В поле «Load Putty Key» выбираем путь до приватного ключа.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Основные используемые функции</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">При работе используются либо консольные утилиты, аналогично linux, либо графический интерфейс.</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обновление текущей ветки из центрального репозитория:<br />В контекстном меню папки с исходниками TortoiseGit-&gt;Pull<br /><br /><br /><img src="image173686111.png" /><br /><br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отправка текущей ветки в центральный репозиторий:<br />В контекстном меню TortoiseGit→Push<br />Выбираем в Local сперва master, потом нашу текущую ветку.<br />Remote заполняется при этом автоматически.<br />Название remote ветки должно быть идентично local </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Переключение на некоторую ветку:<br />В контекстном меню TortoiseGit→Switch/Checkout<br />В меню Branch выбрать remotes/origin/&lt;нужная ветка&gt;<br />[v] «Create new branch», название &lt;нужная ветка&gt;, [v] «Track» <br /><br /><br /><img src="image818988624.png" /><br /><br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создание новой ветки<br />Контекстное меню→TortoiseGit→Create Branch<br />В Name в Branch вводим нужное название ветки<br />Чтобы ветка базировалась от текущей, в Base On выбираем HEAD<br />Чтобы ветка базировалась от мастера, выбираем Branch, в списке master.<br />Ставим [v] Switch to new branch чтобы сразу переключиться на ветку.<br /><br /><br /><img src="image8019256.png" /><br /><br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Удаление веток<br />Открываем меню зажав кнопку Shift → TortoiseGit → Browse Reference<br />в разделе heads лежат локальные ветки, в разделе remotes\origin удалённые.<br />Выбираем нужную ветку, жмём правой кнопкой → Delete Remote Branch<br />Для локальной ветки, соответственно, Delete Branch. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Слияние ветки с текущей<br />Контекстное меню → TortoiseGit → Merge<br />выбираем Branch который нужно слить с текущей веткой<br />ставим обязательно галочку «No fast forward», Merge message не трогаем. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Просмотр и сохранение изменений<br />Файлы с изменениями помечены красными восклицательными знаками.<br />Чтобы посмотреть общую картину изменений, <br />Меню→Git Commit -&gt; “ветка”<br />Внизу список изменений в репозитории, обязательно нажимать галочку «View patch» и проверять изменения на предмет соответствия Правилам ведения чистых коммитов.</li></ol>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Стандартные процедуры работы</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">«Начало работы над задачей»<br />Выполняется перед началом работы над задачей. Дерево должно быть без изменений.<br />Меню → TortoiseGit → Switch/Checkout,<br />Branch: master<br />Меню → TortoiseGit → Pull<br />Меню → TortoiseGit → Create Branch<br />Name Branch: название новой ветки<br />Base On: HEAD (master)<br />[x] Switch to new branch </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">«Коммит очередного кусочка работы»<br />Выполняется после выполнения некого изменения, суть которого целостная.<br />Меню → Git commit -&gt; “имя ветки”<br />Отметить файлы, только нужные для данного конкретного коммита<br />Обязательно щелкнуть на «View Patch», и убедиться <br />в соответствии правилам ведения чистых коммита<br />В message ввести описание изменения, соответствующее правилам </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">«Отправка ветки на центральный репозиторий»<br />Выполняется после завершения работы, либо в конце каждого дня (чтобы был бакап на сервере), либо если нужно какие-то изменения показать коллеге.<br />Меню → TortoiseGit → Push <br />Выбираем в Local сперва master, потом нашу текущую ветку.<br />Remote заполняется при этом автоматически.<br />Название remote ветки должно быть идентично local<br />Не следует делать push после каждого коммита, так как это потребует доступа до удалённого сервера, и, соответственно, времени, потраченного впустую. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">«Ребейз относительно мастера»<br />Выполняется перед заливкой на сервер законченной задачи, когда все изменения уже закоммичены.<br />Меню → Git Sync<br />Local branch: master<br />Remote branch: master<br />Правая стрелочка вниз у первой кнопки (Pull по умолчанию), Fetch<br />Меню → TortoiseGit → *Rebase<br />Branch: текущая ветка<br />UpStream: master<br />Если будут конфликты – разобраться с ними через вкладку «Conflict File»<br />На выбор, правой кнопкой файла, утилиты<br />Edit Conflicts – позволяет по каждому расхождению выбрать<br />использовать версию какую блока<br />Resolve Conflicts Using<br />theirs – использовать версию мастера<br />mine – использовать версию текущей ветки<br />Open – открыть в редакторе, и исправить вручную<br />После исправления сделать Resolve<br />После исправления всех конфликтов нажать Commit<br />После ребейза нажать Done </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">«Кратковременное сохранение состояния изменений»<br />Выполняется, если требуется временно приостановить работу над текущей веткой на короткое время (например, на ревью, или чтобы сделать какую-либо двухминутную задачу).<br />Меню → TortoiseGit → Stash Save<br />После этого дерево чисто, можно переключиться на другую ветку/мастер и так далее, поработать, после чего восстановить состояние, если переключиться обратно на рабочую ветку, и сделать<br />Меню → TortoiseGit → Stash Pop<br />Тем самым восстановив состояние изменения. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">«Длительное сохранение состояния изменений»<br />Выполняется в конце рабочих суток, чтобы даже частичные изменения были забакаплены; либо при необходимости срочно переключиться на решение другой задачи, которая может занять значительно больше 5-10 минут.<br />Меню → Git Commit -&gt; “ветка”<br />Отмечаем все-все изменения (Select/Deselect All)<br />В текст сообщения пишем «Partial commit»<br />Позже, для возврата к тому же состоянию как было до, переключаемся на рабочую ветку, и делаем<br />Меню → TortoiseGit → Show Log<br />Выделяем коммит, который идет в дереве сразу перед «Partial commit»<br />Правой кнопкой → Reset &lt;ветка&gt; to this<br />Reset type: Mixed </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">«Ревью ветки»<br />Выполняется на чистом дереве, временно сохраните изменения согласно пункта 5, если требуется.<br />Меню → TortoiseGit → Switch/Checkout<br />Branch: master<br />Меню → TortoiseGit → Pull<br />Меню → TortoiseGit → Switch/Checkout<br />Branch: remotes/origin/нужнаяветка<br />[x] Create new branch: нужнаяветка<br />[x] Force<br />[x] Track<br />[x] Override branch if exists<br />Меню → TortoiseGit → *Rebase<br />Branch: нужнаяветка<br />UpStream: master<br />Ветка ветка должна быть «up to date» или заребейзится без конфликтов.<br />== Анализируем изменения просмотром лога изменений через<br />Меню → TortoiseGit → Show log<br />и смотрим изменения от master до последнего<br />== Смотрим общее изменение относительно мастера<br />Меню → TortoiseGit → Diff with previous version<br />Version 1: HEAD<br />Version 2: master<br />== если всё хорошо, делаем<br />Меню → TortoiseGit → Switch/Checkout<br />Branch: master<br />Меню → TortoiseGit → Merge<br />From: нужнаяветка<br />[x] No fast forward<br />Сообщение не редактируем.<br />Меню → TortoiseGit → Push<br />И удаляем ветки:<br />Shift + Меню → TortoiseGit → Browser Reference<br />в дереве слева Refs =&gt; heads =&gt; находим ветку, правой кнопкой, Delete branch<br />в дереве слева remotes =&gt; origin =&gt; находим ветку, правой кнопкой,<br />Delete remote branch<br /></li></ol>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; page-break-before:always;"><span style=" font-family:'DejaVu Sans'; font-size:14pt; font-weight:600;">Работа под Linux</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Подготовка к работе</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Устанавливаются системные пакеты ssh-client и git </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создаётся приватный ключ:<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">ssh-keygen -t dsa -C &quot;Ivan Petrov &lt;work@mail&gt;&quot; </span><br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Настраивается ФИО и Емейл автора:<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git config --global user.name &quot;Ivan Petrov&quot;<br />git config --global user.email work@mail&quot; </span><br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Админу отсылается файл ~/.ssh/id_dsa.pub для прописывания доступов до репозиториев и серверов.</li></ol>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Получение репозитория</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Переходим в директорию для работы, и запускаем<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">git clone ssh://git@СЕРВЕР:ПОРТ/РЕПОЗИТОРИЙ.git</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Основные используемые функции</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обновление текущей ветки из центрального репозитория:<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git pull </span><br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отправка текущей ветки в центральный репозиторий:<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git push origin branchname </span><br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Переключение на некоторую ветку:<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git checkout branchname</span><br /><br />При переключении на ветку, которой еще нет в локальном репозитории, будет создана локальная ветка, связанная с удалённой. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создание новой ветки, базирующейся на текущей<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git checkout -b branchname </span><br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Удаление веток<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git branch -d branchname == удаление локальной уже слитой ветки<br />git branch -D branchname == принудительное удаление локальной ветки<br />git push origin :branchname == удаление ветки с центрального репозитория </span><br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Слияние ветки с текущей <br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git merge --no-ff branchname </span><br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Посмотреть какие файлы изменены в текущей директории:<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git status </span><br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Просмотреть текущие изменения:<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git diff </span><br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сохранение текущих изменений:<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git add именафайлов</span> == добавить измененные/созданные файлы/директории<br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git rm именафайлов</span> == добавить удаление файла/директории<br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git commit</span> == сохранить добавленные изменения. Откроется редактор, чтобы ввести комментарий к коммиту<br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git commit -a</span> == сохранить все добавленные изменения и все измененные файлы. Позволяет сохранять все изменения, если файлы не добавлялись.</li></ol>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Стандартные процедуры работы</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">«Начало работы над задачей».<br />Выполняется перед началом работы над задачей. Дерево должно быть без изменений.<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git checkout master<br />git pull<br />git checkout -b branchname<br /></span></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">«Коммит очередного кусочка работы».<br />Выполняется после выполнения некого изменения, суть которого целостная.<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;"># проверяем, какие файлы изменились к текущему моменту<br /># удаляем если что-то попало совсем лишее<br />git status</span><br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;"># смотрим текст изменений, на предмет соответствия <br /># правилам ведения чистых коммитов. удаляем, если какой-либо мусор попал<br />git diff</span><br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;"># если какие-либо файлы не должны попасть в коммит (например,<br /># относятся к другому атомарному изменению.)<br /># то помечаем только те файлы, изменения которых нужно сохранить<br />git add …<br />git rm …</span><br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;"># сохраняем. -m можно опустить, тогда комментарий через редактор <br />git commit -m &quot;Some commit message&quot;</span><br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;"># если все на текущий момент созданные изменения нужно сохранить, то<br /># через git add добавляем новые файлы, а всё остальное сохраняем через<br />git commit -a -m &quot;Some commit message&quot; </span><br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">«Отправка ветки на центральный репозиторий»<br />Выполняется после завершения работы, либо в конце каждого дня (чтобы был бакап на сервере), либо если нужно какие-то изменения показать коллеге.<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git push origin branchname</span><br /><br />Не следует делать push после каждого коммита, так как это потребует доступа до удалённого сервера, и, соответственно, времени, потраченного впустую. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">«Ребейз относительно мастера».<br />Выполняется перед заливкой на сервер законченной задачи, когда все изменения уже закоммичены:<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git checkout master<br />git pull<br />git checkout branchname<br />git rebase master</span><br /><br />При возникновении конфликтов, нужно:<br /><br />(*)<br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git status</span> == проверить файлы, для которых есть неразрешенные конфликты.<br /><br />Редактируем первый файл с конфликтом: находим в нем «&lt;&lt;&lt;&lt;&lt;». То, что между &lt;&lt;&lt;&lt;&lt; и ==== – содержит копию текста из master ветки, то что между ===== и &gt;&gt;&gt;&gt;&gt; содержит текст из нашей ветки. Нужно на этом месте оставить одну единую версию, содержащую общий код и мастера и нашей ветки<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git add измененный_файл</span><br /><br />перейти на (*)<br /><br />После исправления конфликтов во всех файлах, запускаем<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git rebase --continue</span><br /><br />Если конфликты несовместимые с дальнейшим продолжением ребейза<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git rebase --abort</span> == прерывает ребейз и возвращает ветку в исходное<br /><br />состояние (до начала ребейза)<br /><br />После ребейза обновляем состояние ветки в центральном репозитории<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git push origin branchname -f </span><br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">«Кратковременное сохранение состояния изменений».<br />Выполняется, если требуется временно приостановить работу над текущей веткой на короткое время (например, на ревью, или чтобы сделать какую-либо двухминутную задачу).<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git stash save</span><br /><br />После этого дерево чисто, можно переключиться на другую ветку/мастер и так далее, поработать, после чего восстановить состояние с помощью<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git checkout originalbranch<br />git stash pop</span><br /><br />Тем самым восстановив состояние изменения. <br /></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">«Длительное сохранение состояния изменений».<br />Выполняется в конце рабочих суток, чтобы даже частичные изменения были забакаплены; либо при необходимости срочно переключиться на решение другой задачи, которая может занять значительно больше 5-10 минут.<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git add . <br />git commit -m &quot;Partial commit&quot;<br />git push origin branchname<br /><br /></span>Позже, для возврата к тому же состоянию как было до, выполняется<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git checkout branchname<br />git reset --soft HEAD^<br />git reset HEAD .<br /></span><br />Важно! После такой процедуры сохранения/восстановления, при следующем<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git push origin branchname</span><br /><br />Будет выдано предупреждение о непоследовательном изменении. Чтобы принудительно отправить изменения, следует добавить опцию -f.<br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git push -f origin branchname</span><br /><br /><span style=" font-weight:600;">Важно:</span> не следует добавлять -f всегда, так как это спасёт от случайных опечаток в названии ветки, например. </li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">«Ревью ветки».<br />Выполняется на чистом дереве, временно сохраните изменения согласно пункта 5, если требуется. <br /><br /><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;">git checkout master<br />git pull<br />git branch -D branchname<br />git checkout branchname<br />git rebase master == ветка обязана наложиться без конфликтов<br />git diff master == изучаем разницу от мастера или общим диффом, или <br />git log master..HEAD == смотрим какие коммиты были между мастером и текущей веткой<br /><br /></span><span style=" color:#000000;">Если всё хорошо, делаем:</span><span style=" color:#000000;"><br /></span><span style=" font-family:'Courier New'; font-size:11pt; color:#6a1009;"><br />git checkout master<br />git merge --no-ff branchname<br />git push origin master<br />git push origin :branchname<br />git branch -d branchname</span></li></ol>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p></body></html>