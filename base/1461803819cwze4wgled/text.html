<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если ваши серверные бэкапы могут вместиться в размер виртуального диска Dropbox’a, то думаю что разумным будет бэкапить файлы, помимо другого веника, ещё и в облако.<br />Начнём.<br /><a name="more-458"></a><br />Скачиваем с официального сайта дистрибутив для командной строки (в моём случаи архитектура процессора х64, для иных процессоров вот <a href="https://www.dropbox.com/install"><span style=" text-decoration: underline; color:#0000ff;">ссылка</span></a>)</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; font-weight:600; color:#6a0e07;">sudo</span><span style=" font-family:'Courier 10 Pitch'; font-weight:600; color:#6a0e07;"> </span><span style=" font-family:'Courier 10 Pitch'; font-weight:600; color:#6a0e07;">su</span></p></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier 10 Pitch'; color:#6a0e07;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; font-weight:600; color:#6a0e07;">cd</span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> ~ </span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">&amp;&amp;</span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> </span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">wget</span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> </span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">-O</span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> - </span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">&quot;https://www.dropbox.com/download?plat=lnx.x86_64&quot;</span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> </span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">|</span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> </span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">tar</span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> xzf -</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Перемещаем Dropbox из домашней папки вон:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; font-weight:600; color:#6a0e07;">mv</span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> .dropbox-dist /usr/local/lib/dropbox &amp;&amp; </span><span style=" font-family:'Courier 10 Pitch'; font-weight:600; color:#6a0e07;">chown</span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> -R root:root /usr/local/lib/dropbox</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Запускаем в первый раз Dropbox руками:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">/usr/local/lib/dropbox/dropboxd</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Видим такое:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">This client is not linked to any account...</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">Please visit https://www.dropbox.com/cli_link?host_id=2dc73ba6a3aXXXX to </span><span style=" font-family:'Courier 10 Pitch'; font-weight:600; color:#6a0e07;">link</span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> this machine.</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Открываем ссылку в браузере, вводим пароль и присоединяем сервер к нашему Dropbox-аккаунту.<br />После чего в консоли видим</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">Client successfully linked, Welcome Roman!</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ждём пока все файлы перетянутся из Dropbox’a в папку, иначе будут «бока».<br />Когда всё завершится — останавливаем процесс нажатием <span style=" font-family:'Courier New,courier';">CTRL+C</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В домашней директории создалась папка <span style=" font-family:'Courier New,courier';">~/Dropbox/</span> и подтянулись мои файлы.<br />Поскольку мне это дело в домашней папке не нужно — я переношу саму папку, за которой следит Dropbox-демон в другое место, оставляя только сим-линк (в моём случаи — <span style=" font-family:'Courier New,courier';">/var/__dropbox</span>)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">mkdir /var/__dropbox</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">mv ~/Dropbox/* Dropbox/.d* /var/__dropbox/</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">rm -Rf ~/Dropbox &amp;&amp; ln -s /var/__dropbox ~/Dropbox</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь установим Dropbox в качестве сервиса.<br />Для этого создаём файл <span style=" font-family:'Courier New,courier';">/etc/init.d/dropbox</span> с таким содержанием:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-style:italic; color:#666666;">### BEGIN INIT INFO</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-style:italic; color:#666666;"># Provides: dropbox</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-style:italic; color:#666666;"># Required-Start: $local_fs $remote_fs $network $syslog $named</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-style:italic; color:#666666;"># Required-Stop: $local_fs $remote_fs $network $syslog $named</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-style:italic; color:#666666;"># Default-Start: 2 3 4 5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-style:italic; color:#666666;"># Default-Stop: 0 1 6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-style:italic; color:#666666;"># X-Interactive: false</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-style:italic; color:#666666;"># Short-Description: dropbox service</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-style:italic; color:#666666;">### END INIT INFO </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-style:italic; color:#666666;">#!/bin/sh</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">start</span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">()</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; font-weight:600; color:#404040;">echo</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#227596;">&quot;Starting dropbox...&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#404040;">HOME</span><span style=" font-family:'monospace';">=</span><span style=" font-family:'monospace'; color:#227596;">&quot;/root/&quot;</span><span style=" font-family:'monospace';"> start-stop-daemon </span><span style=" font-family:'monospace'; color:#404040;">-b</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#404040;">-o</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#404040;">-c</span><span style=" font-family:'monospace';"> root </span><span style=" font-family:'monospace'; color:#404040;">-S</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#404040;">-u</span><span style=" font-family:'monospace';"> root </span><span style=" font-family:'monospace'; color:#404040;">-x</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000000;">/</span><span style=" font-family:'monospace';">usr</span><span style=" font-family:'monospace'; color:#000000;">/</span><span style=" font-family:'monospace';">local</span><span style=" font-family:'monospace'; color:#000000;">/</span><span style=" font-family:'monospace';">lib</span><span style=" font-family:'monospace'; color:#000000;">/</span><span style=" font-family:'monospace';">dropbox</span><span style=" font-family:'monospace'; color:#000000;">/</span><span style=" font-family:'monospace';">dropbox</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#505050;">}</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">stop</span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">()</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; font-weight:600; color:#404040;">echo</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#227596;">&quot;Stopping dropbox...&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    start-stop-daemon </span><span style=" font-family:'monospace'; color:#404040;">-o</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#404040;">-c</span><span style=" font-family:'monospace';"> root </span><span style=" font-family:'monospace'; color:#404040;">-K</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#404040;">-u</span><span style=" font-family:'monospace';"> root </span><span style=" font-family:'monospace'; color:#404040;">-x</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000000;">/</span><span style=" font-family:'monospace';">usr</span><span style=" font-family:'monospace'; color:#000000;">/</span><span style=" font-family:'monospace';">local</span><span style=" font-family:'monospace'; color:#000000;">/</span><span style=" font-family:'monospace';">lib</span><span style=" font-family:'monospace'; color:#000000;">/</span><span style=" font-family:'monospace';">dropbox</span><span style=" font-family:'monospace'; color:#000000;">/</span><span style=" font-family:'monospace';">dropbox</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#505050;">}</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">status</span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">()</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#404040;">dbpid</span><span style=" font-family:'monospace';">=$</span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">(</span><span style=" font-family:'monospace';">pgrep </span><span style=" font-family:'monospace'; color:#404040;">-u</span><span style=" font-family:'monospace';"> root dropbox</span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; font-weight:600; color:#404040;">if</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">[</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#404040;">-z</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#404040;">$dbpid</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">]</span><span style=" font-family:'monospace';"> ; </span><span style=" font-family:'monospace'; font-weight:600; color:#404040;">then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">            </span><span style=" font-family:'monospace'; font-weight:600; color:#404040;">echo</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#227596;">&quot;dropbox not running.&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; font-weight:600; color:#404040;">else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">            </span><span style=" font-family:'monospace'; font-weight:600; color:#404040;">echo</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#227596;">&quot;dropbox running.&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; font-weight:600; color:#404040;">fi</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#505050;">}</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#404040;">case</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#227596;">&quot;$1&quot;</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; font-weight:600; color:#404040;">in</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">  start</span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    start</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000000;">;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">  stop</span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    stop</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000000;">;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">  restart</span><span style=" font-family:'monospace'; color:#000000;">|</span><span style=" font-family:'monospace';">reload</span><span style=" font-family:'monospace'; color:#000000;">|</span><span style=" font-family:'monospace';">force-reload</span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    stop</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    start</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000000;">;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">  status</span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    status</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000000;">;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">  </span><span style=" font-family:'monospace'; color:#000000;">*</span><span style=" font-family:'monospace'; font-weight:600; color:#505050;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; font-weight:600; color:#404040;">echo</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#227596;">&quot;Usage: /etc/init.d/dropbox {start|stop|reload|force-reload|restart|status}&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; font-weight:600; color:#404040;">exit</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000000;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#404040;">esac</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-weight:600; color:#404040;">exit</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000000;">0</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обратите внимание, что я буду запускать Dropbox от пользователя <span style=" font-family:'Courier New,courier';">root</span>, поэтому я устанавливаю ему <span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">HOME=&quot;/root/&quot;</span> перед запуском демона, для того, чтобы демон понимал где лежат настройки.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Устанавливаем скрипту запуска правильные права</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; font-weight:600; color:#6a0e07;">chmod</span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> +x /etc/init.d/dropbox</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Добавляем в автозагрузку</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">update-rc.d dropbox defaults</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">И наконец-то запускаем:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">/etc/init.d/dropbox start</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Опционально. Есть инструмент на Питоне для отображения текущего статуса работы демона (копирование, простой и пр.)</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br />Если интересует — загружаем его и устанавливаем ему права, иначе — переходим дальше.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; font-weight:600; color:#6a0e07;">wget</span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> -O /usr/local/lib/dropbox/dropbox.py &quot;https://www.dropbox.com/download?dl=packages/dropbox.py&quot;</span></p></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier 10 Pitch'; color:#6a0e07;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; font-weight:600; color:#6a0e07;">chmod</span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> 755 /usr/local/lib/dropbox/dropbox.py</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь мы можем смотреть чем занимается демон с помощью команды</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">/usr/local/lib/dropbox/dropbox.py status</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Осталось последнее — написать скрипт, что будет копировать файлы в нашу папку прямо в облако.<br />Для этого мы будем использовать любимый <span style=" font-family:'Courier New,courier';">rsync</span>.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; font-style:italic; color:#6a0e07;">#!/bin/sh</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">HOST=$</span><span style=" font-family:'Courier 10 Pitch'; font-weight:600; color:#6a0e07;">(hostname)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">SOURCE_DIR=&quot;/var/__backup&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">DROPBOX_DIR=&quot;/var/__dropbox&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> </span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">/usr/bin/rsync -avz --delete $SOURCE_DIR $DROPBOX_DIR/$HOST/$SOURCE_DIR;</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вот. Теперь папка <span style=" font-family:'Courier New,courier';">/var/__backup</span> будет в полном объеме уезжать в облако Dropbox’a (в папку <span style=" font-family:'Courier New,courier';">/&lt;имя_сервера&gt;</span>, что удобно, когда есть более одного сервера).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ставим запуск этого скрипта каждый день, после выполнения всех бэкапов на сервере (у меня это 5 утра).</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; font-weight:600; color:#6a0e07;">vi</span><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;"> /etc/crontab</span></p></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier 10 Pitch'; color:#6a0e07;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier 10 Pitch'; color:#6a0e07;">0    5    *    *    *    root    /var/__backup/__scripts/backup_to_dropbox.sh &gt; /dev/null 2&gt;&amp;1</span></p></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:large; font-weight:600;"><br /></p></body></html>