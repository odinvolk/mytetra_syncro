<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683746"></a><span style=" font-size:xx-large; font-weight:600;">А</span><span style=" font-size:xx-large; font-weight:600;">дминистрирование Active Directory</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Active Directory® - это технология, «внутри» которой многие администраторы проводят большую часть своего времени, выполняя повседневную административную работу – добавление новых пользователей, обновление объектов директории и.т.д. С внедрением в Windows Server® 2008 R2 <span style=" color:#980004;">командлетов</span>, ориентированных на Active Directory, у администраторов появилась возможность экономить массу времени и сил, используя Windows PowerShell® для автоматизации выполнения многих повторяющихся задач, которые раньше отнимали львиную долю времени. Автоматизация также позволяет повысить безопасность и стабильность работы, так как влияние человеческого фактора, а значит, и количество ошибок сводится к минимуму. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В Windows Server 2008 R2 впервые появился модуль Active Directory для Windows PowerShell. Этот модуль установлен на всех контроллерах домена и является частью Remote Server Administration Toolkit (RSAT) для Windows® 7. Модуль содержит <span style=" color:#980004;">командлеты</span>, которые позволяют осуществлять управление Active Directory из командной строки. Также эти <span style=" color:#980004;">командлеты</span> обеспечивают поддержку технологии, которая отвечает за работу новой графической консоли Active Directory Administrative Center. Эти новые <span style=" color:#980004;">командлеты</span> взаимодействуют с веб-сервисом, который является частью Active Directory в Windows Server 2008 R2. Этот же веб-сервис можно добавить в контроллеры доменов Windows Server 2008 и Windows Server 2003, загрузив его с официального сайта Microsoft. Найти его можно здесь: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" text-decoration: underline;">http://go.microsoft.com/fwlink/?LinkId=193581 </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Нет необходимости устанавливать этот веб-сервис на все контроллеры домена. Вполне достаточно того, чтобы он был на контроллере домена того сайта, на котором находится административный центр. Точно так же, нет нужды устанавливать сами <span style=" color:#980004;">командлеты</span> на ваши контроллеры домена. <span style=" color:#980004;">Командлеты</span> нужны только на том клиентском компьютере, на котором вы хотите их использовать. </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683747"></a><span style=" font-size:large; font-weight:600;">Д</span><span style=" font-size:large; font-weight:600;">обавление модуля</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Import-Module используется для загрузки модуля Active Directory в оболочку: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Import-Module ActiveDirectory </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Remove-Module используется для удаления модуля, после завершения работы с ним. Обратите внимание, что модуль остается установленным до тех пор, пока вы либо не удалите его, либо не завершите текущую сессию работы в оболочке. Вы можете извлечь список <span style=" color:#980004;">командлетов</span>, включенных в модуль, запустив команду: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Get-Command –module activedirectory </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683748"></a><span style=" font-size:large; font-weight:600;">A</span><span style=" font-size:large; font-weight:600;">D PSDrive</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модуль Active Directory включает провайдера PSDrive. По умолчанию при <span style=" color:#980004;">импортировании</span> модуля появляется виртуальный диск под названием AD:, через который осуществляется вход в домен. Главная цель этого диска – обеспечение защиты выполняемых <span style=" color:#980004;">командлетов</span>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Каждый из <span style=" color:#980004;">командлетов</span> Active Directory позволяет вам соединиться с удаленным доменом и получить разрешение на это. В справочнике по командлетам Active Directory перечислены соответствующие параметры. Например: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">[-AuthType {Negotiate | Basic}] [-Credential &lt;PSCredential&gt;] </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Указание полномочий для каждого командлета может оказаться утомительным. Здесь на помощь приходит провайдер PSDrive. Попробуйте запустить команду help New-PSDrive, когда вы находитесь на диске С:, а затем переключитесь на диск AD: и запустите ее снова: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Cd c: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Help New-PSDrive </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Cd AD: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Help New-PSDrive </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Эти <span style=" color:#980004;">командлеты</span> меняют параметры, когда вы переключаетесь на диск AD:. Эта альтернативная версия New-PSDrive разработана специально для обеспечения доступа к другим доменам, позволяя вам использовать альтернативный мандат. Этот мандат «запоминается» на тот период времени, пока PSDrive отображается. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Когда вы запускаете командлет Active Directory, PSDrive автоматически использует мандат и домен текущего диска. Таким образом, вместо того, чтобы указывать мандат каждый раз, когда вы запускаете командлет, вы можете просто привязать диск к определенному домену, переключиться на этот диск и запустить командлет оттуда. Командлет будет автоматически использовать тот мандат, который ассоциируется с этим диском. Чтобы использовать другой набор полномочий, подключите другой диск к требуемому домену, переключитесь на этот диск и запускайте командлет. Только <span style=" color:#980004;">командлеты</span> Active Directory могут работать таким способом. Другие <span style=" color:#980004;">командлеты</span>, поддерживающие параметр –credential, не перенимают полномочия PSDrive, который подключен к домену. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если вы часто работаете с одним и тем же набором доменов, вы можете импортировать модуль Active Directory и привязывать диски к этим доменам каждый раз при запуске оболочки. Это можно сделать в профильном скрипте. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683749"></a><span style=" font-size:large; font-weight:600;">Р</span><span style=" font-size:large; font-weight:600;">анние версии Windows</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Не забывайте, что <span style=" color:#980004;">командлеты</span> Active Directory предназначены для установки только на Windows Server 2008 R2 и Windows 7. Тем не менее, вы можете пользоваться этими командлетами и на более ранних версиях Windows, при условии, что они установлены хотя бы на одном компьютере из сетевого окружения. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Предположим, вы пользуетесь компьютером с running Windows XP, на котором установлена Windows PowerShell v2. Вы можете установить на домен контроллер домена Windows Server 2008 R2 и задействовать удаленную работу Windows PowerShell. Таким образом вы сможете установить <span style=" color:#980004;">командлеты</span> Active Directory, а также контроллер домена, с которым взаимодействуют эти <span style=" color:#980004;">командлеты</span>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Далее, вы можете использовать неявный удаленный доступ с клиентского компьютера с Windows XP к командлетам, установленным на компьютере с Windows Server 2008 R2. <span style=" color:#980004;">Командлеты</span> будут вести себя так, как будто они установлены на локальном компьютере с Windows XP, но выполняться в действительности они будут на удаленном компьютере. Эта техника будет рассмотрена позже, в модуле, посвященном удаленной работе с помощью Windows PowerShell. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="OLE_LINK16"></a><span style=" font-size:x-large; font-weight:600;">У</span><span style=" font-size:x-large; font-weight:600;">правление пользователями и группами </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Управление пользователями и группами, несомненно, является одной из главных задач администратора в Active Directory. В рамках данного занятия вы узнаете, как осуществлять это управление с помощью <span style=" color:#980004;">командлетов</span>. Опять же, техники, о которых вы узнаете здесь, могут применяться к другим командлетам, которые поставляются как Microsoft, так и сторонними поставщиками. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Работа с командлетами Active Directory, по сути, сводится к тому, чтобы вычислить, какие <span style=" color:#980004;">командлеты</span> существуют и как пользоваться каждым из них. Для этого вы можете использовать команды Get-Command и Help соответственно. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы специально уделяем минимум времени изучению синтаксиса каждого из <span style=" color:#980004;">командлетов</span> Active Directory. Ключевым навыком при работе с Windows PowerShell должно стать умение самостоятельно определять имена <span style=" color:#980004;">командлетов</span> и искать их описание в справочнике. В этом и последующих модулях вы будете развивать этот навык. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Возьмите в привычку читать полное описание командлета в справочнике. Обращайте внимание на то, к каким параметрам происходит привязка конвейера по значению, а к каким – по имени свойства. Обладание этой информацией позволит вам быстрее научиться использовать короткие команды вместо длинных и сложных скриптов. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683751"></a><span style=" font-size:large; font-weight:600;">Ф</span><span style=" font-size:large; font-weight:600;">ильтрация</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">По правде говоря, запрашивание всех объектов директории одновременно – неверный подход. Поступая таким образом, вы устанавливаете непомерную нагрузку на клиентский компьютер, на сеть, и особенно, на контроллеры домена. По этой причине большинство <span style=" color:#980004;">командлетов</span> Active Directory, которые отвечают за извлечение объектов (например, <span style=" color:#980004;">командлеты</span> с глагольной частью Get в названии), имеют обязательный параметр –filter. Вы можете установить значение * для данного параметра, но в большинстве случаев вам необходимо задать более точные критерии фильтрации, чтобы извлечь лишь те объекты, которые вам действительно нужны. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Параметр –filter <span style=" color:#980004;">командлетов</span> Active Directory принимает критерии, оформленные в стиле Windows PowerShell: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Get-ADUser -Filter 'Name -like &quot;*SvcAccount&quot;' </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">Get-ADUser -Filter {Name -eq &quot;GlenJohn&quot;} </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вы можете найти и другие примеры в соответствующем разделе справочника. Большинство <span style=" color:#980004;">командлетов</span> также могут ограничить свой радиус действия определенным подкаталогом директории, который будет называться поисковой базой. Найдите в справочнике информацию о том, как задать организационную единицу или другой контейнер в качестве поисковой базы. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="_Toc211683752"></a><span style=" font-size:x-large; font-weight:600;">У</span><span style=" font-size:x-large; font-weight:600;">правление компьютерами и другими объектами AD</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Active Directory хранит намного больше информации о доменных компьютерах, чем вы можете представить. Не забывайте отправлять объекты в <span style=" color:#980004;">командлеты</span> Get-Member или Format-List *, чтобы просмотреть, что именно здесь содержится. Также помните и том, что во избежание чрезмерных нагрузок <span style=" color:#980004;">командлеты</span> Active Directory обычно по умолчанию извлекают не все свойства, содержащиеся в директории. Поэтому, вы всегда можете уточнить, какие именно атрибуты необходимо извлечь. О том, как сделать это – читайте в разделе справочника, посвященном определенному командлету. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#980004;">Командлеты</span>, рассмотренные в данном разделе, действуют во многом аналогично командлетам, рассмотренным в предыдущих разделах. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>