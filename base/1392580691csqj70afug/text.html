<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Arial'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Оглавление</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Введение в программирование модель/представление</span></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Архитектура модель/представление</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модели</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Представления</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Делегаты</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сортировка</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вспомогательные классы</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование моделей и представлений</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Две модели, включённые в состав Qt</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование представлений с существующей моделью</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Классы моделей</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Основные концепции</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модельные индексы</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Строки и столбцы</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Родители элементов</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Роли элемента</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Резюме</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование модельных индексов</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Дополнительные материалы</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Классы представлений</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Концепции</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование существующего представления</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование модели</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование множества представлений с одной моделью</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обработка выбора элементов</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Разделение выбора между представлениями</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Классы делегатов</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Концепции</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование существующих делегатов</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Простой делегат</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Предоставление редактора</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Запись данных в модель</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обновление геометрии редактора</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Редактирование подсказок</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обработка выбора элементов в представлениях</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Концепции</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Текущий элемент и выделенные элементы</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование модели выбора</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выбор элементов</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтение состояния выбора</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обновление выбора</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выбор всех элементов в модели</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создание новых моделей</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Разработка модели</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример модели только-для-чтения</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Измерения модели</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Заголовки и данные модели</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Редактируемая модель</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создание редактируемой модели</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вставка и удаление строк</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Следующие шаги</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вспомогательные классы представления элементов</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Виджеты-cписки</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Виджеты-деревья</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Виджеты-таблицы</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Общие возможности</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Скрытые элементы</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделения</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Поиск</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование перетаскивания (Drag and Drop) с представлениями элементов</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование вспомогательных представлений</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование классов модель/представление</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Разрешение применения перетаскивания к элементам</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Кодирование экспортируемых данных</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вставка отпускаемых данных в модель</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Декодирование импортируемых данных</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модели-посредники</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование моделей-посредников</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Настройка моделей-посредников</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пользовательские модели фильтрации</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пользовательские модели сортировки</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создание собственных моделей</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обработка элементов данных</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Доступ только для чтения</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Редактируемые элементы</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Изменение размеров моделей</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ленивое заполнение (Lazy Population) модели данных</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Навигация и создание индекса модели</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Родители и дети</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Поддержка перетаскивания (Drag and Drop) и обработка MIME-типов</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">MIME данные</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Получение отпускаемых данных</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вспомогательные представления</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Оптимизация производительности для больших объемов данных</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Классы модель/представление</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Связанные примеры</li></ul>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Программирование модель/представление</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Введение в программирование модель/представление</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В Qt 4 введен новый набор классов для просмотра элементов использующих архитектуру модель/представление для управления взаимосвязью между данными и методом их представления пользователю. Разделение функциональности, введенное в этой архитектуре, дает разработчикам большую гибкость в настройке отображения элементов и предоставляет стандартный интерфейс модели, позволяющий широкому диапазону источников данных использовать существующие представления элементов. В этом документе мы дадим краткое описание парадигмы модель/представление, выделим концепции и опишем архитектуру системы представления элементов. Каждый компонент данной архитектуры будет описан и будут предоставлены примеры, показывающие как использовать предоставленные классы. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Архитектура модель/представление</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Архитектура модель-представление-контроллер (Model-View-Controller, MVC) является шаблоном проектирования, берущим начало от Smalltalk, который часто используется для создания пользовательских интерфейсов. </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">В книге &quot;Design Patterns&quot; Гам</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">мы (Gamma) и других написано:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">MVC состоит из трех типов объектов. Модель - объект приложения, представление - его экранное представление и контроллер - определяет реакцию пользовательского интерфейса на пользовательский ввод. До MVC при разработке пользовательского интерфейса эти объекты смешивались вместе. MVC разделяет их, для увеличения гибкости и возможности повторного использования.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Если объединить объекты представления и контроллера, то в результате получится архитектура модель/представление. Это все еще отделяет способ хранения данных от способа их представления пользователю, но обеспечивает простую структуру, основанную на тех же принципах. Данное разделение дает возможность показать пользователю одни и те же данных в различных представлениях и реализовать новые типы представлений без изменения базовой структуры данных. Чтобы обеспечить гибкость управления пользовательским вводом, мы представляем концепцию </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">делегата</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> (delegate). Преимущество наличия делегата в этой структуре состоит в том, что это дает возможность для настройки представления и редактирования элементов данных.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image2128904289.png" style="vertical-align: top;" /><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Архитектура модель/представление</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модель осуществляет соединение с источником данных, предоставляя необходимый </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">интерфейс</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> другим компонентам архитектуры. Характер связи зависит от типа источника данных и способа реализации модели.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Из модели представление получает </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">модельные индексы</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, являющиеся ссылками на элементы данных. Передавая модельные индексы модели, представление может получить элементы данных из источника данных.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В стандартных представлениях </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">делегат</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> отображает элементы данных. Если элемент редактируемый, делегат связывается с моделью непосредственно используя модельные индексы.</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Как правило, классы модель/представление могут быть разделены на три описанные выше группы: модели, представления и делегаты. Каждый из этих компонентов описывается </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">абстрактным</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> классом, предоставляющим общий интерфейс и, в некоторых случаях, особенности реализации по умолчанию. Абстрактные классы подразумевают наследование от них в порядке, предоставляющем полный набор функциональности, ожидаемой другими компонентами; это позволяет также писать специализированные компоненты.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модели, представления и делегаты взаимодействуют друг с другом используя </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">сигналы и слоты</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сигналы от модели информируют представление об изменениях данных в источнике данных.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сигналы от представления предоставляют информацию о пользовательском взаимодействии с отображаемыми элементами.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сигналы от делегата используются во время редактирования, сообщают модели и представлению о состоянии редактора. </li></ul>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Все модели элементов основаны на классе </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Этот класс определяет интерфейс, используемый представлениями и делегатами для доступа к данным. Сами данные не должны храниться в модели; они могут храниться в структуре данных или хранилище, предоставляемом отдельным классом, файле, базе данных или каком-либо другом прикладном компоненте.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Базовые концепции моделей описаны в разделе </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">&quot;Классы моделей&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> обеспечивает достаточно гибкий интерфейс к данным для обработки представлений, которые представляют данные в виде таблиц, списков и деревьев. Однако, при реализации новых моделей в виде структур списков и таблиц, классы </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractListModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractTableModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> послужат лучшей отправной точкой, так как они предоставляют реализации соответствующих функций по умолчанию. На основе каждого из этих классов можно создать подклассы для предоставления моделей, поддерживающих специфичные виды списков и таблиц.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Процесс создания подклассов моделей обсуждается в разделе </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">&quot;Создание новых моделей&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Qt предоставляет несколько готовых моделей, которые могут использоваться для обработки элементов данных:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">QStringListModel</span> используется для хранения простого списка элементов <span style=" font-family:'Courier New'; color:#6a0e07;">QString</span>.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">QStandardItemModel</span> управляет более сложными древовидными структурами элементов, каждый из которых может содержать произвольные данные.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">QFileSystemModel</span> предоставляет информацию о файлах и директориях локальной файловой системы.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">QSqlQueryModel</span>, <span style=" font-family:'Courier New'; color:#6a0e07;">QSqlTableModel</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">QSqlRelationalTableModel</span> используются для доступа к базам данных, учитывающим соглашения архитектуры модель/представление.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Если эти стандартные модели не отвечают вашим требованиям, то для создания своих собственных моделей вы можете создать подкласс </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractListModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> или </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractTableModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Представления</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Предоставляются полные реализации для различных видов представлений: </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> отображает список элементов, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTableView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> отображает данные модели в виде таблицы, а </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTreeView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> отображает элементы модели в виде иерархического списка. Каждый из этих классов основан на базовом абстрактном классе </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Хотя эти классы и готовы к использованию, они могут иметь подклассы, для более точной настройки представления.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Доступные представления описаны в разделе &quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">Классы представлений&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Делегаты</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> - это абстрактный базовый класс делегата в структуре модель/представление. Начиная с Qt 4.4, стандартная реализация делегата предоставляемая </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QStyledItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, и используется как делегат по умолчанию стандартных представлений Qt. Однако, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QStyledItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> являются независимыми альтернативами для рисования и предоставления редакторов элементов представлений. Разница между ними состоит в том, что </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QStyledItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> использует текущий стиль для отрисовки своих элементов. По этой причине мы рекомендуем использовать </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QStyledItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> в качестве базового при реализации пользовательских делегатов или когда работают с таблицами стилей Qt.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Делегаты описаны в разделе &quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">Классы делегатов&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Сортировка</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В архитектуре модель/представление имеется два подхода к сортировке; какой подход выбрать - зависит от вашей базовой модели.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Если ваша модель сортируемая, т.е. если она переопределит функцию </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemModel::sort()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, то и </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTableView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTreeView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> предоставляют API, позволяющее программно сортировать данные вашей модели. Кроме того, вы можете разрешить интерактивную сортировку (interactive sorting) (т.е. позволить пользователям сортировать данные нажимая на заголовки представления), соединив сигнал </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QHeaderView::sortIndicatorChanged()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> со слотом </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTableView::sortByColumn()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> или же со слотом </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTreeView::sortByColumn()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">,</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> соответственно.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Альтернативный подход, если ваша модель не имеет необходимого интерфейса или вы хотите использовать представление списка для отображения ваших данных, заключается в использовании модели-посредника для преобразования структуры вашей модели перед передачей данных в представление. Детально это рассматривается в разделе &quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">Модели-посредники&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Вспомогательные классы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Множество </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">вспомогательных</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> классов унаследованы от классов стандартных представлений для удобства использования в приложениях, зависящих от основанных на элементах представлениях Qt и классах таблиц. Они не предназначены для создания на их основе подклассов, а существуют просто как эквивалент классов Qt3, работающих по старой схеме. Примерами таких классов служат </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QListWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTreeWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTableWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, реализующие поведение, подобное поведению классов Qt 3 </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QListBox</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTable</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Эти классы менее гибки, чем классы представлений и не могут использоваться с произвольными моделями. Если вы не сильно нуждаетесь в наборе основанных на элементах классов, мы рекомендуем использовать при обработке данных в представлениях элементов подход на основе модель/представление.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Если же вы хотите воспользоваться достоинствами разделения данных и представления не отказываясь от схемы явного предварительного заполнения данных, как например </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTableView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTreeView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> с моделью </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QStandardItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Использование моделей и представлений</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В следующих разделах объясняется, как использовать шаблон модель/представление в Qt. Каждый из разделов включает в себя пример и сопровождается разделом, в котором показывается как создавать новые компоненты. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Две модели, включённые в состав Qt</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Qt предоставляет две стандартные модели: </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QStandardItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QFileSystemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QStandardItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> - это многоцелевая модель, которая может использоваться для представления различных структур данных в виде списка, таблицы или дерева. Данная модель также обрабатывает элементы данных. </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QFileSystemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> - это модель, которая обрабатывает информацию о содержимом директории. Как результат, она не содержит самих элементов данных, а просто представляет файлы и директории локальной файловой системы.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QFileSystemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> предоставляет готовую к использованию и подходящую для экспериментов модель, которая легко настраивается для работы с существующими данными. На примере этой модели, мы можем показать, как настраивать модель для использования с готовыми представлениями и как управлять данными с помощью модельных индексов. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Использование представлений с существующей моделью</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Классы </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTreeView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> являются наиболее подходящими для использования с </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QFileSystemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Нижеприведенный пример отображает содержимое директории в виде дерева и его же в виде списка. Представления разделяют пользовательский выбор элементов, так что они подсвечиваются в обоих представлениях.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1802460797.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Мы подготавливаем к использованию </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QFileSystemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и создаем представления для отображения содержимого директории. Здесь показан самый простой способ использования модели. Создание и использование модели выполняются в единственной функции </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">main()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> int main(int argc, char *argv[])</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     QApplication app(argc, argv);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     QSplitter *splitter = new QSplitter;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     QFileSystemModel *model = new QFileSystemModel;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     model-&gt;setRootPath(QDir::currentPath());</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модель настроена для использования данных из определенной файловой системы. Вызов </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a1009;">setRootPath()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> сообщает модели какой диск в файловой системе делать видимым для представлений.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Мы создаем два представления для отображения двумя различными способами элементов, предоставляемых моделью:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     QTreeView *tree = new QTreeView(splitter);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     tree-&gt;setModel(model);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     tree-&gt;setRootIndex(model-&gt;index(QDir::currentPath()));</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     QListView *list = new QListView(splitter);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     list-&gt;setModel(model);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     list-&gt;setRootIndex(model-&gt;index(QDir::currentPath()));</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Представления создаются также, как и другие виджеты. Настройка представления для отображения элементов модели производится просто вызовом функции </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">setModel()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> с моделью директории, переданной в качестве аргумента. Мы фильтруем предоставляемые моделью данные вызывая функцию </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">setRootIndex()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> на каждом представлении, передавая соответствующий </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">модельный индекс</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> из файловой системы для текущего каталога.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Функция </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">index()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, используемая в этом случае, является уникальной для </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QFileSystemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">; мы передаем ей каталог и она возвращает модельный индекс. Модельные индексы обсуждаются в &quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">Классы моделей&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Оставшаяся часть функции лишь отображает представления на виджете и запускает цикл обработки событий приложения:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     splitter-&gt;setWindowTitle(&quot;Two views onto the same file system model&quot;);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     splitter-&gt;show();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     return app.exec();</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В вышеприведенном примере мы не упомянули обработку выбора элементов пользователем. Эта тема более подробно раскрыта в разделе &quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">Обработка выбора в представлении элементов&quot;.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Классы моделей</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">До ознакомления с обработкой выбора, вам будет полезно изучить концепции, используемые в структуре модель/представление. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Основные концепции</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В архитектуре модель/представление, модель предоставляет стандартный интерфейс, используемый представлениями и делегатами для доступа к данным. В Qt, стандартный интерфейс определен с помощью класса </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Независимо от того, как элементы данных хранятся в структуре данных, все подклассы </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> представляют данные в виде иерархической структуры, содержащей таблицы элементов. Представления используют это </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">соглашение</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для доступа к элементам данных модели, но они не ограничены в способах предоставления информации пользователю.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image2122637629.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">С помощью механизма сигналов и слотов, модели уведомляют связанные представления об изменениях в данных.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Данный раздел описывает некоторые концепции, являющиеся важнейшими для получения другими компонентами доступа к элементам данных через класс модели. Более продвинутые концепции обсуждаются в следующих разделах. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Модельные индексы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для того, чтобы гарантировать, что представления данных отделены от способа доступа к ним, введено понятие </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">модельного индекса</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Каждая часть информации, которая может быть получена через модель, представлена модельным индексом. Представления и делегаты используют эти индексы для запроса отображаемых данных.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В результате, только модели требуется знать, как хранятся данные, а тип данных, управляемых моделью, может быть определен довольно приблизительно. Модельные индексы содержат указатель на модель, которая их создала, что предотвращает беспорядок при работе с более, чем одной моделью.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> QAbstractItemModel *model = index.model();</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модельные индексы предоставляют </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">временные</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> ссылки на части информации и могут использоваться для получения или изменения данных посредством модели. В связи с тем, что модели могут время от времени реорганизовывать свою структуру, модельные индексы могут стать недействительными и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">не должны храниться</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Если требуется долгоживущая ссылка на часть данных, должен быть создан </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">постоянный модельный индекс</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Он предоставляет ссылку на данные, которая поддерживается моделью актуальной. Временные модельные индексы предоставляются классом </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, а постоянные модельные индексы предоставляются классом </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QPersistentModelIndex</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для получения модельного индекса, соответствующего элементу данных, у модели должны быть заданы три свойства: номер строки, номер столбца и модельный индекс родительского элемента. Следующий раздел детально описывает и поясняет эти свойства. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Строки и столбцы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Основной формой представления модели является таблица, в которой элемент задается номерами строки и столбца. </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">Это не означает, что основные части информации хранятся в виде массива</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">; использование номеров строк и столбцов является лишь соглашением, позволяющим элементам взаимодействовать друг с другом. Мы можем получить информацию о любом элементе, указав модели номер строки и столбца и получив индекс, представляющий элемент:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> QModelIndex index = model-&gt;index(row, column, ...);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модели, предоставляющие интерфейсы к простым одноуровневым структурам данных, таким как списки и таблицы, не нуждаются в другой информации помимо номеров строк и столбцов, но, поскольку вышеупомянутый код требует этого, мы должны сообщить несколько больше данных для получения модельного индекса.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image887768905.png" style="vertical-align: top;" /><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Строки и столбцы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Диаграмма показывает представление основной табличной модели, в которой каждый элемент определяется парой номеров - строки и столбца. Мы получаем модельный индекс, который ссылается на элемент данных, передавая соответствующие номера строки и столбца в модель.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> QModelIndex indexA = model-&gt;index(0, 0, QModelIndex());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> QModelIndex indexB = model-&gt;index(1, 1, QModelIndex());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> QModelIndex indexC = model-&gt;index(2, 1, QModelIndex());</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Элементы верхнего уровня модели всегда имеют в качестве родителя специфический </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">QModelIndex()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Он будет описан в следующем разделе.</span></p></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Родители элементов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Таблицеподобный интерфейс к элементам данных, предоставляемый моделью, идеален при использовании данных в представлениях в виде таблицы или списка; система номеров строк и столбцов точно указывает способ отображения представлениями элементов. Однако, структуры, подобные представлению дерева, требуют более гибкого интерфейса к элементам. В результате, каждый элемент также может быть родителем другой таблицы элементов, почти также, как элемент верхнего уровня в представлении дерева может вмещать в себя список других элементов.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">При запросе индекса элемента модели, мы должны предоставить некоторую информацию о родительском элементе. Единственным способом обращения к элементу вне модели является модельный индекс, так что модельный индекс родителя также должен быть известен:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> QModelIndex index = model-&gt;index(row, column, parent);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image884613323.png" style="vertical-align: top;" /><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Родители, строки и столбцы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Диаграмма показывает представление модели дерева, в которой каждый элемент определяется родителем, номером строки и номером столбца.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Элементы &quot;A&quot; и &quot;C&quot; представлены как верхнеуровневые элементы модели:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> QModelIndex indexA = model-&gt;index(0, 0, QModelIndex());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> QModelIndex indexC = model-&gt;index(2, 1, QModelIndex());</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Элемент &quot;A&quot; имеет множество дочерних объектов. Модельный индекс элемента &quot;B&quot; может быть получен с помощью следующего кода:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> QModelIndex indexB = model-&gt;index(1, 0, indexA);</span></p></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Роли элемента</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Элементы модели могут выполнять различные </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">роли</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для других компонентов, позволяя в различных ситуациях получать различные виды данных. Например, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">Qt::DisplayRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> используется для доступа к строке, которая может отображаться в представлении как текст. Как правило, элементы содержат информацию для нескольких различных ролей, а стандартные роли определяются с помощью </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">Qt::ItemDataRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Мы можем запросить у модели информацию об элементе, передав ей модельный индекс, соответствующий элементу и задав роль для получения данных желаемого типа:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> QVariant value = model-&gt;data(index, role);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image820011336.png" style="vertical-align: top;" /><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Роли элемента</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Роль указывает модели, данные какого типа будут переданы. Представления могут отображать роли различными способами, поэтому важно обеспечить информацию, соответствующую каждой роли.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Раздел &quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">Создание новых моделей&quot; </span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">более подробно описывает несколько необычное использование ролей.</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Наиболее частые способы использования элементов данных описываются стандартными ролями, определенными в </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">Qt::ItemDataRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Снабжая элемент данных информацией для каждой роли, модель может предоставить предпочтения для отображения элемента пользователю представлениями и делегатами. Различные виды представлений имеют возможность интерпретировать эти данные или игнорировать эту информацию, если требуется. Также имеется возможность определять дополнительные, специфические для приложения, роли. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Резюме</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модельные индексы дают представлениям и делегатам информацию о размещении элементов, предоставляемых моделью, и независимую от структуры данных.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элементы определяются номерами строк и столбцов и модельным индексом их родительских элементов.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модельные индексы создаются моделями по требованию других компонентов, таких как представления и делегаты.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если при вызове функции <span style=" font-family:'Courier New'; color:#6a0e07;">index()</span> в качестве родительского элемента передается действительный модельный индекс, то возвращаемый индекс ссылается на элемент, находящийся ниже в иерархии модели, чем родитель. Полученный индекс ссылается на дочерний элемент этого индекса.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если в качестве родительского элемента функции <span style=" font-family:'Courier New'; color:#6a0e07;">index() </span>передается недействительный модельный индекс, то возвращаемый индекс ссылается на элемент верхнего уровня.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Роль</span> различается для различных видов данных, связанных с элементом. </li></ul>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Использование модельных индексов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Чтобы продемонстрировать, как данные могут быть получены из модели с помощью модельных индексов, мы создаем </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QFileSystemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> без представления и отображаем в виджете имена файлов и директорий. Хотя этот пример и не показывает нормального способа использования модели, он демонстрирует соглашения, используемые моделями при работе с модельными индексами.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Мы создаем модель файловой системы следующим способом:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     QFileSystemModel *model = new QFileSystemModel;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     QModelIndex parentIndex = model-&gt;index(QDir::currentPath());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     int numRows = model-&gt;rowCount(parentIndex);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В этом случае, мы создаем </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QFileSystemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> по умолчанию, получив родительский индекс с помощью специфической реализации </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">index()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, предоставляемой этой моделью, а с помощью функции </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">rowCount()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> мы получаем количество строк в модели.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для простоты, мы интересовались лишь элементами первого столбца модели. Мы рассмотрим каждую строку по очереди, получая модельный индекс для первого элемента каждой строки, и читаем данные, хранящиеся в модели для этого элемента.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     for (int row = 0; row &lt; numRows; ++row) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">         QModelIndex index = model-&gt;index(row, 0, parentIndex);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для получения модельного индекса мы задаем номер строки, номер столбца (ноль для первого столбца) и модельный индекс, соответствующий родителю всех элементов, которые мы хотим получить. Текст, хранящийся в каждом элементе, может быть получен с помощью функции модели </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">data()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Мы задаем модельный индекс и </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">DisplayRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, чтобы получить информацию об элементе в виде строки.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">         QString text = model-&gt;data(index, Qt::DisplayRole).toString();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">         // Отображение текста в виджете.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Вышеприведенный пример демонстрирует основные принципы, используемые для восстановления данных из модели:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Измерения модели могут быть получены с помощью <span style=" font-family:'Courier New'; color:#6a0e07;">rowCount()</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">columnCount()</span>. Эти функции обычно требуют, чтобы был определен родительский модельный индекс.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модельные индексы используются для доступа к элементам модели. Для задания элемента требуются номер строки, номер столбца и модельный индекс родительского элемента.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для доступа к элементам модели верхнего уровня, в качестве модельного индекса родительского элемента, с помощью <span style=" font-family:'Courier New,courier';">QModelIndex()</span>, задается нулевой модельный индекс.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элементы содержат данные для различных ролей. Для получения данных определенной роли, модели должны быть сообщены модельный индекс и роль. </li></ul>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Дополнительные материалы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Новые модели могут быть созданы с помощью реализации стандартного интерфейса, предоставляемого </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Мы продемонстрируем это в разделе &quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">Создание новых моделей&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, создав удобную готовую к использованию модель для хранения списка строк. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Классы представлений</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Концепции</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В архитектуре модель/представление, представление получает элементы данных от модели и предоставляет их пользователю. Способ, которым данные предоставляются пользователю, не обязан походить на структуру данных, предоставляемую моделью, и может быть </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">полностью отличным</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> от основной структуры данных, хранящей элементы данных.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Разделение содержимого и представления достигается с помощью использования стандартного модельного интерфейса, предоставляемого </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, стандартного интерфейса представления, предоставляемого </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, и использования модельных индексов, единообразно представляющих элементы данных. Представления обычно управляют размещением данных, полученных от модели. Они могут отображать отдельные элементы непосредственно или использовать </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">делегаты</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для реализации особенностей отображения и редактирования.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Наряду с отображением элементов, представления управляют навигацией между элементами и некоторыми аспектами выбора элемента. Представления также реализуют основные возможности пользовательского интерфейса, такие как контекстные меню и перетаскивание. Представление может предоставить средства обслуживания редактирования элементов или могут работать с </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">делегатом</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, предоставляющим собственный редактор.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Представление может быть создано без модели, но модель должна быть предоставлена прежде, чем оно сможет отобразить полезную информацию. Представления отслеживают выбор элементов пользователем с помощью </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">выбора</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, который может быть реализован отдельно для различных представлений или быть общим для различных представлений.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Некоторые представления, такие как </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTableView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTreeView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, отображают заголовки также как элементы. Заголовки также реализованы с помощью класса представления </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QHeaderView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Заголовки обычно обращаются к той же модели, что и содержащее их представление. Они получают данные от модели с помощью функции </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemModel::headerData()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и обычно отображают информацию заголовков в виде надписей. Для получения экзотических заголовков, можно создать подклассы </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QHeaderView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Использование существующего представления</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Qt предоставляет три готовых к использованию класса представлений, которые отображают информацию в виде, привычном большинству пользователей. </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> может отображать элементы модели в виде простого списка или в виде классического представления пиктограмм. </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTreeView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> отображает элементы данных модели в виде иерархии списков, позволяющей компактно представить глубоко вложенные структуры. </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTableView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> представляет элементы модели в виде таблицы, очень сильно похожей на приложение электронной таблицы.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1522275024.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Реализация поведения по умолчанию для вышеприведенных представлений, достаточна для большинства приложений. Они предоставляют основные средства редактирования и могут быть настроены для более специфических пользовательских интерфейсов. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Использование модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Возьмем модель списка строк, которую </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">мы создали </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic; color:#000000;">в качестве примера</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, настроим ее на некоторые данные и создадим представление для отображения содержимого модели. Все это может быть сделано в рамках одной функции:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> int main(int argc, char *argv[])</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     QApplication app(argc, argv);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> // Убраны отступы для облегчения цитирования:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> QStringList numbers;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> numbers &lt;&lt; &quot;One&quot; &lt;&lt; &quot;Two&quot; &lt;&lt; &quot;Three&quot; &lt;&lt; &quot;Four&quot; &lt;&lt; &quot;Five&quot;;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> QAbstractItemModel *model = new StringListModel(numbers);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Обратите внимание на то, что мы объявили </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">StringListModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> как </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Это позволяет нам использовать абстрактный интерфейс модели и гарантирует, что этот код будет работать даже в том случае, если мы заменим модель списка на другую модель.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Представление списка, предоставляемое </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, вполне достаточно для отображения элементов модели списка строк. Мы создаем представление и устанавливаем его на модель с помощью следующих строк кода:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> QListView *view = new QListView;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> view-&gt;setModel(model);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Представление отображается обычным способом:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     view-&gt;show();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     return app.exec();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Представление отображает содержимое модели, получая данные через интерфейс модели. При попытке пользователя редактировать элемент, представление использует делегата по умолчанию для предоставления виджета редактора.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image359479505.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Рисунок выше демонстрирует, как </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> представляет данные модели списка строк. Так как модель редактируемая, представление автоматически, используя делегата по умолчанию, позволяет быть отредактированным каждому элементу. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Использование множества представлений с одной моделью</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Отображение одной модели во множестве представлений - просто вопрос установки одной и той же модели для каждого представления. В следующем коде мы создаем два представления-таблицы, каждое из которых использует простую модель, которую мы создали в этом примере:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     QTableView *firstTableView = new QTableView;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     QTableView *secondTableView = new QTableView;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     firstTableView-&gt;setModel(model);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     secondTableView-&gt;setModel(model);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Использование сигналов и слотов в архитектуре модель/представление означает, что об изменении данных в модели может быть сообщено всем связанным с ней представлениям, гарантируя при этом доступ к одним и тем же данным независимо от используемого представления.</span></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image637389306.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">На рисунке выше показаны два различных представления одной модели, каждое из которых содержит множество выделенных элементов. Несмотря на то, что данные в представлениях синхронизированы, каждое представление содержит свою внутреннюю модель выбора. В некоторых ситуациях это может быть полезно, но для большинства приложений желательна общая модель выбора. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Обработка выбора элементов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Механизм обработки выбора элементов в представлении предоставляется классом </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QItemSelectionModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Все стандартные представления создают свои собственные модели выбора по умолчанию и взаимодействуют с ними стандартным образом. Модель выбора, используемая представлением, может быть получена с помощью функции </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">selectionModel()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, а заменить модель выбора можно с помощью функции </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">setSelectionModel()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Возможность управлять моделью выбора, используемой представлением, полезна, если вы хотите предоставить множество представлений для одних и тех же данных модели.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Вообще, если вы создаете подкласс модели или представления, вам не требуется управлять содержимым модели выбора напрямую. Однако если требуется, можно получить доступ к интерфейсу модели выбора, что обсуждается в &quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">Обработке выбора в представлениях элементов&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Разделение выбора между представлениями</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Хотя предоставление представлением своей собственной модели выбора по умолчанию и удобно, но при использовании нескольких представлений с одной моделью часто желательно, чтобы и данные модели и выбор пользователя были показаны одинаково во всех представлениях. Так как классы представлений позволяют заменять свои внутренние модели выбора, мы можем добиться единообразного отображения выбора в разных представлениях с помощью следующего кода:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     secondTableView-&gt;setSelectionModel(firstTableView-&gt;selectionModel());</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Второму представлению устанавливают модель выбора первого представления. Теперь оба представления работают с одной моделью выбора, синхронно показывая и данные, и выбранные элементы.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1529402774.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В вышеприведенном примере для отображения данных одной модели использовались два представления одинакового типа. Однако, если используются два различных представления, то выбранные элементы могут быть представлены в каждом представлении по-разному; например, выбор смежных элементов в представлении таблицы, в представлении дерева может быть отображен как фрагментированный набор выделенных элементов. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Классы делегатов</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Концепции</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В отличие от шаблона модель-представление-контроллер (MVC), архитектура модель/представление не включает в себя полностью независимые компоненты для управления взаимодействием с пользователем. Как правило, представление отвечает за представление пользователю данных модели и за обработку пользовательского ввода. Чтобы придать немного гибкости способу, которым этот ввод получается, взаимодействие осуществляется с помощью делегатов (delegates). Эти компоненты предоставляют возможности ввода, а также отвечают за отрисовку индивидуальных элементов в некоторых представлениях. Стандартный интерфейс управления делегатами определен в классе </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Ожидается, что делегаты способны самостоятельно отрисовывать свое содержимое, реализовав функции </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">paint()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">sizeHint()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Однако, простые, основанные на виджетах, делегаты могут быть созданы как подкласс </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> вместо </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QAbstractItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, и получить преимущества реализации этих функций по умолчанию.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Редакторы для делегатов могут быть реализованы либо с использованием виджетов для управления процессом редактирования либо непосредственной обработкой событий. Первый подход раскрывается в этом разделе, а также показан в примере</span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> &quot;Spin Box Delegate&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Пример </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">Pixelator</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> показывает как создавать пользовательский делегат, выполняющий специализированный рендеринг для представления таблицы. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Использование существующих делегатов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Стандартные представления, поставляемые вместе с Qt, используют экземпляры класса </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для предоставления средств редактирования. Эта реализация по умолчанию интерфейса делегата отображает элементы в обычном стиле для каждого из стандартных представлений: </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTableView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QTreeView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Стандартные представления используют делегат по умолчанию, обрабатывающий все стандартные роли. Способ их интерпретации описывается в документации к </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Функция </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">itemDelegate()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> возвращает делегат, используемый представлением. Функция </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">setItemDelegate()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> позволяет вам установить пользовательский делегат для стандартного представления и важно использовать эту функцию когда устанавливается делегат для пользовательского представления. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Простой делегат</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Реализованный здесь делегат использует </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QSpinBox</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для предоставления средств редактирования и предназначен в основном для использования с моделями, которые отображают целые числа. Хотя для этой цели мы установили пользовательскую модель таблицы, основанную на целых числах, мы легко можем использовать вместо нее </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QStandardItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, так как вводом данных управляет пользовательский делегат. Мы создадим представление таблицы для отображения содержимого модели и оно будет использовать пользовательский делегат для редактирования.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1961342312.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Мы создаем подкласс делегата от </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> поскольку мы не хотим писать функции пользовательского вывода на экран. Однако, мы все же должны предоставить функции для управления виджетом-редактором:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> class SpinBoxDelegate : public QItemDelegate</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     Q_OBJECT</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> public:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     SpinBoxDelegate(QObject *parent = 0);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     QWidget *createEditor(QWidget *parent, const QStyleOptionViewItem &amp;option,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">                           const QModelIndex &amp;index) const;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     void setEditorData(QWidget *editor, const QModelIndex &amp;index) const;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     void setModelData(QWidget *editor, QAbstractItemModel *model,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">                       const QModelIndex &amp;index) const;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     void updateEditorGeometry(QWidget *editor,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">         const QStyleOptionViewItem &amp;option, const QModelIndex &amp;index) const;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> };</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Обратите внимание, что при создании делегата виджеты-редакторы не создаются. Мы создаем виджет-редактор только когда это необходимо. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Предоставление редактора</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В этом примере, когда представление таблицы нуждается в редакторе, оно просит делегат предоставить виджет-редактор, соответствующий модифицируемому элементу. Функцию</span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> createEditor() </span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">снабжаем всем, что необходимо делегату для установки соответствующего виджета:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> QWidget *SpinBoxDelegate::createEditor(QWidget *parent,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     const QStyleOptionViewItem &amp;/* option */,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     const QModelIndex &amp;/* index */) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     QSpinBox *editor = new QSpinBox(parent);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     editor-&gt;setMinimum(0);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     editor-&gt;setMaximum(100);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     return editor;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Обратите внимание, что мы не нуждаемся в хранении указателя на виджет-редактор, так как представление берет на себя ответственность за его уничтожение когда он станет не нужен.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Мы установили стандартный фильтр событий делегата на редактор для гарантирования того, что он предоставит ожидаемые пользователями стандартные &quot;горячие&quot; клавиши редактирования. Чтобы сделать возможным более сложное поведение в редактор могут быть добавлены дополнительные &quot;горячие&quot; клавиши; это обсуждается в разделе &quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">Редактирование подсказок&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Представление убеждается в правильности установки данных редактора и геометрии с помощью вызова функций, которые для этих целей мы определим позднее. Мы можем создать различные редакторы, зависящие от предоставляемого представлением модельного индекса. Например, если у нас есть столбец целых чисел и столбец строк мы можем вернуть либо </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">QSpinBox</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> либо </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">QLineEdit</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, в зависимости от того, какой столбец редактируется.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Делегат должен предоставить функцию копирования данных модели в редактор. В этом примере мы читаем данные, хранящиеся в </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">роли отображения </span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">(display role), и соответственно устанавливаем значение в окошке счетчика.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> void SpinBoxDelegate::setEditorData(QWidget *editor,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">                                     const QModelIndex &amp;index) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     int value = index.model()-&gt;data(index, Qt::EditRole).toInt();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     QSpinBox *spinBox = static_cast&lt;QSpinBox*&gt;(editor);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     spinBox-&gt;setValue(value);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В этом примере мы знаем, что виджет-редактор это окошко счетчика, но мы можем предоставлять различные редакторы для разных типов данных в модели, в этом случае мы должны привести виджет к соответствующему типу до обращения к его функциям-членам. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Запись данных в модель</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Когда пользователь завершает редактирования значения в окошке счетчика, представление просит делегата сохранить отредактированное значение в модели, вызвав функцию </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">setModelData()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> void SpinBoxDelegate::setModelData(QWidget *editor, QAbstractItemModel *model,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">                                    const QModelIndex &amp;index) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     QSpinBox *spinBox = static_cast&lt;QSpinBox*&gt;(editor);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     spinBox-&gt;interpretText();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     int value = spinBox-&gt;value();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; font-size:10pt; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">     model-&gt;setData(index, value, Qt::EditRole);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;"> }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Так как представление управляет виджетами-редакторами делегата, мы должны только обновить модель с предоставленным редактором содержимым. В данном случае мы удостоверяемся в том, что окошко счетчика обновилось и обновляем содержащую значение модель, используя заданный индекс.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Стандартный класс </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">QItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> сообщает представлению когда он завершил редактирование испуская сигнал </span><span style=" font-family:'Courier New'; font-size:10pt; color:#6a0e07;">closeEditor()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Представление проверяет, что виджет-редактор закрыт и уничтожен. В этом примере мы предоставили только простые средства редактирования, поэтому нам никогда не понадобится испускать этот сигнал.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Все операции над данными выполняются через интерфейс, предоставляемый </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Это делает делегата в значительной степени независимым от типа данных, с которыми он манипулирует, но должны быть сделаны некоторые допущения в порядке использования определенных типов виджетов-редакторов. В этом примере мы предполагали, что модель всегда содержит целые числа, но мы можем использовать этот делегат с другими видами моделей, поскольку </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> предоставляет удобные значения по умолчанию для непредвиденных данных. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Обновление геометрии редактора</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">За управление геометрией редактора отвечает делегат. Геометрия должна быть установлена при создании редактора, при изменении размеров или положения элемента в представлении. К счастью, представление предоставляет всю необходимую информацию о геометрии внутри объекта </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">опция представления</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> (view option).</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> void SpinBoxDelegate::updateEditorGeometry(</span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QWidget</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *editor,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QStyleOptionViewItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;option, const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;/* index */) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     editor-&gt;setGeometry(option.rect);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В данном случае мы используем только информацию, предоставляемую опцией представления в прямоугольнике элемента. Делегат, который отображает элементы с несколькими примитивами, не использует прямоугольник элемента непосредственно. Он поместит редактор в зависимости от других примитивов в элементе. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Редактирование подсказок</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">После редактирования делегаты должны предоставить другим компонентам подсказки о результате процесса редактирования и предоставить подсказки, которые будут помогать любым последующим операциям редактирования. Достигается это испусканием сигнала </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, который мы установили на окошко счетчика при его создании.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Поведение окошка счетчика можно настраивать, чтобы сделать его более дружественным. В фильтре событий по умолчанию, предоставляемом </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QItemDelegate</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, если пользователь нажмет </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Return</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для подтверждения своего выбора в окошке счетчика, делегат фиксирует значение в модели и закрывает окошко счетчика. Мы можем изменить это поведение, установив на окошко счетчика свой собственный фильтр событий и предоставив подсказки редактирования, соответствующие нашим нуждам; например, мы можем испустить </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">closeEditor()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> с подсказкой </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">EditNextItem</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для автоматического начала редактирования следующего элемента в представлении.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Другим подходом, не требующим использования фильтра событий, является предоставление нашего собственного виджета-редактора, возможно унаследованный для удобства от </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QSpinBox</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Альтернативным подходом будет передать нам больше контроля над поведением виджета-редактора за счет написания дополнительного кода. В большинстве случаев более удобно установить фильтр событий в делегате, если вам необходимо настраивать поведение стандартного виджета-редактора Qt.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Делегаты не испускают эти подсказки, но тогда они будут слабее интегрированы в приложения и будут менее удобны, чем те, что испускают подсказки для поддержки общепринятых действий редактирования. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Обработка выбора элементов в представлениях</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Концепции</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В модели выбора, предлагаемой в классах представления элементов, предоставляется множество усовершенствований по сравнению с моделью выбора Qt 3. Она предоставляет более качественное описание выбора, основанное на возможностях архитектуры модель/представление. Несмотря на то, что стандартные классы для управления выбором в представлениях элементов вполне функциональны, для удовлетворения требований ваших моделей и представлений вы можете создавать свои собственные модели выбора.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Информация о выбранных элементах представления хранится в экземпляре класса </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QItemSelectionModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Этот класс содержит свои собственные модельные индексы элементов независимо от представления. В связи с тем, что возможно использование нескольких представлений с одной моделью, можно разделить одну модель выбора между несколькими представлениями, позволив тем самым приложению отобразить одни и те же данные различными способами.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Выбор состоит из </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">выбранных диапазонов</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Эти диапазоны компактно хранят информацию о множестве выбранных элементов, запоминая только начальный и конечный модельные индексы для каждого диапазона выбранных элементов. Для описания выбора несмежных элементов используется более одного диапазона выделения.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Выбор применяется к набору модельных индексов, хранящихся в модели выбора. Последний выбор элементов известен как </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">текущее выделение</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Свойства этого набора могут быть изменены с помощью некоторых команд управления выбора. Они обсуждаются позже в этом разделе. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Текущий элемент и выделенные элементы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В представлении всегда имеется текущий элемент и выделенный элемент - два независимых состояния. Элемент может быть текущим элементом и выделенным элементом одновременно. Представление отвечает за обеспечение того, чтобы всегда имелся текущий элемент поскольку для перемещения с помощью клавиатуры, например, требуется текущий элемент.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Таблица ниже подчеркивает разницу между текущим элементом и выделенными элементами.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0"><thead>
<tr>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Текущий элемент</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Выбранные элементы</span></p></td></tr></thead>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Может быть только один текущий элемент.</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Может быть много выбранных элементов.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Текущий элемент изменяется при перемещении с помощью клавиатуры или щелчков кнопок мыши.</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Состояние выделения элементов устанавливается или снимается, зависящий от нескольких предопределенных режимов - например, выделения единственного элемента, множественного выделения, и т.д. - когда пользователь взаимодействует с элементами.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Текущий элемент будет редактироваться, если нажата клавиша редактирования, </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">F2</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, или по элементу дважды щелкнули мышью (в том случае, если редактирование разрешено).</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Текущий элемент может быть использован вместе с указателем определяющим диапазон, который будет выбранным или невыбранным (или сочетанием этих двух).</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Текущий элемент обозначается прямоугольником фокуса ввода.</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Выбранные элементы обозначаются с помощью прямоугольника выделения.</span></p></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">При манипулировании выбором, часто полезно думать о </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QItemSelectionModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> как о наборе состояний выбора всех элементов в модели. Как только модель выбора установлена, наборы элементов могут быть выбраны, их выбор может быть отменен или изменен без необходимости знать, какие конкретно элементы выбраны. Индексы всех выбранных элементов могут быть получены в любое время, а с помощью механизма сигналов и слотов другие компоненты могут быть оповещены об изменениях в модели выбора. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Использование модели выбора</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Стандартные классы представлений по умолчанию предоставляют модели выбора, которые могут использоваться в большинстве приложений. Модель выбора, принадлежащая одному представлению, может быть получена с помощью функции представления </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">selectionModel()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и разделена между несколькими представлениями с помощью функции </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">setSelectionModel()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, так что создание новых моделей выбора вообще не требуется.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Выбор создают задавая модель и пару модельных индексов в </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QItemSelection</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Он использует индексы для ссылки на элементы данной модели и интерпретируются как левый верхний и правый нижний элементы в блоке выбранных элементов. Для того, чтобы выбор повлиял на модель выбора, его следует применить к ней; это может быть сделано различными способами, и каждый из них будет иметь различное влияние на уже выбранные элементы модели. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Выбор элементов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для демонстрации некоторых основных возможностей выбора, мы создаем экземпляр пользовательской модели таблицы, содержащей всего 32 элемента, и для его данных устанавливаем табличное представление:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     TableModel *model = new TableModel(8, 4, &amp;app);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTableView</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *table = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTableView</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(0);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     table-&gt;setModel(model);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelectionModel</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *selectionModel = table-&gt;selectionModel();</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для дальнейшего использования получаем модель выбора табличного представления по умолчанию. Мы не изменяем в модели никаких элементов, но вместо этого выбираем несколько элементов, которые представление покажет в левом верхнем углу таблицы. Чтобы сделать это, мы должны получить модельные индексы левого верхнего и правого нижнего элементов блока, который должен быть выбран:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> topLeft;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> bottomRight;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     topLeft = model-&gt;index(0, 0, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">());</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     bottomRight = model-&gt;index(5, 2, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">());</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Чтобы сделать эти элементы в модели выбранными и увидеть соответствующие изменения в табличном представлении, мы должны создать объект выбора и применить его к модели выбора:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelection</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> selection(topLeft, bottomRight);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     selectionModel-&gt;select(selection, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelectionModel</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::Select);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Выбор применяется к модели выбора с помощью команды, заданной комбинацией </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">флагов выбора</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. В данном случае, используемые флаги указывают, что объект выбора должен быть представлен в модели независимо от предыдущего состояния выбора. Результирующий выбор отображается представлением.</span></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1285486692.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Выбор элементов может быть изменен с помощью различных операций, определяемых флагами выбора. Выбор, образующийся в результате этих действий, может иметь сложную структуру, но будет эффективно представлен моделью выбора. Использование различных флагов для изменения выбора элементов будет показано при описании обновления выбора. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Чтение состояния выбора</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модельные индексы, хранящиеся в модели выбора, могут быть прочитаны с помощью функции </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">selectedIndexes()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Она возвращает несортированный список модельных индексов, который мы можем перебирать не задумываясь о том, к какой модели они относятся:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndexList</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> indexes = selectionModel-&gt;selectedIndexes();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> index;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     foreach(index, indexes) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QString</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> text = </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QString</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(&quot;(%1,%2)&quot;).arg(index.row()).arg(index.column());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         model-&gt;setData(index, text);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В вышеприведенном коде Qt для перебора индексов, возвращаемых моделью выбора, и изменения соответствующих им элементов используется удобная </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">конструкция foreach</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модель выбора испускает сигналы, сообщающие об изменениях в выборе. Они уведомляют другие компоненты как об изменениях модели выбора в целом, так и об изменениях элемента модели, имеющего в данным момент фокус. Мы можем соединить сигнал </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QItemSelection</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">: один содержит список индексов, соответствующих выбранным элементам; другой содержит список индексов, соответствующих элементам, выбор которых был отменен.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В следующем коде мы предоставим слот, который получает сигнал </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">selectionChanged()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, заполняет строку выделенными элементами и очищает содержимое элементов, выбор которых отменен.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> void MainWindow::updateSelection(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelection</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;selected,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelection</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;deselected)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> index;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndexList</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> items = selected.indexes();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     foreach (index, items) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QString</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> text = </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QString</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(&quot;(%1,%2)&quot;).arg(index.row()).arg(index.column());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         model-&gt;setData(index, text);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     items = deselected.indexes();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     foreach (index, items)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         model-&gt;setData(index, &quot;&quot;);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Мы можем отследить изменение фокуса элементов внутри модели, соединив сигнал </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">currentChanged()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> со слотом, вызываемым с двумя модельными индексами. Эти индексы соответствуют элементу, имевшему фокус раньше, и элементу, имеющему фокус в данный момент.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В следующем коде мы предоставляем слот, получающий сигнал </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QMainWindow</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> void MainWindow::changeCurrent(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;current,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;previous)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     statusBar()-&gt;showMessage(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         tr(&quot;Moved from (%1,%2) to (%3,%4)&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">             .arg(previous.row()).arg(previous.column())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">             .arg(current.row()).arg(current.column()));</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">С помощью этих сигналов контролируется выбор, сделанный пользователем, но мы можем изменять модель выбора непосредственно. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Обновление выбора</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Команды выбора специфицируются комбинацией флагов выбора, определенной как </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QItemSelectionModel::SelectionFlag</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Каждый из флагов выбора указывает модели выбора, как изменять внутренний набор уже выбранных элементов при каждом вызове функции </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">select()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Наиболее часто используется флаг </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Select</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, который указывает модели выбора запомнить выбранные элементы именно так, как они были выбраны. Флаг </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Toggle</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> указывает модели выбора инвертировать состояние выбора всех указанных элементов, т.е. невыбранные элементы сделать выбранными, а выбранные сделать невыбранными. Флаг </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Deselect</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> делает все указанные элементы невыбранными.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Отдельные элементы модели выбора обновляются с помощью создания выбора элементов и применения его к модели выбора. В следующем коде мы применяем второй выбор элементов к показанной выше табличной модели, используя команду </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Toggle</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для инвертирования состояния выбора указанных элементов.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelection</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> toggleSelection;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     topLeft = model-&gt;index(2, 1, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     bottomRight = model-&gt;index(7, 3, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     toggleSelection.select(topLeft, bottomRight);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     selectionModel-&gt;select(toggleSelection, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelectionModel</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::Toggle);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Результат этого действия показан в табличном представлении, обеспечивающем хорошую визуализацию наших достижений:</span></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1822595597.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">По умолчанию команды выбора работают только с элементами заданными модельными индексами. Однако флаг, используемый для описания команды выбора, может использоваться совместно с дополнительными флагами для изменения строк и столбцов. Например, если вы вызываете </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">select()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> только с одним индексом, но с командой, которая является комбинацией флагов </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Select</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Rows</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, то будет выбрана строка, содержащая элемент, на который ссылается модельный индекс. Следующий код показывает использование флагов </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Rows</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Columns</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelection</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> columnSelection;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     topLeft = model-&gt;index(0, 1, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     bottomRight = model-&gt;index(0, 2, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">());</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     columnSelection.select(topLeft, bottomRight);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     selectionModel-&gt;select(columnSelection,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelectionModel</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::Select | </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelectionModel</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::Columns);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelection</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> rowSelection;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     topLeft = model-&gt;index(0, 0, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     bottomRight = model-&gt;index(1, 0, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">());</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     rowSelection.select(topLeft, bottomRight);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     selectionModel-&gt;select(rowSelection,</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelectionModel</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::Select | </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelectionModel</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::Rows);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Несмотря на то, что модели выбора передано только четыре индекса, использование флагов выбора </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Columns</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Rows</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> приводит к тому, что выбираются два столбца и две строки. На следующем рисунке показан результат этого действия:</span></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1260867166.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Команды, выполнявшиеся на нашей демонстрационной модели, привели к большому количеству выбранных элементов в ней. Возможно отменить выбор всех элементов, или полностью заменить текущий выбор элементов на новый.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для замены текущего выбора новым, комбинируйте флаги выбора с флагом </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Current</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Команда, использующая этот флаг, указывает, что модель выбора должна заменить свой текущий набор модельных индексов на тот, что указан при вызове </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">select()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Для удаления прежнего выбора прежде, чем вы сделаете новый, используйте другие флаги выбора совместно с флагом </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Clear</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Это приведет к переустановке набора модельных индексов модели выбора. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Выбор всех элементов в модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для выбора всех элементов модели, необходимо создать выбор для каждого из уровней модели, охватывающий все элементы этого уровня. Мы делаем это, восстанавливая индексы соответствующие левому верхнему и правому нижнему элементам заданного родительского индекса:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> topLeft = model-&gt;index(0, 0, parent);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> bottomRight = model-&gt;index(model-&gt;rowCount(parent)-1,</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         model-&gt;columnCount(parent)-1, parent);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Выбор создается с этими индексами и моделью. При этом будут выбраны соответствующие элементы модели выбора:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelection</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> selection(topLeft, bottomRight);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     selectionModel-&gt;select(selection, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QItemSelectionModel</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::Select);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Это должно быть сделано для всех уровней модели. Родительский индекс для элементов верхнего уровня мы определяем обычным образом:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> parent = </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">();</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В иерархических моделях для определения, является ли заданный элемент родительским для элементов более низкого уровня используется функция </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">hasChildren()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Создание новых моделей</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Разделение функциональных возможностей между компонентами архитектуры модель/представление позволяет создавать новые модели, способные использовать преимущества существующих представлений. Такой подход позволяет представлять данные из разнообразных источников, используя стандартные графические компоненты пользовательского интерфейса, такие как </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QTableView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QTreeView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Класс </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> предоставляет интерфейс, который достаточно гибок для поддержки источников данных, хранящих информацию в иерархических структурах, позволяющих вставлять, удалять и изменять данные, или сортировать их различными способами. А также предоставляет поддержку операций перетаскивания (drag and drop).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Классы </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractListModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractTableModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> предоставляют поддержку интерфейсов для более простых неиерархических структур данных, и более легки для использования в качестве отправной точки для простых моделей списков и таблиц.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В этом разделе мы создадим простую модель только-для-чтения для исследования основных принципов архитектуры модель/представление. Позже в этом разделе, мы приспособим эту модель для того, чтобы данные могли быть изменены пользователем.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для получения примера более сложной модели, смотрите пример </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Простая модель дерева</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Минимальные требования, которым должны удовлетворять подклассы </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, описаны в документе </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Создание собственных моделей</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Разработка модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">При создании новой модели для существующей структуры данных очень важно решить, какой тип модели лучше всего подходит для обеспечения интерфейса к данным. Если структура данных может быть определена как список или таблица элементов, вы можете создать подкласс </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractListModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> или </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractTableModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, так как эти классы предоставляют подходящие реализации функций по умолчанию.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Однако, если базовая структура данных может быть представлена только в виде иерархической древовидной структуры, возникает необходимость в создании подкласса </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Такой подход показан в примере </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Простая модель дерева</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В этом разделе мы реализуем простую модель, основанную на списке строк, для создания которой идеальной основой является класс </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractListModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Безотносительно формы, которую принимает основная структура данных, хорошим тоном в специализированных моделях является добавление стандартного API </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> к тому, который предоставляет более естественный доступ к структуре данных. Это облегчает заполнение модели данными, но кроме того позволяет другим компонентам архитектуры модель/представление взаимодействовать с моделью, используя стандартный API. Нижеприведенная модель предоставляет пользовательский конструктор исключительно с этой целью. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Пример модели только-для-чтения</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Реализованная здесь модель - это простая неиерархическая модель только-для-чтения, основанная на стандартном классе </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QStringListModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Она имеет </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QStringList</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> в качестве внутреннего хранилища данных и реализует лишь самое необходимое для функционирования модели. Для облегчения реализации, мы создаем подкласс </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractListModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> так как он определяет удобное поведение по умолчанию для моделей списков и предоставляет более простой интерфейс, чем класс </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">При реализации модели следует помнить, что </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> не хранит данных, он лишь предоставляет интерфейс, используемый представлениями для доступа к данным. Для минимальной модели только-для-чтения, необходимы реализации лишь нескольких функций, которые предоставлены по умолчанию для большинства интерфейсов. Декларация класса следующая:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> class StringListModel : public </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QAbstractListModel</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     Q_OBJECT</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> public:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     StringListModel(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QStringList</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;strings, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QObject</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *parent = 0)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         : </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QAbstractListModel</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(parent), stringList(strings) {}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     int rowCount(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;parent = </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">()) const;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> data(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;index, int role) const;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> headerData(int section, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::Orientation orientation,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">                         int role = </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::DisplayRole) const;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> private:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QStringList</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> stringList;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> };</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Кроме конструктора модели, мы должны реализовать только две функции: </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">rowCount()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, возвращающую количество строк в модели, и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">data()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, возвращающую элемент данных, соответствующий определенному модельному индексу.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Хорошо работающие модели также реализуют </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">headerData()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для получения представлениями деревьев и таблиц чего-либо для отображения в их заголовках.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Обратите внимание на то, что это неиерархическая модель, поэтому мы не должны беспокоиться о родительско-дочерних отношениях. Если наша модель иерархическая, мы также должны реализовать функции </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">index()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">parent()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Список строк хранится в закрытой переменной-члене </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">stringList</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Измерения модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Мы хотим, чтобы количество строк в модели было таким же, что и количество элементов в списке строк. Помня об этом, мы реализуем функцию </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">rowCount()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> int StringListModel::rowCount(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;parent) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     return stringList.count();</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Так как модель неиерархическая, мы можем спокойно игнорировать модельный индекс, соответствующий родительскому элементу. По умолчанию, модели, производные от </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractListModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, содержат только один столбец, поэтому нам не нужно переопределять функцию </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">columnCount()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Заголовки и данные модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В качестве элементов в представлении мы хотим возвратить строки из списка строк. Функция </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">data()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> ответственна за возвращение элемента данных, соответствующего аргументу-индексу:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> StringListModel::data(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;index, int role) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (!index.isValid())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (index.row() &gt;= stringList.size())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (role == </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::DisplayRole)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return stringList.at(index.row());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">();</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Если переданный модельный индекс валиден, номер строки находится в пределах диапазона значений списка строк и требуемая роль нами поддерживается, мы возвращаем валидный </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Некоторые представления, такие как </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QTreeView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QTableView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, могут отображать заголовки наряду с элементами данных. Если наша модель отображается в представлении с заголовками, мы хотим, чтобы заголовки содержали номера строк и столбцов. Мы можем предоставить информацию о заголовках реализовав функцию </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">headerData()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> StringListModel::headerData(int section, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::Orientation orientation,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">                                      int role) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (role != </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::DisplayRole)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (orientation == </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::Horizontal)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QString</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(&quot;Column %1&quot;).arg(section);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QString</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(&quot;Row %1&quot;).arg(section);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">И снова мы возвращаем валидный </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> только в том случае, если роль поддерживается. При решении, что должно быть возвращено, также принимается во внимание ориентация заголовка.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Не все представления отображают заголовки с элементами данных, и они могут быть настроены для сокрытия заголовков. Тем не менее, рекомендуется реализовывать функцию </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">headerData()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для предоставления важной информации о данных, предоставляемых моделью.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Элемент может иметь несколько ролей, предоставляя различные данные в зависимости от указанной роли. Элементы нашей модели имеют только одну роль, </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">DisplayRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, так что мы возвращаем данные элемента независимо от указанной роли. Однако, данные, предоставляемые для роли </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">DisplayRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, мы может повторно использовать в других ролях, таких как </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">ToolTipRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, которую представления могут использовать для отображения информации об элементе во всплывающей подсказке. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Редактируемая модель</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модель только-для-чтения показывает, насколько просто данные могут быть предоставлены пользователю, но для многих приложений гораздо полезней редактируемая модель списка. Мы можем модифицировать модель только-для-чтения и сделать элементы редактируемыми изменив функцию data(), реализованную только для чтения, и реализовав две дополнительных функции: </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">flags()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">setData()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Добавляем декларации следующих функций в определение класса:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::ItemFlags flags(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;index) const;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     bool setData(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;index, const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;value,</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">                  int role = </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::EditRole); </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Создание редактируемой модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Перед созданием редактора, делегат проверяет, является ли элемент редактируемым. Модель должна дать знать делегату, являются ли ее элементы редактируемыми. Мы делаем это, возвращая флаги для каждого элемента модели; в нашем случае, мы делаем доступными все элементы и позволяем им быть выбранными и редактируемыми:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::ItemFlags StringListModel::flags(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;index) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (!index.isValid())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::ItemIsEnabled;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     return </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::flags(index) | </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::ItemIsEditable;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Обратите внимание на то, что нам нет надобности знать, как делегат осуществляет процесс редактирования. Мы лишь должны предоставить делегату способ занести данные в модель. Это достигается с помощью функции </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">setData()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> bool StringListModel::setData(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;index,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">                               const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;value, int role)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (index.isValid() &amp;&amp; role == </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::EditRole) {</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         stringList.replace(index.row(), value.toString());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         emit dataChanged(index, index);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return true;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     return false;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В этой модели, элемент списка строк, соответствующий модельному индексу, заменяется на предоставленное значение. Однако, прежде, чем мы изменим список строк, мы должны убедиться, что индекс валиден, элемент имеет корректный тип, а роль поддерживается. В соответствии с соглашениями, мы утверждаем, что роль - это </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">EditRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, так как эта роль обычно используется стандартными делегатами представлений. Однако для булевых значений вы можете использовать </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::CheckStateRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и установить флаг </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::ItemIsUserCheckable</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">; тогда флажок будет использоваться для редактирования значения. Основные данные нашей модели одинаковы для всех ролей, это облегчает объединение модели со стандартными компонентами.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">После того, как данные установлены, модель должна дать знать представлениям, что некоторые данные изменены. Модель делает это, испуская сигнал </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">dataChanged()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Так как у нас изменился только один элемент данных, указанный в сигнале диапазон элементов данных ограничен одним модельным индексом.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Также функцию data() нужно изменить, чтобы добавить проверку </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::EditRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> StringListModel::data(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;index, int role) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (!index.isValid())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (index.row() &gt;= stringList.size())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (role == </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::DisplayRole || role == </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::EditRole)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return stringList.at(index.row());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QVariant</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">();</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> } </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Вставка и удаление строк</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В модели можно менять количество строк и столбцов. В модели списка строк имеет смысл изменять только количество строк, поэтому мы должны переопределить только функции для вставки и удалении строк. Они объявлены в определении класса:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     bool insertRows(int position, int rows, const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;index = </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">());</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     bool removeRows(int position, int rows, const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;index = </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">());</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Так как строки модели соответствуют строкам списка, то функция </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">insertRows()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> вставляет нужное количество пустых строк в список перед указанной позицией. Количество вставляемых строк эквивалентно указанному количеству строк.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для определения, куда должны быть вставлены строки, обычно используется родительский индекс. В нашем случае, мы имеем один список строк верхнего уровня, поэтому мы вставляем пустые строки в этот список.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> bool StringListModel::insertRows(int position, int rows, const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;parent)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     beginInsertRows(</span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(), position, position+rows-1);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     for (int row = 0; row &lt; rows; ++row) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         stringList.insert(position, &quot;&quot;);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     endInsertRows();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     return true;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Сперва, для уведомления других компонентов о том, что количество строк собирается измениться, модель вызывает функцию </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">beginInsertRows()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Функция определяет номера первой и последней строк, которые должны быть вставлены, а также модельный индекс их родительского элемента. После изменения списка строк, модель вызывает </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">endInsertRows()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для завершения операции и уведомления других компонентов о том, что изменились измерения модели, для сообщения о том, что действия выполнены успешно, возвращается true.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Функция для удаления строк из моделей также проста в написании. Строки, удаляемые из модели, задаются позицией и количеством. Для упрощения реализации, мы игнорируем родительский индекс и лишь удаляем строки из списка.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> bool StringListModel::removeRows(int position, int rows, const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;parent)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     beginRemoveRows(</span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(), position, position+rows-1);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     for (int row = 0; row &lt; rows; ++row) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         stringList.removeAt(position);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     endRemoveRows();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     return true;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Перед удалением данных всегда вызывается функция </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">beginRemoveRows()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, которая определяет номера первой и последней удаляемых строк. Это позволяет другим компонентам получить доступ к данным, прежде чем они станут недоступны. Для завершения операции и уведомления других компонентов о том, что измерения модели изменились, после удаления строк модель испускает сигнал </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">endRemoveRows()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Следующие шаги</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Мы можем отобразить данные, предоставленные моделью, используя класс </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, который показывает элементы модели в виде вертикального списка. Для модели списка строк, это представление также предоставляет редактор по умолчанию, способный управлять элементами. Возможности, предоставляемые стандартными классами представлений, мы исследуем в </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Классах представлений</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В документе </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> классам обсуждаются более подробно и предоставляется руководство по виртуальным функциям, которые должны быть реализованы для активирования различных возможностей в разных типах моделей. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Вспомогательные классы представления элементов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Qt 4 также вводит стандартные виджеты, реализующие классические основанные на элементах контейнеры. Они ведут себя подобно классам представлений элементов Qt 3, но переписаны с целью производительности и удобства сопровождения для использования с базовым каркасом модель/представление. Старые классы представлений элементов всё ещё доступны в библиотеке совместимости (дополнительную информацию смотрите в </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Руководстве по переносу кода</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Основанные на элементах виджеты имеют имена, отражающие их назначение: </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">QListWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> предоставляет список элементов, </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">QTreeWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> отображает многоуровневую древовидную структуру, а </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">QTableWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> предоставляет таблицу с ячейками. Каждый из этих классов наследует поведение класса </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">QAbstractItemView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, который реализует общее поведение выбора элементов и управления заголовками. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Виджеты-cписки</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Одноуровневые списки элементов обычно отображаются с помощью </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">QListWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и множества </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">QListWidgetItem</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Виджет-список создается тем же образом, что и любой другой виджет:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     QListWidget *listWidget = new QListWidget(this);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Элементы списка могут быть добавлены в виджет-список непосредственно при создании:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QListWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(tr(&quot;Sycamore&quot;), listWidget);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QListWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(tr(&quot;Chestnut&quot;), listWidget);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QListWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(tr(&quot;Mahogany&quot;), listWidget);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Также они могут быть созданы без родительского виджета-списка и добавлены в список позже:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QListWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *newItem = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QListWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     newItem-&gt;setText(itemText);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     listWidget-&gt;insertItem(row, newItem);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Каждый элемент списка может отображать текст и пиктограмму. При настройке внешнего вида элемента можно изменить цвет и шрифт, используемые для отрисовки текста. Всплывающие подсказки, текст панели состояния и подсказки &quot;What's This?&quot; легко настраиваются для того, чтобы гарантировать, что список органично впишется в приложение.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     newItem-&gt;setToolTip(toolTipText);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     newItem-&gt;setStatusTip(toolTipText);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     newItem-&gt;setWhatsThis(whatsThisText);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">По умолчанию элементы списка отображаются в порядке их добавления в список. Списки элементов могут быть отсортированы по алфавиту или в обратном порядке в соответствии с критерием, указанным в </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::SortOrder</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     listWidget-&gt;sortItems(</span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::AscendingOrder);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     listWidget-&gt;sortItems(</span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::DescendingOrder); </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Виджеты-деревья</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Деревья или иерархические списки элементов предоставляются с помощью классов </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">QTreeWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">QTreeWidgetItem</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Каждый элемент виджета-дерева может иметь свои собственные дочерние элементы и отображать данные в нескольких столбцах. Виджеты-деревья создаются точно также, как и другие виджеты:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     QTreeWidget *treeWidget = new QTreeWidget(this);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Прежде, чем добавлять элементы в виджет-дерево, должно быть установлено количество столбцов. Например, мы можем определить два столбца и создать текстовые метки для отображения заголовков наверху каждого столбца:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     treeWidget-&gt;setColumnCount(2);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QStringList</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> headers;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     headers &lt;&lt; tr(&quot;Subject&quot;) &lt;&lt; tr(&quot;Default&quot;);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     treeWidget-&gt;setHeaderLabels(headers);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Самый легкий способ настроить надписи для каждой секции состоит в создании списка строк. Для более сложных заголовков вы можете создать элемент дерева, оформить его и использовать в качестве заголовка виджета-дерева.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Элементы верхнего уровня виджета-дерева создаются с виджетом-деревом в качестве родителя. Они могут быть вставлены в произвольном порядке, или вы можете определить порядок, указав при создании элемента предшествующий элемент:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTreeWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *cities = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTreeWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(treeWidget);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     cities-&gt;setText(0, tr(&quot;Cities&quot;));</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTreeWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *osloItem = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTreeWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(cities);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     osloItem-&gt;setText(0, tr(&quot;Oslo&quot;));</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     osloItem-&gt;setText(1, tr(&quot;Yes&quot;));</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTreeWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *planets = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTreeWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(treeWidget, cities);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Виджеты-деревья с элементами верхнего уровня обращаются несколько иначе, чем с элементами, находящимися в глубине иерархии. Элементы верхнего уровня могут быть удалены из дерева с помощью вызова функции виджета-дерева </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">takeTopLevelItem()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, а элементы более низких уровней удаляются с помощью вызова функции </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">takeChild()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> их родительского элемента. На верхний уровень древовидной структуры элементы могут быть вставлены с помощью функции </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">insertTopLevelItem()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. На более низких уровнях используется функция </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">insertChild()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> родительского элемента.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Элементы легко перемещаются между самым верхним и более низкими уровнями дерева. Нам требуется лишь проверить, являются ли эти элементы элементами верхнего уровня или нет. Эту информацию можно получить с помощью функции </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">parent()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> элемента. Например, мы можем удалить текущий элемент виджета-дерева вне зависимости от его расположения:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTreeWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *parent = currentItem-&gt;parent();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     int index;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (parent) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         index = parent-&gt;indexOfChild(treeWidget-&gt;currentItem());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         delete parent-&gt;takeChild(index);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     } else {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         index = treeWidget-&gt;indexOfTopLevelItem(treeWidget-&gt;currentItem());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         delete treeWidget-&gt;takeTopLevelItem(index);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Вставка элемента куда-нибудь в виджет-дерево осуществляется подобным образом:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTreeWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *parent = currentItem-&gt;parent();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTreeWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *newItem;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (parent)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         newItem = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTreeWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(parent, treeWidget-&gt;currentItem());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     else</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         newItem = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTreeWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(treeWidget, treeWidget-&gt;currentItem()); </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Виджеты-таблицы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Таблицы элементов, подобные тем которые предоставляются табличными редакторами, создаются с помощью </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">QTableWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">QTableWidgetItem</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Они предоставляют прокручиваемую таблицу с заголовками и элементами в ней.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Таблицы могут создаваться сразу с нужным количеством строк и столбцов, или строки и столбцы могут добавляться по необходимости.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTableWidget</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *tableWidget;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     tableWidget = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTableWidget</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(12, 3, this);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Элементы создаются вне таблицы, а затем размещаются в нужном месте:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTableWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *newItem = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTableWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(tr(&quot;%1&quot;).arg(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         pow(row, column+1)));</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     tableWidget-&gt;setItem(row, column, newItem);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Горизонтальные и вертикальные заголовки можно добавить в таблицу, создав их как элементы вне таблицы, а затем установив их в качестве заголовков:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTableWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *valuesHeaderItem = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTableWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(tr(&quot;Values&quot;));</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     tableWidget-&gt;setHorizontalHeaderItem(0, valuesHeaderItem);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Обратите внимание на то, что нумерация строк и столбцов в таблице начинается с нуля. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Общие возможности</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">У всех вспомогательных основанных на элементах классов есть множество общих возможностей, которые доступны через один и тот же интерфейс. Мы представим их с примерами для разных виджетов в следующих разделах. Подробнее об использовании каждой из возможностей для каждого конкретного виджета смотрите </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Классы модель/представление</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Скрытые элементы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Иногда в виджете представления элементов полезно скрывать элементы, вместо того чтобы удалять их. Элементы всех виджетов могут быть скрыты, а потом вновь показаны. Определить, скрыт ли элемент, можно с помощью функции isItemHidden(), а скрыть элементы с помощью функции </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">setItemHidden()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Так как эта операция воздействует на элементы, она доступна во всех трех вспомогательных классах представлений. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Выделения</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Способ, которым выделяются элементы, управляется режимом выделения виджета (</span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemView::SelectionMode</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">). Данное свойство указывает, может ли пользователь выбирать один или несколько элементов, и, если пользователь может выбирать несколько, должен ли это быть непрерывный диапазон. Режим выбора работает одинаково для всех виджетов.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1132233828.png" style="vertical-align: top;" /><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Выделение единственного элемента:</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> Если пользователю нужно выбрать единственный элемент виджета, то режим по умолчанию - </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">SingleSelection</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> - наиболее подходящий. В этом режиме текущий элемент и выделенный элемент совпадают.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image2113450808.png" style="vertical-align: top;" /><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Выделение нескольких элементов:</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> В этом режиме, пользователь может изменять состояние выделения любого элемента в виджете без изменения существующего выделения, подобно тому как независимо друг от друга можно переключать флажки (checkboxes).</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image441284582.png" style="vertical-align: top;" /><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Расширенное выделение:</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> Виджетам, которым часто требуется выбирать множество смежных элементов, например, электронные таблицы, требуется режим </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">ExtendedSelection</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. В этом режиме непрерывные диапазоны элементов могут быть выделены с помощью мыши или клавиатуры. Сложные выделения, включающие множество несмежных друг-другу элементов, могут быть сделаны с помощью клавиш-модификаторов.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Если пользователь выделяет элемент без использования клавиш-модификаторов, существующее выделение очищается.</span></p></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Выбранные в виджете элементы можно прочитать с помощью функции </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">selectedItems()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, возвращающей список соответствующих элементов, по которому можно перемещаться. Например, с помощью следующего кода мы можем найти сумму всех числовых значений выделенных элементов:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QList</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">&lt;</span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTableWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *&gt; selected = tableWidget-&gt;selectedItems();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTableWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *item;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     int number = 0;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     double total = 0;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     foreach (item, selected) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         bool ok;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         double value = item-&gt;text().toDouble(&amp;ok);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         if (ok &amp;&amp; !item-&gt;text().isEmpty()) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">             total += value;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">             number++;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         }</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Заметьте, что в режиме выделения единственного элемента, текущий элемент будет находиться в выделении. В режимах выделения нескольких элементов и расширенного выделения текущий элемент может не находиться в выделении, это зависит от способа, которым пользователь осуществляет выделение. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Поиск</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Часто бывает полезно иметь возможность найти элементы внутри представления или для разработчика, или в качестве возможности, предоставляемой пользователю. Все три вспомогательных класса представления элементов предоставляют такую возможность с помощью функции </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">findItems()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Элементы ищутся по тексту, который они содержат, в соответствии с критериями, заданными набором значений </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::MatchFlags</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. С помощью функции </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">findItems()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> можно получить список соответствующих элементов:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTreeWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *item;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QList</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">&lt;</span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QTreeWidgetItem</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *&gt; found = treeWidget-&gt;findItems(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         itemText, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::MatchWildcard);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     foreach (item, found) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         treeWidget-&gt;setItemSelected(item, true);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         // Показать для каждого элемента item-&gt;text(0).</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Вышеприведенный код выделяет элементы виджета-дерева, если их текст содержит заданную строку поиска. Этот пример можно использовать также в виджетах-списках и виджетах-таблицах. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Использование перетаскивания (Drag and Drop) с представлениями элементов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Архитектура модель/представление полностью поддерживает инфраструктуру перетаскивания (drag and drop) Qt. Элементы списков, таблиц и деревьев можно перетаскивать внутри представлений, а их данные могут быть импортированы и экспортированы в виде закодированной в MIME информации.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Стандартные представления автоматически поддерживают внутреннюю операцию перетаскивания, когда элементы перемещаются внутри области отображения для изменения порядка их отображения. По умолчанию операция перетаскивания для этих представлений не разрешена, так как они созданы для простого, наиболее общего применения. Для того, чтобы элементы могли перетаскиваться, должны быть включены некоторые свойства представления, а самим элементам должно быть позволено перетаскиваться.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">К модели, которая позволяет только экспортировать данные из представления, предъявляются более скромные требования, чем к модели, которая позволяет перетаскивать информацию в себя и требующей полной доступности операций перетаскивания.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Смотрите также </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Создание собственных моделей</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для более подробной информации о поддержке перетаскивания в новых моделях. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Использование вспомогательных представлений</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Каждый тип элементов, используемых в </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QListWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QTableWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QTreeWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, настроен для использования разных наборов флагов по умолчанию. Например, каждый объект </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QListWidgetItem</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> или </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QTreeWidgetItem</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> изначально доступен, переключаем, выбираем и может использоваться как источник для операции перетаскивания; каждый объект </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QTableWidgetItem</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> также может быть редактируемым и использоваться как приемник операции перетаскивания.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Несмотря на то, что все стандартные элементы имеют один или оба установленных флага поддержки перетаскивания, вам, как правило, требуется установить различные свойства самого представления для того, чтобы воспользоваться возможностями встроенной поддержки операций перетаскивания:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для разрешения перетаскивания элементов, установите свойство представления <span style=" color:#6a0e07;">dragEnabled</span> в значение <span style=" font-family:'Courier New,courier';">true</span>.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы разрешить пользователю отпускать внутренние и внешние элементы внутри представления, установите свойство <span style=" color:#6a0e07;">viewport()</span> представления <span style=" color:#6a0e07;">acceptDrops</span> в значение <span style=" font-family:'Courier New,courier';">true</span>.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы показывать пользователю, куда будет помещен при отпускании перетаскиваемый в настоящий момент элемент, установите свойство представления <span style=" color:#6a0e07;">showDropIndicator</span>. Это позволит предоставлять пользователю непрерывно обновляемую информацию о размещении элемента внутри представления.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Например, с помощью следующих строк кода можно включить использование операции перетаскивания в виджете-списке:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QListWidget</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *listWidget = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QListWidget</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(this);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> listWidget-&gt;setSelectionMode(</span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QAbstractItemView</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::SingleSelection);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> listWidget-&gt;setDragEnabled(true);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> listWidget-&gt;viewport()-&gt;setAcceptDrops(true);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> listWidget-&gt;setDropIndicatorShown(true);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В результате виджет-список позволит элементам быть скопированным в пределах области отображения и даже быть перемещенными в виджеты, содержащие данные такого же типа. В обоих случаях, элементы будут скорее скопированы, чем перемещены.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Чтобы разрешить пользователю свободно перемещать элементы внутри представления нужно установить </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">dragDropMode</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> виджета-списка:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> listWidget-&gt;setDragDropMode(</span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QAbstractItemView</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::InternalMove); </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Использование классов модель/представление</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Настройка представления для использования операции перетаскивания происходит тем же образом, что и настройка традиционных представлений. Например, </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> может быть настроен точно также, как и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QListWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *listView = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(this);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> listView-&gt;setSelectionMode(</span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QAbstractItemView</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::ExtendedSelection);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> listView-&gt;setDragEnabled(true);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> listView-&gt;setAcceptDrops(true);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> listView-&gt;setDropIndicatorShown(true);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Так как доступ к отображаемым представлением данным управляется моделью, используемая модель также должна предоставлять поддержку операций перетаскивания. Действия, поддерживаемые моделью, можно задать переопределив функцию </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel::supportedDropActions</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">(). Например, с помощью следующего кода можно сделать доступными операции копирования и перемещения:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::DropActions DragDropListModel::supportedDropActions() const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     return </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::CopyAction | </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::MoveAction;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модели можно передать любую комбинацию значений </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::DropActions</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, но их поддержку моделью необходимо прописать. Например, для использования </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::MoveAction</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> должным образом моделью списка, модель должна иметь реализацию </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel::removeRows</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">() или непосредственно, или унаследовав ее от базового класса. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Разрешение применения перетаскивания к элементам</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Указать представлению, какие элементы можно перетаскивать, а на какие можно отпустить, модели могут с помощью переопределения функции </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel::flags</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">(), предоставляющей соответствующие флаги.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Например, модель, предоставляющая простой список, основанный на </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractListModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, может позволить использование операции перетаскивания для каждого элемента, гарантируя, что возвращаемые флаги содержат значения </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::ItemIsDragEnabled</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и Qt::</span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::ItemIsDropEnabled</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::ItemFlags DragDropListModel::flags(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;index) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::ItemFlags defaultFlags = </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QStringListModel</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::flags(index);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (index.isValid())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::ItemIsDragEnabled | </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::ItemIsDropEnabled | defaultFlags;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::ItemIsDropEnabled | defaultFlags;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Обратите внимание на то, что отпускание позволяется только на верхнем уровне модели, а перетаскивание позволяется только для действительных элементов.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Так как модель унаследована от </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QStringListModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, то в вышеприведенном коде мы получили набор флагов по умолчанию вызвав ее реализацию функции flags(). </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Кодирование экспортируемых данных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">При экспортировании элементов данных из модели в операцию перетаскивания, они кодируются в формат, соответствующий одному или нескольким типам MIME. Модели декларируют типы MIME, которые они могут применять по отношению к элементам, с помощью переопределения функции </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel::mimeTypes</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">(), возвращающей список стандартных типов MIME.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Например, модель, которая предоставляет лишь простой текст, должна иметь следующую реализацию данной функции:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QStringList</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> DragDropListModel::mimeTypes() const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QStringList</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> types;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     types &lt;&lt; &quot;application/vnd.text.list&quot;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     return types;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Также модель должна иметь код, конвертирующий данные в соответствующий формат. Это достигается с помощью переопределенной функции </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QMimeData</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, такой же, как и в любой другой операции перетаскивания.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Следующий код показывает, как каждый элемент данных, соответствующий списку индексов, может быть закодирован в виде простого текста и помещен в объект </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QMimeData</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QMimeData</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *DragDropListModel::mimeData(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndexList</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;indexes) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QMimeData</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *mimeData = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QMimeData</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QByteArray</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> encodedData;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QDataStream</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> stream(&amp;encodedData, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QIODevice</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::WriteOnly);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     foreach (const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;index, indexes) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         if (index.isValid()) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">             </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QString</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> text = data(index, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::DisplayRole).toString();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">             stream &lt;&lt; text;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     mimeData-&gt;setData(&quot;application/vnd.text.list&quot;, encodedData);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     return mimeData;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Так как функции передается список модельных индексов, этот подход достаточно универсален для использования в иерархических и неиерархических моделях.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Обратите внимание на то, что пользовательские типы данных должны объявляться как </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">мета-объекты</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и для них должны быть реализованы потоковые операторы (stream operators). За подробностями обращайтесь к описанию класса </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QMetaObject</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Вставка отпускаемых данных в модель</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Способ обработки моделью отпускания данных зависит от типа модели (список, таблица или дерево) и способа представления содержимого пользователю. Вообще, принимаемый для обработки отпускаемых данных подход должен зависеть от основного способа хранения данных.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модели различных типов имеют обыкновение по разному обрабатывать отпускаемые данные. Модели списков и таблиц предоставляют плоскую структуру хранения элементов данных. В результате они могут при отпускании данных на существующем элементе представления вставлять строки (и столбцы) или переписать содержимое элементов модели, используя некоторые из предоставленных данных. Модели деревьев часто могут добавлять дочерние элементы, содержащие новую информацию, к основным разделам данных, и поэтому их поведение может быть более очевидно пользователю.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Отпускаемые данные обрабатываются моделью с помощью переопределенной </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel::dropMimeData</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">(). Например, модель, работающая с простым списком строк, может по-разному обрабатывать отпускание данных на существующий элемент и на верхний уровень (т.е. на несуществующий элемент).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модель сначала должна удостовериться, что операция должна быть выполнена, передаваемые данные имеют формат, который может использоваться, и что их назначение уместно для данной модели:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> bool DragDropListModel::dropMimeData(const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QMimeData</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *data,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::DropAction action, int row, int column, const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;parent)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (action == </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">Qt</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::IgnoreAction)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return true;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (!data-&gt;hasFormat(&quot;application/vnd.text.list&quot;))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return false;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (column &gt; 0)</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         return false;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Простая модель одностолбцового списка строк может сообщить об отказе в принятии данных, если перемещаемые данные не являются простым текстом или если переданный при перетаскивании номер столбца недействителен.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Вставляемые в модель данные, в зависимости от того, отпускаются ли они над действительным или над недействительным элементом, обрабатываются по-разному. В этом простом примере мы хотим разрешить отпускание между существующими элементами, до первого элемента списка и после последнего.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Когда происходит отпускание модельный индекс, соответствующий родительскому элементу, будет либо действительным, указывая что отпускание произошло на элемент, либо будет недопустимым, указывая что отпускание произошло где-то в представлении, что соответствует верхнему уровню модели.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     int beginRow;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     if (row != -1)</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         beginRow = row;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Сначала мы изучим переданный номер строки чтобы увидеть, можем ли мы использовать ее для вставки элементов в модель невзирая на то, является ли допустимым родительский индекс или нет.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     else if (parent.isValid())</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         beginRow = parent.row();</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Если родительский модельный индекс допустимый, то отпускание произойдет на элемент. В этой простой модели списка мы узнаем номер строки элемента и используем это значение для вставки отпускаемых элементов на верхний уровень модели.</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     else</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         beginRow = rowCount(</span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">());</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Когда отпускание происходит где-нибудь в представлении и номер строки является недействительным, то элементы вставляются на верхний уровень модели.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В иерархических моделях, при отпускании над элементом, новые элементы лучше вставлять в модель в качестве дочерних по отношению к элементу, над которым происходит отпускание. В показанном здесь простом примере модель имеет один уровень, поэтому такой подход здесь неуместен. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Декодирование импортируемых данных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Каждая из реализаций </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">dropMimeData()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> должна декодировать данные и вставлять их в основную структуру данных модели.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В простой модели списка строк декодированные элементы могут быть направлены в </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QStringList</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QByteArray</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> encodedData = data-&gt;data(&quot;application/vnd.text.list&quot;);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QDataStream</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> stream(&amp;encodedData, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QIODevice</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">::ReadOnly);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QStringList</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> newItems;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     int rows = 0;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     while (!stream.atEnd()) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QString</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> text;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         stream &gt;&gt; text;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         newItems &lt;&lt; text;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         ++rows;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Строки могут быть вставлены в основную структуру данных. Чтобы быть последовательными, мы можем сделать это через интерфейс модели:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     insertRows(beginRow, rows, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     foreach (const </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QString</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> &amp;text, newItems) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> idx = index(beginRow, 0, </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QModelIndex</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         setData(idx, text);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">         beginRow++;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     return true;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Обратите внимание на то, что модель обычно должна предоставлять реализации функций </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel::insertRows</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">() и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel::setData</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">(). </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Модели-посредники</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В структуре модель/представление, элементы данных предоставляемые одной моделью могут быть разделены между несколькими представлениями, и каждое из этих представлений может отображать информацию совершенно уникальным способом. Пользовательские представления и делегаты - эффективный метод, чтобы предоставить совершенно другие представления одних и тех же данных. Однако в приложениях часто требуется представление по-разному обработанных одних и тех же данных. Например, в виде списков, элементы которых по разному отсортированы.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Казалось бы вполне естественным выполнять сортировку и фильтрацию элементов данных силами самих представлений, но такой подход не позволяет многим представлениям совместно использовать результаты таких потенциально дорогостоящих операций. Альтернативный подход состоит в том, чтобы заставить саму модель сортировать данные, но в итоге каждое представление будет использовать результаты самой последней операции сортировки.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для решения этой проблемы в архитектуре модель/представление используются модели-посредники (proxy models), управляющие данными, передаваемыми между отдельными моделями и представлениями. Модели-посредники - это компоненты, ведущие себя по отношению к представлению подобно модели данных и осуществляющие доступ к модели данных от имени представления. Механизм сигналов и слотов, используемый в архитектуре модель/представление, гарантирует, что все представления будут обновлены независимо от того, сколько моделей-посредников расположено между ними и моделью-источником. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Использование моделей-посредников</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модели-посредники могут быть вставлены между существующей моделью и любым количеством представлений. Qt предоставляет стандартную модель-посредник </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QSortFilterProxyModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, которая может использоваться как сама по себе, так и служить основой для подклассов, реализующих собственные способы фильтрации и сортировки. Класс </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QSortFilterProxyModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> может использоваться следующим образом:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QSortFilterProxyModel</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *filterModel = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QSortFilterProxyModel</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">(parent);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     filterModel-&gt;setSourceModel(stringListModel);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:10pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'Courier New,courier'; font-size:10pt;"> *filteredView = new </span><span style=" font-family:'Courier New,courier'; font-size:10pt; color:#6a0e07;">QListView</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:10pt;">     filteredView-&gt;setModel(filterModel);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Так как модели-посредники являются наследниками </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, они могут быть соединены с представлением любого вида и быть разделенными между представлениями. Также они могут использоваться для обработки информации, полученной от другой модели-посредника.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Класс </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QSortFilterProxyModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> разработан для того, чтобы использоваться непосредственно в приложениях. Наследуя от этого класса можно создать более специализированную модель-посредник, реализующую требуемые операции сравнения. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Настройка моделей-посредников</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Обработка данных моделью-посредником включает в себя отображение каждого элемента данных из его исходного расположения в источнике относительно его изначального расположения в соответствующее расположение в модели-посреднике. В некоторых моделях отдельные элементы могут не обрести соответствующего расположения в модели-посреднике; такие модели являются </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">фильтрующими</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> моделями-посредниками. Представления работают с элементами данных, используя модельные индексы, предоставляемые моделью-посредником, и не имеют никакого представления ни относительно расположения элементов в модели, ни о модели-источнике.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QSortFilterProxyModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> позволяет отфильтровать данные перед предоставлением их представлению, а также позволяет предоставить представлениям содержимое модели-источника как предварительно отсортированные данные. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Пользовательские модели фильтрации</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Класс </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QSortFilterProxyModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> предоставляет довольно универсальную фильтрующую модель, которая может использоваться в самых разных ситуациях. Продвинутые пользователи, для реализации собственных механизмов фильтрации, могут создать подкласс </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QSortFilterProxyModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Подкласс </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QSortFilterProxyModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> может переопределить две виртуальные функции, которые вызываются всякий раз, когда требуется или используется модельный индекс от модели-посредника:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#6a0e07;">filterAcceptsColumn()</span> используется для фильтрации определенных столбцов исходной модели.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#6a0e07;">filterAcceptsRow()</span> используется для фильтрации определенных строк исходной модели.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Реализация этих функций в </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QSortFilterProxyModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> по умолчанию всегда возвращает true для того, чтобы гарантировать, что все строки и столбцы будут переданы представлению; переопределение этих функций может возвращать false для фильтрации отдельных строк и столбцов. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Пользовательские модели сортировки</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для обеспечения отображения элементов модели-источника в модель-посредник, экземпляры </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QSortFilterProxyModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> используют встроенную в Qt функцию </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">qStableSort</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">(), тем самым позволяя представлению получить отсортированную иерархию элементов без изменения структуры модели-источника. Для предоставления собственного метода сортировки, переопределите функцию </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">lessThan()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, в которой пропишите свои правила сравнения. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Создание собственных моделей</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Подклассы моделей необходимо обеспечить реализациями многих виртуальных функций, объявленных в базовом классе </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Некоторое количество этих функций, которые необходимо реализовать, зависят от типа модели - предоставляет ли представление с простым списком, таблицей или сложной иерархией элементов. Унаследованные от </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractListModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractTableModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> модели могут получить преимущество от стандартных реализаций функций, предоставляемых этими классами. Модели, которые предоставляют элементы данных в древовидных структурах, обязаны предоставить реализации для многих виртуальных функций </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Функции, которые необходимо реализовать в подклассе модели, можно разделить на три группы:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Обработка данных элемента:</span> Все модели должны реализовать функции, которые дают возможность представлениям и делегатам запрашивать измерения модели, проверять элементы и извлекать данные.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Навигация и создание индекса:</span> Иерархические модели должны предоставить функции, которые могут вызываться представлениями для навигации в древовидных структурах, предоставляемых ими, и получения модельных индексов элементов.</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Поддержка перетаскивания (drag and drop) и обработки MIME-типов:</span> Модели наследуют функции, управляющие способом, которым выполняются внутренние и внешние операции перетаскивания. Эти функции разрешают описывать элементы данных в терминах MIME-типов, которые могут понимать другие компоненты и приложения.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для получения дополнительной информации смотрите </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">главу &quot;Item View Classes&quot; в книге &quot;C++ GUI Programming with Qt 4&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Обработка элементов данных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модели могут варьировать уровень доступа к предоставляемым ими данным: Они могут быть простыми компонентами только для чтения, другие модели могут обеспечивать операции изменения размера, а другие могут разрешить редактировать элементы. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Доступ только для чтения</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Чтобы обеспечить доступ к предоставляемым моделью данным только для чтения, в подклассе модели </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">должны</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> быть реализованы следующие функции:</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">flags()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Используется другими компонентами для получения информации о каждом элементе, предоставляемом моделью. Во многих моделях комбинация флагов будет включать в себя </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::ItemIsEnabled</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::ItemIsSelectable</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">data()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Используется для снабжения представлений и делегатов элементами данных. Как правило, модели нуждаются только в снабжении данными для </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::DisplayRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и любых специфичных для приложения пользовательских ролей, но будет хорошей практикой предоставить данные для </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::ToolTipRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::AccessibleTextRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::AccessibleDescriptionRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Информацию о типах, связанных с каждой ролью, смотрите в документации перечисления </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::ItemDataRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">headerData()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Предоставляется представлениям с информацией для показа в их заголовках. Информация извлекается представлениями, которые могут отобразить информацию заголовков.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">rowCount()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Предоставляет количество строк данных, доступных в модели.</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Эти четыре функции должны быть реализованы во всех видах моделей, включая модели списков (подклассы </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractListModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">) и табличные модели (подклассы </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractTableModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Кроме того, следующие функции </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">должны</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> быть реализованы в прямых наследниках </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractTableModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">:</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">columnCount()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Предоставляет количество столбцов данных, доступных в модели. Модели списков не предоставляют эту функцию поскольку она уже реализована в </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractListModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Редактируемые элементы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Редактируемые модели разрешают модифицировать элементы данных, а также могут предоставить функции, разрешающие вставку и удаление строк и столбцов. Чтобы разрешить редактирование, должны быть корректно реализованы следующие функции:</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">flags()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Должна возвращать комбинацию флагов, соответствующую каждому элементу. В частности, возвращаемое этой функцией значение, в дополнение к используемым в модели только для чтения значениям, должно включать в себя </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::ItemIsEditable</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">setData()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Используется для модификации элемента данных, связанного с заданным модельным индексом. Чтобы иметь возможность принимать пользовательский ввод, предоставляемый элементами пользовательского интерфейса, эта функция должна обрабатывать данные, связанные с </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::EditRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Реализация может также принимать данные, связанные со многими различными видами ролей, задаваемыми </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Qt::ItemDataRole</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. После изменения элемента данных модели должны испустить сигнал </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">dataChanged()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, чтобы уведомить другие компоненты об изменении.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">setHeaderData()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Используется для модификации информации в горизонтальном и вертикальном заголовке. После изменения элемента данных модели должны испустить сигнал </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">headerDataChanged()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, чтобы уведомить другие компоненты об изменении.</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Изменение размеров моделей</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Все типы моделей могут поддерживать вставку и удаление строк. Табличные модели и иерархические модели могут также поддерживать вставку и удаление столбцов. Важно уведомить другие компоненты об изменениях в измерениях модели как </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">до</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, так и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">после</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> того как они произойдут. В результате, следующие функции могут быть реализованы для разрешения модели изменять размеры, но реализации должны гарантировать, что вызываются соответствующие функции для уведомления присоединенных представлений и делегатов:</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">insertRows()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Используется для добавления новых строк и элементов данных во все виды моделей. Реализации должны содержать вызов </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">beginInsertRows()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">перед</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> вставкой новых строк в любые базовые структуры данных и вызов </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">endInsertRows()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">незамедлительно после</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">removeRows()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Используется для удаления строк и содержащихся в них элементов данных изо всех видов моделей. Реализации должны содержать вызов </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">beginRemoveRows()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">перед</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> удалением столбцов из базовых структур данных и вызов </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">endRemoveRows()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">незамедлительно после</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">insertColumns()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Используется для добавления новых столбцов и элементов данных в табличные и иерархические модели. Реализации должны содержать вызов </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">beginInsertColumns()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">перед</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> вставкой строк в любые базовые структуры данных и вызов </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">endInsertColumns()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">незамедлительно после</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">removeColumns()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Используется для удаления столбцов и содержащихся в них элементов данных из табличных и иерархических моделей. Реализации должны содержать вызов </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">beginRemoveColumns()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">перед</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> удалением столбцов из любых базовых структур данных и вызов </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">endRemoveColumns()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-style:italic;">незамедлительно после</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Как правило, эти функции возвращают true если операция была успешной. Однако могут быть случаи, когда операция достигла успеха только частично; например, если строк может быть вставлено меньше указанного количества. В таких случаях модель должна возвращать false, чтобы, обозначив фатальную ошибку, дать возможность каким-нибудь присоединенным компонентам обработать ситуацию.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Сигналы, испускаемые функциями, вызванными в реализациях API изменения размера, дают шанс присоединенным компонентам принять меры до того, как какие-либо данные станут недоступными. Инкапсуляция операций вставки и удаления с начальными и конечными функциями также дает возможность модели корректно управлять </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">постоянными модельными индексами</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Как правило, начальные и конечные функции способны уведомлять другие компоненты об изменениях в базовой структуре модели. Для более сложных изменений в структуре модели, приводящие возможно к преобразованию или сортировке данных, необходимо испустить сигнал </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">layoutChanged()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, чтобы заставить все присоединенные представления обновиться. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Ленивое заполнение (Lazy Population) модели данных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Ленивое заполнение данных модели эффективно разрешает запросы информации о модели, отложенные до тех пор пока они фактически не понадобятся представлениям.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Некоторые модели нуждаются в получении данных из удаленных источников или должны выполнять ресурсоемкие операции, чтобы получить информацию о способе организации данных. Так как представления обычно требуют так много информации, сколько возможно по порядку для правильного отображения данных модели, для уменьшения излишних откликов (follow-up) на запрашиваемые данные может быть полезным ограничить количество возвращаемой к ним информации.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">В иерархических моделях, где нахождение количества дочерних элементов заданного элемента является дорогостоящей операцией, полезно обеспечить, чтобы реализация </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QTreeView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, рисования соответствующего оформления их родительского элемента.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Возвратит ли переопределенная функция </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QTreeView</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> не нужно знать сколько имеется дочерних элементов, если родительский элемент не развернут для их показа.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Если известно, что многие элементы имеют дочерние элементы, переопределение </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">hasChildren()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для безусловного возврата </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">true</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> является иногда полезным методом. Это гарантирует, что каждый элемент может позднее проверить наличие дочерних элементов при выполнении начального заполнения данных модели так быстро, как это возможно. Единственное неудобство - это то, что элементы без дочерних элементов в некоторых представлениях могут отображаться неправильно пока пользователь пытается просмотреть несуществующие дочерние элементы. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Навигация и создание индекса модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Иерархические модели должны предоставить функции, которые могут вызываться представлениями для навигации в древовидных структурах, которые они отображают, и получения модельных индексов элементов. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Родители и дети</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Так как структура, открытая представлениям, определяется базовой структурой данных, создание собственных модельных индексов для каждого подкласса модели обеспечивается реализацией следующих функций:</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">index()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Передавая модельный индекс родительского элемента, эта функция разрешает представлениям и делегатам обращаться к дочерним элементам этого элемента. Если не найдено допустимого дочернего элемента - соответствующего указанным строке, столбцу и родительскому модельному индексу, функция должна вернуть QModelIndex(), который является ошибочным модельным индексом.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">parent()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Предоставляет модельный индекс, соответствующий родителю какого-либо дочернего элемента. Если указанный модельный индекс соответствует элементу верхнего уровня модели, или если у элемента в модели нет правильного родителя, функция должна вернуть неправильный модельный индекс, созданный с помощью пустого конструктора QModelIndex().</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Обе приведенные выше функции используют фабрику функций </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">createIndex()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для генерации индексов, используемых другими компонентами. Для моделей является нормой снабжать эту функцию каким-нибудь уникальным идентификатором, чтобы гарантировать что модельный индекс может быть перепривязан к соответствующему элементу позднее. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Поддержка перетаскивания (Drag and Drop) и обработка MIME-типов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Классы модель/представление поддерживают операции перетаскивания (drag and drop), предоставляя поведение по умолчанию, что подходит многим приложениям. Тем не менее, возможно также внести изменения в способ кодирования элементов во время операций перетаскивания, копируются ли они по умолчанию или перемещаются, и как они вставляются в существующие модели.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Кроме того, классы вспомогательных представлений реализуют специализированное поведение, что отвечает ожиданиям существующих разработчиков. Раздел </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Вспомогательные представления</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> предоставит обзор этого поведения. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">MIME данные</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">По умолчанию, встроенные модели и представления используют внутренний MIME-тип (</span><span style=" font-family:'Courier New,courier'; font-size:10pt;">application/x-qabstractitemmodeldatalist</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">) для передачи информации о модельных индексах. Это задает данные для списка элементов, содержащего номера строк и столбцов для каждого элемента и информацию о ролях, поддерживаемых для каждого элемента.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Закодированные с использованием этого MIME-типа данные могут быть получены с помощью вызова </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel::mimeData</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">() с </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QModelIndexList</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, содержащим элементы для преобразования в последовательную форму.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">При реализации поддержки перетаскивания в пользовательской модели, можно экспортировать элементы данных в специализированных форматах переопределив следующую функцию:</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">mimeData()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Эта функция может быть переопределена таким образом, чтобы возвращать данные в форматах, отличных от стандартного внутреннего MIME-типа </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">application/x-qabstractitemmodeldatalist</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Подклассы могут получить стандартный объект </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QMimeData</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> из базового класса и добавить в него данные в дополнительных форматах.</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для многих моделей полезно предоставить содержимое элементов в общем формате, представленном одним из MIME-типов, таких как </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">text/plain</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> или </span><span style=" font-family:'Courier New,courier'; font-size:10pt;">image/png</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Обратите внимание на то, что изображения, цвета и документы HTML могут быть легко добавлены в объект </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QMimeData</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> с помощью функций </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QMimeData::setImageData</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">(), </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QMimeData::setColorData</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">() и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QMimeData::setHtml</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">(). </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Получение отпускаемых данных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Когда операция перетаскивания выполняется в представлении, основная модель запрашивается для определения поддерживаемых ею типов операций и MIME-типов, которые она может принимать. Эта информация предоставляется функциями </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, поддерживают для элементов операции копирования и стандартный внутренний MIME-тип.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Когда преобразованный в последовательную форму (serialized) элемент данных отпускается над представлением, данные вставляются в текущую модель, используя ее реализацию </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel::dropMimeData</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">(). Стандартная реализация этой функции никогда не затирает какие-либо данные в модели; вместо этого она попытается вставить элементы данных либо на одном уровне с элементом, либо в качестве дочерних этого элемента.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Чтобы воспользоваться реализацией по умолчанию </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для встроенного MIME-типа, новые модели должны обеспечить переопределение следующих функций:</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">insertRows()</span></p></td>
<td rowspan="2" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Эти функции разрешают модели автоматическую вставку новых данных используя существующую реализацию, предоставляемую </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel::dropMimeData</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">().</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">insertColumns()</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">setData()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Разрешает заполнять элементами новые строки и столбцы.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">setItemData()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Эта функция предоставляет более эффективную поддержку заполнения новых элементов.</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Чтобы принять другие формы данных эти функции должны быть переопределены:</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">supportedDropActions()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Используется чтобы возвратить сочетание </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">действий отпускания</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> (drop actions), указывающих типы операций перетаскивания, которые принимает модель.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">mimeTypes()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Используется чтобы возвращать список MIME-типов, которые могут быть декодированы и обработаны моделью. Как правило, MIME-типы, которые поддерживаются для ввода в модель, являются теми же, которые после раскодирования данных могут использоваться внешними компонентами.</span></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">dropMimeData()</span></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Выполняет действительное раскодирование данных, переданных операциями перетаскивания, определяет где в модели они были положены и вставляет новые строки и столбцы там, где необходимо. Как реализуется эта функция в подклассах - зависит от требований данных, доступных в каждой модели.</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Если реализация функции </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">dropMimeData()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> изменяет измерения модели, вставляя или удаляя строки или столбцы, или же если элементы данных модифицировались, осторожность требует убедиться, что все соответствующие сигналы испущены. Полезно просто вызвать другие переопределенные функции в подклассе, такие как </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">setData()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">insertRows()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">insertColumns()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, чтобы убедиться, что модель ведет себя соответственно.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Для того, чтобы убедиться что операции перетаскивания работают правильно, важно переопределить следующие функции, которые удаляют данные из модели:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#6a0e07;">removeRows()</span></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#6a0e07;">removeRow()</span></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#6a0e07;">removeColumns()</span></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#6a0e07;">removeColumn()</span></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">За дополнительной информацией о перетаскивании с представлениями элементов обратитесь к </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Использование перетаскивания (Drag and Drop) с представлениями элементов</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Вспомогательные представления</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Вспомогательные представления (</span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QListWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">, </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QTableWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QTreeWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">) замещают стандартную функциональность перетаскивания чтобы обеспечить меньшую гибкость, но более естественное поведение, подходящее многим приложениям. Например, так как наиболее распространено отпускание данных в ячейки </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QTableWidget</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> с заменой имеющегося содержимого переданными данными, базовая модель будет устанавливать данные в элементы-приемник охотнее, чем вставлять в модель новые строки и строки. Для получения дополнительной информации о перетаскивании во вспомогательных представлениях смотрите </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">Использование перетаскивания (Drag and Drop) с представлениями элементов</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Оптимизация производительности для больших объемов данных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Функция </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">QAbstractItemModel</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Мы переопределили </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">canFetchMore()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> чтобы указать, если для извлечения имеется больше данных, и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">fetchMore()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> для заполнения модели по требованию.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Другой пример будет динамически заполнять древовидные модели, в нем мы переопределяем </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">fetchMore()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> когда ветвь дерева в древовидной модели является раскрытой.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Если ваша переопределенная </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">fetchMore()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> добавляет строки к модели, вам нужно вызывать </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">beginInsertRows()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">endInsertRows()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;">. Кроме того, и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">canFetchMore()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#6a0e07;">fetchMore()</span><span style=" font-family:'DejaVu Sans'; font-size:10pt;"> должны быть переопределены поскольку их реализации по умолчанию возвращают false и ничего не делают. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Классы модель/представление</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Эти классы используются при разработке паттернов модель/представление, где основные данные (в модели) хранятся отдельно от данных представленных и управляемых пользователем (в представлении).</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QAbstractItemDelegate</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Используется для отображения и редактирования элементов данных модели</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QAbstractItemModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Абстрактный интерфейс для классов моделей элементов</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QAbstractItemView</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Базовая функциональность для классов представлений элементов</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QAbstractListModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Абстрактная модель, подкласс которой можно создать для реализации одномерной модели списка</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QAbstractProxyModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Базовый класс для моделей-посредников элементов, которые могут сортировать, фильтровать и выполнять другие действия над данными</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QAbstractTableModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Абстрактная модель, подкласс которой можно создать для реализации собственной табличной модели</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QColumnView</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Реализация идеи модель/представление в виде постолбцового представления</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QDataWidgetMapper</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Отображение области данных модели на виджеты</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QFileSystemModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модель данных для локальной файловой системы</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QHeaderView</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Заголовок строки и столбца для представлений элементов</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QItemDelegate</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Средство отображения и редактирования элементов данных модели</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QItemEditorCreator</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Делает возможным создание элемента редактора без наследования QItemEditorCreatorBase</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QItemEditorCreatorBase</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Абстрактный базовый класс, для которого, при реализации нового редактора элемента, должен быть создан подкласс</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QItemEditorFactory</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Виджеты для отображения данных в представлении и делегатах</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QItemSelection</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Управляет информацией о выбранных в модели элементах</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QItemSelectionModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Отслеживает элементы, выбранные в представлении</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QItemSelectionRange</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Управляет информацией о диапазоне выбранных элементов в модели</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QListView</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Представление списка или пиктограмм в модели</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QListWidget</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Основанный на элементах виджет-список</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QListWidgetItem</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Элемент, используемый совместно с классом представления элементов QListWidget</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QModelIndex</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Используется для нахождения информации в модели данных</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QPersistentModelIndex</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Используется для нахождения информации в модели данных</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QSortFilterProxyModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Поддержка сортировки и фильтрации данных, передаваемых между другой моделью и представлением</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QStandardItem</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Элемент, использующийся в классе QStandardItemModel</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QStandardItemEditorCreator</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Возможность регистрации виджетов без использования наследования QItemEditorCreatorBase</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QStandardItemModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Общая модель для хранения пользовательских данных</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QStringListModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Модель, предоставляющая представлению строки</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QStyledItemDelegate</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Средство отображения и редактирования элементов данных модели</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QTableView</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Реализация по умолчанию модели/представления таблицы</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QTableWidget</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Основанное на элементах представление таблицы в модели по умолчанию</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QTableWidgetItem</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Элемент, использующийся в классе QTableWidget</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QTableWidgetSelectionRange</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Способ взаимодействия с выбором в модели без использования модельных индексов и модели выбора.</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QTreeView</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Реализация модели/представления по умолчанию для представления дерева</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QTreeWidget</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Представление дерева, использующее заданную модель дерева</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QTreeWidgetItem</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Элемент, используемый в классе QTreeWidget</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600; color:#000000;">QTreeWidgetItemIterator</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt;">Способ перебора всех элементов QTreeWidget</span></p></td></tr></table>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Связанные примеры</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:10pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Представление каталога</span></li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Делегат окошка счетчика</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Pixelator</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Простая модель дерева</li>
<li style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Диаграмма</li></ul>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:600;">Смотрите также</span><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:10pt; color:#000000;">Пример &quot;Item Views Puzzle&quot;. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10pt;"><br /></p></body></html>