<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Здесь записана попытка разобраться и понять, что происходит при выполнении команды git reset --soft.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">git reset --soft &lt;СтарыйКоммит&gt;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">А происходит нечто странное (все нижеперечисленные изменения произойдут в локальном репозитарии):</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1. Состояние файлов в рабочей директории не откатывается до состояния на указанный коммит. То есть, в рабочей директории никакого отката кода не производится.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2. В индексе появляются изменения, которые производились начиная с коммита, до которого был произведен откат, и кончая HEAD каким он был до выполнения команды reset. В общем, в индексе появляется дельта изменений, которые пользователь хотел &quot;откатить&quot;. Здесь неясно, какое направление сделано у этих изменений. Варианта два:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Это изменения, которые будучи применимы к коммиту <span style=" font-family:'FreeMono'; color:#6a1009;">&lt;СтарыйКоммит&gt;</span> приведут код в самое свежее состояние (от которого мы и хотим избавиться)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Это изменения, которые будучи применимы к самому свежему коду, откатят его до состояния <span style=" font-family:'FreeMono'; color:#6a1009;">&lt;СтарыйКоммит&gt;</span> .</li></ol>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">документация не проливает свет на этот вопрос, потому он остается открытым. По коственным данным, эти изменения больше похожи на вариант 1. Но тогда непонятно, к чему они должны применяться, если в рабочей директории код находится не в состоянии <span style=" font-family:'FreeMono'; color:#6a1009;">&lt;СтарыйКоммит&gt;</span>.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">3. Указатель HEAD откатится до коммита <span style=" font-family:'FreeMono'; color:#6a1009;">&lt;СтарыйКоммит&gt;</span>. Команда <span style=" font-family:'FreeMono'; color:#6a1009;">git log</span> станет проказывать историю до коммита <span style=" font-family:'FreeMono'; color:#6a1009;">&lt;СтарыйКоммит&gt;</span>, но не дальше. Чтобы увидеть все коммиты, которые даже находятся после коммита, до которого откатился пользователь, нужна команда <span style=" font-family:'FreeMono'; color:#6a1009;">git log --all</span>.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вот в таком состоянии будет находиться репозитарий. Что разумного можно сделать в таком состоянии, мне пока не понятно.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">* * *</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь возникает вопрос: как выйти из этого состояния? Как вернуться хотя бы до прежнего состояния со всеми изменениями, где HEAD соответствовал указателю ветки и находился на самом последнем изменении в ветке?</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В этом поможет команда <span style=" font-family:'FreeMono'; color:#6a1009;">git pull</span>. Однако, она может не сработать в случае, если какой-либо файл в рабочей директории был изменен с момента команды <span style=" font-family:'FreeMono'; color:#6a1009;">git reset --soft</span>. В этом случае надо действовать по обстоятельствам, <span style=" font-family:'FreeMono'; color:#6a1009;">git</span> будет подсказывать что надо выполнить.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>