<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Arial'; font-size:10pt; font-weight:400; font-style:normal;">
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Введение </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Alfresco - это гибкая платформа для разработки приложений для управления данными. Первым шагом в разработке пользовательского типа данных является создание модели данных. Встроенная модель данных Alfresco довольно полная. На самом деле, для базовой функциональности управления документами, вам будет достаточно использовать встроенную модель. Конечно, вы потеряете некоторую функциональность по сравнению с использованием модели данных, подстроенной под нужды вашего бизнеса.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Эта статья описывает как создать Вашу собственную модель данных и не только. Зачем нужна собственная модель данных, если нет средств для её заполнения? Поэтому мы так же рассмотрим настройку пользовательского интерфейса для отображения нашей модели данных, затем мы напишем некоторый код для создания, поиска и удаления данных.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вы должны быть знакомы с основами управления документами и с веб-клиентом Alfresco. Если вы хотите идти дальше, вы должны знать как писать простой Java код.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Основы создания моделей данных</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модель данных описывает данные которые могут быть сохранены в репозитории. Модели данных это основа Alfresco - без них она бы была просто развитой файловой системой. Вот ключевые особенности модели данных Alfresco:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используются такие типы данных которые могут быть легко сохранены в БД, например без модели данных для Alfresco не было бы разницы между типами String и Date.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Более высокое положение в иерархии таких типов данных как &quot;данные&quot; и &quot;папка&quot;, чем положение типов &quot;Стандартная операция&quot; или &quot;Контракт&quot;</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Встроенные аспекты &quot;наблюдаемый&quot; и &quot;классифицируемый&quot; наряду с &quot;оцениваемый&quot; и &quot;комментируемый&quot;</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Свойства (или метаданные) специфичны для каждого типа данных.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">К свойствам могут применяться ограничения (например &quot;значения свойства должны удовлетворять некоторому шаблону&quot; или &quot;значения свойства могут выбираться из списка подходящих&quot;)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как индексировать данные для поиска</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отношения между типами данных.</li></ul>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модель данных Alfresco построена с использованием малого числа &quot;строительных блоков&quot;: Типы, Свойства, Типы свойств, Ассоциации и Аспекты.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Типы</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Типы похожи на классы объектов в ООП. Они могут использоваться для моделирования бизнес объектов, они имеют свойства, и они могут наследоваться от типа предка. Важнейшие встроенные типы это &quot;Данные&quot;, &quot;Персона&quot; и &quot;Папка&quot;. Пользовательские типы ограничены только вашей фантазией и требованиями бизнеса. Например, &quot;Отчет о прибылях&quot;, &quot;Медицинская запись&quot;, &quot;Фильм&quot;, &quot;Песня&quot;, &quot;Комментарий&quot;. Заметьте, что Типы, Свойства, Типы свойств, Ассоциации и Аспекты имеют уникальные имена. Эти имена используются потом в xml схеме модели. Например, для модели MyModel мы можем определить URI: &quot;http://www.mymodel.com/model/content/1.0&quot; и префикс &quot;opt:&quot;, любой тип определенный как часть этой модели будет начинаться с &quot;opt:&quot;. Мы еще поговорим подробнее как с использованием XML определяются модели. Использования пространств имен позволяет исключить коллизии наименований типов.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Свойства</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Свойство это составная часть метаданных ассоциированных с данным типом. Например, свойствами &quot;Отчета об убытках&quot;, могут быть такие свойства как: &quot;Имя работника&quot;, &quot;Дата создания&quot;, &quot;Проект&quot;, &quot;Клиент&quot; и т.д. Этот тип может так же иметь свойство &quot;данные&quot; для хранения файла с отчетом в формате excel или PDF.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Типы свойств</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Типы свойств - это типы данных которые могут быть сохранены. Базовые типы - строки, даты, числа, булевы значения - уже определены в Alfresco по умолчанию.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Ограничения</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ограничения используются для определения того какие данные могут храниться в свойстве типа. Существуют четыре типа ограничений: REGEX, LIST, MINMAX, and LENGTH. REGEX используется для ограничения свойства с помощью регулярных выражений, LIST используется для определения списка возможных значений, MINMAX для ограничения цифровых значений и LENGTH для определения длины свойства. Ограничения могут быть определены один раз и использоваться во всех моделях Alfresco. Например, везде можно использовать ограничение “cm:filename” для REGEX-ограничения по имени файла.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Ассоциации</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ассоциации определяют отношения между типами. Без ассоциаций, модель может быть полна типами которые ссылаются на другие части данных. Возвращаясь к примеру с &quot;Отчетом по прибыли&quot; мы можем сохранить каждую строчку как отдельный объект. К типу &quot;Отчет по прибыли&quot; мы можем добавить тип &quot;строчка отчета&quot;. Используя ассоциации мы можем сказать Alfresco об отношениях между этими типами. Ассоциации бывают двух типов: &quot;равные ассоциации&quot; и и ассоциации &quot;подчинения&quot;. &quot;Равные&quot; ассоциации определяют отношения между двумя объектами, но не подчиняет их один другому. &quot;Подчиненные&quot; ассоциации напротив используются для того, чтобы показать такое подчинение. В ассоциациях существующих по-умолчанию легко определить тип ассоциации &quot;cm:contains&quot;. Эта ассоциации определяет &quot;подчиненные&quot; отношения между папками (&quot;cm:folder&quot;) и всеми другими объектами - потомками типа &quot;sys:base&quot;. Другой пример - &quot;Отчет&quot; и &quot;Документы приложения&quot; - они будут связаны &quot;равными&quot; ассоциациями.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Аспекты</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Перед тем как говорить об аспектах, давайте решим как работает наследование и включение в нашей модели данных. Допустим мы используем Alfresco для управления данными и отображения их на странице портала. Допустим что мы хотим видеть только часть данных. Простой пример это отображение даты и времени отправки данных на портал. Используя модель данных мы можем поступить двумя способами: первый - это определить такое свойство в корневом типе для всех объектов и все объекты -наследники будут его наследовать от корневого типа, а второй способ определить этот свойтсво только для тех типов которые будут отображаться на портале.. Естественно второй способ лучше, а первый легче. Таким образом, для нашего примера нужно определить аспект &quot;PortalDisplayable&quot; со свойством &quot;published date&quot;. Этот аспект будет добавляться ко всем данным для которых требуется отображение на портале.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></p></body></html>